<Type Name="EventLog" FullName="System.Diagnostics.EventLog">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="c7b0720d24124f7818c7801c79354a1bfa733467" />
    <Meta Name="ms.sourcegitcommit" Value="434f60616a9793fa8436744549fc856e94f7a648" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="pt-BR" />
    <Meta Name="ms.lasthandoff" Value="08/25/2018" />
    <Meta Name="ms.locfileid" Value="39888440" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class EventLog : System.ComponentModel.Component, System.ComponentModel.ISupportInitialize" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit EventLog extends System.ComponentModel.Component implements class System.ComponentModel.ISupportInitialize" />
  <TypeSignature Language="DocId" Value="T:System.Diagnostics.EventLog" />
  <TypeSignature Language="VB.NET" Value="Public Class EventLog&#xA;Inherits Component&#xA;Implements ISupportInitialize" />
  <TypeSignature Language="C++ CLI" Value="public ref class EventLog : System::ComponentModel::Component, System::ComponentModel::ISupportInitialize" />
  <TypeSignature Language="F#" Value="type EventLog = class&#xA;    inherit Component&#xA;    interface ISupportInitialize" />
  <AssemblyInfo>
    <AssemblyName>System</AssemblyName>
    <AssemblyVersion>1.0.5000.0</AssemblyVersion>
    <AssemblyVersion>2.0.0.0</AssemblyVersion>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.ComponentModel.Component</BaseTypeName>
  </Base>
  <Interfaces>
    <Interface>
      <InterfaceName>System.ComponentModel.ISupportInitialize</InterfaceName>
    </Interface>
  </Interfaces>
  <Attributes>
    <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
      <AttributeName>System.ComponentModel.DefaultEvent("EntryWritten")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="xamarinmac-3.0">
      <AttributeName>System.ComponentModel.InstallerType(typeof(System.Diagnostics.EventLogInstaller))</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="xamarinmac-3.0">
      <AttributeName>System.Diagnostics.MonitoringDescription("Represents an event log")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.Designer("Microsoft.VisualStudio.Install.EventLogInstallableComponentDesigner, Microsoft.VisualStudio, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-1.1">
      <AttributeName>System.ComponentModel.InstallerType("System.Diagnostics.EventLogInstaller, System.Configuration.Install, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
      <AttributeName>System.ComponentModel.InstallerType("System.Diagnostics.EventLogInstaller, System.Configuration.Install, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
      <AttributeName>System.Diagnostics.MonitoringDescription("EventLogDesc")</AttributeName>
    </Attribute>
    <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
      <AttributeName>System.ComponentModel.InstallerType("System.Diagnostics.EventLogInstaller, System.Configuration.Install, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
    </Attribute>
  </Attributes>
  <Docs>
    <summary>
      <span data-ttu-id="ce427-101">Fornece interação com logs de eventos do Windows.</span>
      <span class="sxs-lookup">
        <span data-stu-id="ce427-101">Provides interaction with Windows event logs.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-102"><xref:System.Diagnostics.EventLog> permite acessar ou personalizar os logs de eventos do Windows, que registram informações sobre eventos importantes de software ou hardware.</span><span class="sxs-lookup"><span data-stu-id="ce427-102"><xref:System.Diagnostics.EventLog> lets you access or customize Windows event logs, which record information about important software or hardware events.</span></span> <span data-ttu-id="ce427-103">Usando <xref:System.Diagnostics.EventLog>, você pode ler logs existentes, gravar entradas em logs, criar ou excluir fontes de evento, excluir os logs e responder a entradas de log.</span><span class="sxs-lookup"><span data-stu-id="ce427-103">Using <xref:System.Diagnostics.EventLog>, you can read from existing logs, write entries to logs, create or delete event sources, delete logs, and respond to log entries.</span></span> <span data-ttu-id="ce427-104">Você também pode criar novos logs durante a criação de uma origem do evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-104">You can also create new logs when creating an event source.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="ce427-105">Esse tipo implementa o <xref:System.IDisposable> interface.</span><span class="sxs-lookup"><span data-stu-id="ce427-105">This type implements the <xref:System.IDisposable> interface.</span></span> <span data-ttu-id="ce427-106">Quando você terminar de usar o tipo, você deve descartá-lo diretamente ou indiretamente.</span><span class="sxs-lookup"><span data-stu-id="ce427-106">When you have finished using the type, you should dispose of it either directly or indirectly.</span></span> <span data-ttu-id="ce427-107">Para descartar o tipo diretamente, chame seu <xref:System.IDisposable.Dispose%2A> método em um `try` / `catch` bloco.</span><span class="sxs-lookup"><span data-stu-id="ce427-107">To dispose of the type directly, call its <xref:System.IDisposable.Dispose%2A> method in a `try`/`catch` block.</span></span> <span data-ttu-id="ce427-108">Para descartá-los indiretamente, usar uma construção de linguagem, como `using` (em c#) ou `Using` (no Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="ce427-108">To dispose of it indirectly, use a language construct such as `using` (in C#) or `Using` (in Visual Basic).</span></span> <span data-ttu-id="ce427-109">Para obter mais informações, consulte a seção "Usando um objeto que implementa IDisposable" o <xref:System.IDisposable> tópico da interface.</span><span class="sxs-lookup"><span data-stu-id="ce427-109">For more information, see the "Using an Object that Implements IDisposable" section in the <xref:System.IDisposable> interface topic.</span></span>  
  
 <span data-ttu-id="ce427-110">Além de fornecer acesso aos logs de evento individuais e suas entradas, a <xref:System.Diagnostics.EventLog> classe permite que você acesse a coleção de todos os logs de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-110">In addition to providing access to individual event logs and their entries, the <xref:System.Diagnostics.EventLog> class lets you access the collection of all event logs.</span></span> <span data-ttu-id="ce427-111">Você pode usar o `static` membros de <xref:System.Diagnostics.EventLog> para excluir os logs, obter listas de log, criar ou excluir uma fonte ou determinar se um computador já contém uma fonte específica.</span><span class="sxs-lookup"><span data-stu-id="ce427-111">You can use the `static` members of <xref:System.Diagnostics.EventLog> to delete logs, get log lists, create or delete a source, or determine if a computer already contains a particular source.</span></span>  
  
 <span data-ttu-id="ce427-112">Há três logs de evento padrão: aplicativo, sistema e segurança.</span><span class="sxs-lookup"><span data-stu-id="ce427-112">There are three default event logs: Application, System, and Security.</span></span> <span data-ttu-id="ce427-113">Um log de segurança é somente leitura.</span><span class="sxs-lookup"><span data-stu-id="ce427-113">A Security log is read-only.</span></span> <span data-ttu-id="ce427-114">Outros aplicativos e serviços que você instala, como o Active Directory, podem ter os logs de evento adicionais.</span><span class="sxs-lookup"><span data-stu-id="ce427-114">Other applications and services you install, such as Active Directory, might have additional event logs.</span></span>  
  
 <span data-ttu-id="ce427-115">Há considerações de segurança ao usar o <xref:System.Diagnostics.EventLog> classe.</span><span class="sxs-lookup"><span data-stu-id="ce427-115">There are security considerations when using the <xref:System.Diagnostics.EventLog> class.</span></span> <span data-ttu-id="ce427-116"><xref:System.Diagnostics.EventLog> requer <xref:System.Diagnostics.EventLogPermission> permissões para ações específicas no .NET Framework 2.0 e versões posteriores, ou de confiança total no .NET Framework 1.0 e 1.1.</span><span class="sxs-lookup"><span data-stu-id="ce427-116"><xref:System.Diagnostics.EventLog> requires <xref:System.Diagnostics.EventLogPermission> permissions for specific actions in the .NET Framework 2.0 and later versions, or full trust in the .NET Framework 1.0 and 1.1.</span></span> <span data-ttu-id="ce427-117">É recomendável que <xref:System.Diagnostics.EventLogPermission> não ser concedida a código parcialmente confiável.</span><span class="sxs-lookup"><span data-stu-id="ce427-117">We recommend that <xref:System.Diagnostics.EventLogPermission> not be granted to partially trusted code.</span></span>  <span data-ttu-id="ce427-118">Você nunca deve passar qualquer objeto de log de eventos, inclusive <xref:System.Diagnostics.EventLogEntryCollection> e <xref:System.Diagnostics.EventLogEntry> objetos, para código menos confiável.</span><span class="sxs-lookup"><span data-stu-id="ce427-118">You should never pass any event log object, including <xref:System.Diagnostics.EventLogEntryCollection> and <xref:System.Diagnostics.EventLogEntry> objects, to less trusted code.</span></span> <span data-ttu-id="ce427-119">Por exemplo, criando uma <xref:System.Diagnostics.EventLog> objeto, gravar uma entrada e, em seguida, passando o <xref:System.Diagnostics.EventLog> objeto para código parcialmente confiável pode criar um problema de segurança, pois a capacidade de ler e gravar no log de eventos permite que o código executar ações como emitir mensagens de log de eventos no nome de outro aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-119">For example, creating an <xref:System.Diagnostics.EventLog> object, writing an entry, and then passing the <xref:System.Diagnostics.EventLog> object to partially trusted code can create a security issue, because the ability to read and write to the event log allows code to perform actions such as issuing event log messages in the name of another application.</span></span>  
  
 <span data-ttu-id="ce427-120">Começando com o Windows Vista, o controle de conta de usuário (UAC) determina as credenciais de um usuário.</span><span class="sxs-lookup"><span data-stu-id="ce427-120">Starting with Windows Vista, User Account Control (UAC) determines the credentials of a user.</span></span> <span data-ttu-id="ce427-121">Se for um membro do grupo Administradores Internos, você receberá dois tokens de acesso do tempo de execução: um token de acesso do usuário padrão e um token de acesso do administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-121">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="ce427-122">Por padrão, você está na função de usuário padrão.</span><span class="sxs-lookup"><span data-stu-id="ce427-122">By default, you are in the standard user role.</span></span> <span data-ttu-id="ce427-123">Para executar o código que acessa o log de segurança, você deve primeiro elevar suas credenciais de usuário padrão para o administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-123">To run the code that accesses the Security log, you must first elevate your credentials from standard user to administrator.</span></span> <span data-ttu-id="ce427-124">Você pode fazer isso quando você inicia um aplicativo abrindo o menu de atalho para o aplicativo (se você estiver usando um mouse, clique com botão direito no ícone do aplicativo) e que indica que você deseja executar como administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-124">You can do this when you start an application by opening the shortcut menu for the application (if you're using a mouse, right-click the application icon) and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="ce427-125">Você pode usar <xref:System.Diagnostics.EventLog> para criar logs de eventos personalizados que podem ser exibidos por meio do servidor do Visualizador de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-125">You can use <xref:System.Diagnostics.EventLog> to create custom event logs that you can view through the server's Event Viewer.</span></span> <span data-ttu-id="ce427-126">Use o <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> método para exibir um nome localizado para o log de eventos no Visualizador de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-126">Use the <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> method to display a localized name for your event log in the Event Viewer.</span></span> <span data-ttu-id="ce427-127">Use o <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> método para configurar o comportamento do seu log de eventos quando ele atinge seu tamanho máximo do log.</span><span class="sxs-lookup"><span data-stu-id="ce427-127">Use the <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method to configure the behavior of your event log when it reaches its maximum log size.</span></span>  
  
 <span data-ttu-id="ce427-128">Para ler de um log de eventos, especifique o nome do log (<xref:System.Diagnostics.EventLog.Log%2A> propriedade) e o nome de computador do servidor (<xref:System.Diagnostics.EventLog.MachineName%2A> propriedade para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-128">To read from an event log, specify the log name (<xref:System.Diagnostics.EventLog.Log%2A> property) and server computer name (<xref:System.Diagnostics.EventLog.MachineName%2A> property for the event log.</span></span> <span data-ttu-id="ce427-129">Se você não especificar o nome de computador do servidor, o computador local, ".", será assumido.</span><span class="sxs-lookup"><span data-stu-id="ce427-129">If you don't specify the server computer name, the local computer, ".", is assumed.</span></span> <span data-ttu-id="ce427-130">Não é necessário especificar a origem do evento (<xref:System.Diagnostics.EventLog.Source%2A> propriedade), pois uma origem só é necessária para gravar em logs.</span><span class="sxs-lookup"><span data-stu-id="ce427-130">It's not necessary to specify the event source (<xref:System.Diagnostics.EventLog.Source%2A> property), because a source is required only for writing to logs.</span></span> <span data-ttu-id="ce427-131">O <xref:System.Diagnostics.EventLog.Entries%2A> propriedade é preenchida automaticamente com a lista de eventos do log de entradas.</span><span class="sxs-lookup"><span data-stu-id="ce427-131">The  <xref:System.Diagnostics.EventLog.Entries%2A> property is automatically populated with the event log's list of entries.</span></span>  
  
 <span data-ttu-id="ce427-132">Para gravar um log de eventos, especificar ou criar uma fonte de evento (<xref:System.Diagnostics.EventLog.Source%2A> propriedade).</span><span class="sxs-lookup"><span data-stu-id="ce427-132">To write to an event log, specify or create an event source (<xref:System.Diagnostics.EventLog.Source%2A> property).</span></span> <span data-ttu-id="ce427-133">Você deve ter credenciais administrativas no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-133">You must have administrative credentials on the computer to create a new event source.</span></span> <span data-ttu-id="ce427-134">A origem do evento registra seu aplicativo com o log de eventos como uma fonte válida de entradas.</span><span class="sxs-lookup"><span data-stu-id="ce427-134">The event source registers your application with the event log as a valid source of entries.</span></span> <span data-ttu-id="ce427-135">Você pode usar a origem do evento para gravar no log apenas uma por vez.</span><span class="sxs-lookup"><span data-stu-id="ce427-135">You can use the event source  to write to only one log at a time.</span></span> <span data-ttu-id="ce427-136">O <xref:System.Diagnostics.EventLog.Source%2A> propriedade pode ser qualquer cadeia de caracteres aleatória, mas o nome deve ser diferente de outras fontes no computador.</span><span class="sxs-lookup"><span data-stu-id="ce427-136">The <xref:System.Diagnostics.EventLog.Source%2A> property can be any random string, but the name must be distinct from other sources on the computer.</span></span> <span data-ttu-id="ce427-137">A origem do evento normalmente é o nome do aplicativo ou outra cadeia de caracteres de identifica.</span><span class="sxs-lookup"><span data-stu-id="ce427-137">The event source is typically the name of the application or another identifying string.</span></span> <span data-ttu-id="ce427-138">Ao tentar criar uma duplicata <xref:System.Diagnostics.EventLog.Source%2A> valor lança uma exceção.</span><span class="sxs-lookup"><span data-stu-id="ce427-138">Trying to create a duplicate <xref:System.Diagnostics.EventLog.Source%2A> value throws an exception.</span></span> <span data-ttu-id="ce427-139">No entanto, um único log de eventos pode ser associado a várias fontes.</span><span class="sxs-lookup"><span data-stu-id="ce427-139">However, a single event log can be associated with multiple sources.</span></span>  
  
 <span data-ttu-id="ce427-140">Se a origem do evento para o log de eventos associado com o <xref:System.Diagnostics.EventLog> instância não existe, uma nova origem do evento é criada.</span><span class="sxs-lookup"><span data-stu-id="ce427-140">If the event source for the event log associated with the <xref:System.Diagnostics.EventLog> instance doesn't exist, a new event source is created.</span></span> <span data-ttu-id="ce427-141">Para criar uma fonte de eventos no Windows Vista e posterior ou o Windows Server 2003, você deve ter credenciais administrativas.</span><span class="sxs-lookup"><span data-stu-id="ce427-141">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative credentials.</span></span>  
  
 <span data-ttu-id="ce427-142">Esse requisito existe porque todos os logs de eventos, incluindo logs de segurança, devem ser pesquisados para determinar se a origem do evento é exclusiva.</span><span class="sxs-lookup"><span data-stu-id="ce427-142">This requirement is because all event logs, including Security logs, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="ce427-143">Começando com o Windows Vista, os usuários não têm permissão para acessar o log de segurança; Portanto, um <xref:System.Security.SecurityException> é gerada.</span><span class="sxs-lookup"><span data-stu-id="ce427-143">Starting with Windows Vista, users do not have permission to access the Security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="ce427-144">Criar ou excluir uma fonte de evento requer a sincronização do código subjacente por meio de um mutex nomeado.</span><span class="sxs-lookup"><span data-stu-id="ce427-144">Creating or deleting an event source requires synchronization of the underlying code by using a named mutex.</span></span> <span data-ttu-id="ce427-145">Se um aplicativo altamente privilegiado bloqueia o mutex nomeado, tentando criar ou excluir uma fonte de evento faz com que o aplicativo pare de responder até que o bloqueio seja liberado.</span><span class="sxs-lookup"><span data-stu-id="ce427-145">If a highly privileged application locks the named mutex, trying to create or delete an event source causes the application to stop responding until the lock is released.</span></span> <span data-ttu-id="ce427-146">Para ajudar a evitar esse problema, não conceda <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permissão para código não confiável.</span><span class="sxs-lookup"><span data-stu-id="ce427-146">To help prevent this problem, never grant <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission to untrusted code.</span></span> <span data-ttu-id="ce427-147">Além disso, <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> potencialmente permissão permite que outras permissões para ser ignorada e deve ser concedida apenas a código altamente confiável.</span><span class="sxs-lookup"><span data-stu-id="ce427-147">In addition, <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission potentially allows other permissions to be bypassed and should only be granted to highly trusted code.</span></span>  
  
 <span data-ttu-id="ce427-148">Aplicativos e serviços devem gravar no log de aplicativo ou em um log personalizado.</span><span class="sxs-lookup"><span data-stu-id="ce427-148">Applications and services should write to the Application log or to a custom log.</span></span> <span data-ttu-id="ce427-149">Drivers de dispositivo devem gravar no log do sistema.</span><span class="sxs-lookup"><span data-stu-id="ce427-149">Device drivers should write to the System log.</span></span> <span data-ttu-id="ce427-150">Se você não definir explicitamente o <xref:System.Diagnostics.EventLog.Log%2A> propriedade, o log de eventos assume como padrão o log do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-150">If you do not explicitly set the <xref:System.Diagnostics.EventLog.Log%2A> property, the event log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-151">Não há nada para proteger um aplicativo contra gravação como qualquer fonte registrada.</span><span class="sxs-lookup"><span data-stu-id="ce427-151">There is nothing to protect an application from writing as any registered source.</span></span>  <span data-ttu-id="ce427-152">Se um aplicativo é concedido <xref:System.Diagnostics.EventLogPermissionAccess.Write> permissão, ele pode gravar eventos para qualquer fonte válido registrado no computador.</span><span class="sxs-lookup"><span data-stu-id="ce427-152">If an application is granted <xref:System.Diagnostics.EventLogPermissionAccess.Write> permission, it can write events for any valid source registered on the computer.</span></span>  
  
 <span data-ttu-id="ce427-153">Use o <xref:System.Diagnostics.EventLog.WriteEvent%2A> e <xref:System.Diagnostics.EventLog.WriteEntry%2A> métodos para gravar eventos em um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-153">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> methods to write events to an event log.</span></span> <span data-ttu-id="ce427-154">Você deve especificar uma origem de evento para gravar eventos; Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-154">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="ce427-155">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-155">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-156">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-156">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-157">Se o sistema operacional não tiver atualizado sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-157">If the operating system hasn't refreshed its list of event sources, and you try to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-158">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller> objeto ou o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-158">You can configure a new source by using an <xref:System.Diagnostics.EventLogInstaller> object or the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-159">Você deve ter credenciais administrativas no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-159">You must have administrative credentials on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-160">Cada fonte pode gravar apenas um log de eventos ao mesmo tempo; No entanto, seu aplicativo pode usar várias fontes para gravar em vários logs de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-160">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="ce427-161">Por exemplo, seu aplicativo pode exigir várias fontes, configurados para arquivos de recurso diferente ou logs de eventos diferentes.</span><span class="sxs-lookup"><span data-stu-id="ce427-161">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span> <span data-ttu-id="ce427-162">Para alterar os detalhes de configuração de uma fonte existente, você deve excluir a fonte e, em seguida, criá-lo com a nova configuração.</span><span class="sxs-lookup"><span data-stu-id="ce427-162">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="ce427-163">Se outros aplicativos ou componentes de usam o código-fonte existente, crie uma nova fonte com a configuração atualizada em vez de excluir o código-fonte existente.</span><span class="sxs-lookup"><span data-stu-id="ce427-163">If other applications or components use the existing source, create a new source with the updated configuration instead of deleting the existing source.</span></span>  
  
 <span data-ttu-id="ce427-164">Você pode registrar a origem do evento com os recursos localizados para suas cadeias de caracteres de categoria e mensagem de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-164">You can register the event source with localized resources for your event category and message strings.</span></span> <span data-ttu-id="ce427-165">Seu aplicativo pode gravar entradas de log de eventos usando identificadores de recurso em vez de especificar os valores de cadeia de caracteres real.</span><span class="sxs-lookup"><span data-stu-id="ce427-165">Your application can write event log entries by using resource identifiers instead of specifying the actual string values.</span></span> <span data-ttu-id="ce427-166">Consulte a <xref:System.Diagnostics.EventLogInstaller> e <xref:System.Diagnostics.EventSourceCreationData> classes para obter mais informações sobre como configurar sua fonte com arquivos de recurso.</span><span class="sxs-lookup"><span data-stu-id="ce427-166">Refer to the <xref:System.Diagnostics.EventLogInstaller> and <xref:System.Diagnostics.EventSourceCreationData> classes for more information about configuring your source with resource files.</span></span>  
  
 <span data-ttu-id="ce427-167">Se seu aplicativo grava os valores de cadeia de caracteres diretamente ao log de eventos, você não precisa definir o recurso de propriedades de arquivo para a fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-167">If your application writes string values directly to the event log, you do not have to set the resource file properties for the source.</span></span> <span data-ttu-id="ce427-168">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-168">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-169">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-169">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-170">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-170">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-171">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-171">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="ce427-172">Ao gravar eventos, você deve especificar pelo menos uma cadeia de caracteres de mensagem ou o identificador de recurso para uma cadeia de caracteres de mensagem.</span><span class="sxs-lookup"><span data-stu-id="ce427-172">When writing events, you must at least specify either a message string or the resource identifier for a message string.</span></span> <span data-ttu-id="ce427-173">Outras propriedades de evento são opcionais.</span><span class="sxs-lookup"><span data-stu-id="ce427-173">Other event properties are optional.</span></span> <span data-ttu-id="ce427-174">Exemplos de configurações de evento opcional incluem o seguinte:</span><span class="sxs-lookup"><span data-stu-id="ce427-174">Examples of optional event settings include the following:</span></span>  
  
-   <span data-ttu-id="ce427-175">Você pode definir o <xref:System.Diagnostics.EventLogEntryType> para especificar o ícone exibido do Visualizador de eventos para a entrada.</span><span class="sxs-lookup"><span data-stu-id="ce427-175">You can set the <xref:System.Diagnostics.EventLogEntryType> to specify the icon that the Event Viewer displays for the entry.</span></span>  
  
-   <span data-ttu-id="ce427-176">Você pode especificar um identificador de categoria de evento, se seu aplicativo usa categorias para filtrar os eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-176">You can specify a category identifier for the event, if your application uses categories for filtering the events.</span></span>  
  
-   <span data-ttu-id="ce427-177">Você pode anexar dados binários a sua inscrição de evento, se você quiser associar informações adicionais um determinado evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-177">You can attach binary data to your event entry if you want to associate additional information with a given event.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="ce427-178">O log de eventos consome espaço em disco, o tempo do processador e outros recursos do sistema.</span><span class="sxs-lookup"><span data-stu-id="ce427-178">Event logging consumes disk space, processor time, and other system resources.</span></span> <span data-ttu-id="ce427-179">É importante fazer logon somente informações essenciais.</span><span class="sxs-lookup"><span data-stu-id="ce427-179">It is important to log only essential information.</span></span> <span data-ttu-id="ce427-180">É recomendável que você coloque chamadas de log de eventos em um caminho de erro, em vez de no caminho do código principal, portanto, eles não afetarem negativamente o desempenho.</span><span class="sxs-lookup"><span data-stu-id="ce427-180">We recommend that you place event log calls in an error path, rather than in the main code path, so they don't adversely affect performance.</span></span>  
  
 <span data-ttu-id="ce427-181">Para obter uma lista de valores de propriedade inicial para uma instância do <xref:System.Diagnostics.EventLog>, consulte o <xref:System.Diagnostics.EventLog.%23ctor%2A> construtor.</span><span class="sxs-lookup"><span data-stu-id="ce427-181">For a list of initial property values for an instance of <xref:System.Diagnostics.EventLog>, see the <xref:System.Diagnostics.EventLog.%23ctor%2A> constructor.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-182">O exemplo a seguir cria a origem do evento `MySource` se ele ainda não existir e grava uma entrada no log de eventos `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="ce427-182">The following example creates the event source `MySource` if it doesn't already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-183">Começando com o Windows Vista, você deve executar esse aplicativo como administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-183">Starting with Windows Vista, you must run this application as an administrator.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="T:System.Diagnostics.EventLogInstaller" />
    <altmember cref="T:System.Diagnostics.EventLogEntry" />
    <altmember cref="T:System.Diagnostics.EntryWrittenEventArgs" />
    <altmember cref="T:System.ServiceProcess.ServiceBase" />
  </Docs>
  <Members>
    <MemberGroup MemberName=".ctor">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-184">Inicializa uma nova instância da classe <see cref="T:System.Diagnostics.EventLog" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-184">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="ce427-185">Inicializa uma nova instância da classe <see cref="T:System.Diagnostics.EventLog" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-185">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
          <span data-ttu-id="ce427-186">Não associe a instância a nenhum log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-186">Does not associate the instance with any log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-187">Antes de chamar <xref:System.Diagnostics.EventLog.WriteEntry%2A>, especifique o <xref:System.Diagnostics.EventLog.Source%2A> propriedade do <xref:System.Diagnostics.EventLog> instância.</span><span class="sxs-lookup"><span data-stu-id="ce427-187">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="ce427-188">Se você só estiver lendo <xref:System.Diagnostics.EventLog.Entries%2A> do log, você poderá especificar apenas o <xref:System.Diagnostics.EventLog.Log%2A> e <xref:System.Diagnostics.EventLog.MachineName%2A> propriedades.</span><span class="sxs-lookup"><span data-stu-id="ce427-188">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-189">Se você não especificar um <xref:System.Diagnostics.EventLog.MachineName%2A>, o computador local (".") é assumido.</span><span class="sxs-lookup"><span data-stu-id="ce427-189">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="ce427-190">A tabela a seguir mostra os valores de propriedade inicial para uma instância do <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="ce427-190">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="ce427-191">Propriedade</span><span class="sxs-lookup"><span data-stu-id="ce427-191">Property</span></span>|<span data-ttu-id="ce427-192">Valor inicial</span><span class="sxs-lookup"><span data-stu-id="ce427-192">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="ce427-193">Uma cadeia de caracteres vazia ("").</span><span class="sxs-lookup"><span data-stu-id="ce427-193">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="ce427-194">Uma cadeia de caracteres vazia ("").</span><span class="sxs-lookup"><span data-stu-id="ce427-194">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="ce427-195">O computador local (".").</span><span class="sxs-lookup"><span data-stu-id="ce427-195">The local computer (".").</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="ce427-196">O exemplo a seguir cria a fonte `MySource` se ele ainda não existir e grava uma entrada no log de eventos `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="ce427-196">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-197">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-197">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-198">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-198">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog logName" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="ce427-199">O nome do log no computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-199">The name of the log on the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-200">Inicializa uma nova instância da classe <see cref="T:System.Diagnostics.EventLog" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-200">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
          <span data-ttu-id="ce427-201">Associa a instância a log no computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-201">Associates the instance with a log on the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-202">Essa sobrecarga define o <xref:System.Diagnostics.EventLog.Log%2A> propriedade para o `logName` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="ce427-202">This overload sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter.</span></span> <span data-ttu-id="ce427-203">Antes de chamar <xref:System.Diagnostics.EventLog.WriteEntry%2A>, especifique o <xref:System.Diagnostics.EventLog.Source%2A> propriedade do <xref:System.Diagnostics.EventLog> instância.</span><span class="sxs-lookup"><span data-stu-id="ce427-203">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="ce427-204">Se você só estiver lendo <xref:System.Diagnostics.EventLog.Entries%2A> do log, você poderá especificar apenas o <xref:System.Diagnostics.EventLog.Log%2A> e <xref:System.Diagnostics.EventLog.MachineName%2A> propriedades.</span><span class="sxs-lookup"><span data-stu-id="ce427-204">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-205">Se você não especificar um <xref:System.Diagnostics.EventLog.MachineName%2A>, o computador local (".") é assumido.</span><span class="sxs-lookup"><span data-stu-id="ce427-205">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span> <span data-ttu-id="ce427-206">Essa sobrecarga do construtor Especifica o <xref:System.Diagnostics.EventLog.Log%2A> propriedade, mas você pode alterar isso antes de ler o <xref:System.Diagnostics.EventLog.Entries%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="ce427-206">This overload of the constructor specifies the <xref:System.Diagnostics.EventLog.Log%2A> property, but you can change this before reading the <xref:System.Diagnostics.EventLog.Entries%2A> property.</span></span>  
  
 <span data-ttu-id="ce427-207">Se a fonte que você especificar na <xref:System.Diagnostics.EventLog.Source%2A> propriedade é exclusiva de outras fontes no computador, uma chamada subsequente para <xref:System.Diagnostics.EventLog.WriteEntry%2A> cria um log com o nome especificado, se ele ainda não existir.</span><span class="sxs-lookup"><span data-stu-id="ce427-207">If the source you specify in the <xref:System.Diagnostics.EventLog.Source%2A> property is unique from other sources on the computer, a subsequent call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> creates a log with the specified name, if it does not already exist.</span></span>  
  
 <span data-ttu-id="ce427-208">A tabela a seguir mostra os valores de propriedade inicial para uma instância do <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="ce427-208">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="ce427-209">Propriedade</span><span class="sxs-lookup"><span data-stu-id="ce427-209">Property</span></span>|<span data-ttu-id="ce427-210">Valor inicial</span><span class="sxs-lookup"><span data-stu-id="ce427-210">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="ce427-211">Uma cadeia de caracteres vazia ("").</span><span class="sxs-lookup"><span data-stu-id="ce427-211">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="ce427-212">O parâmetro `logName`.</span><span class="sxs-lookup"><span data-stu-id="ce427-212">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="ce427-213">O computador local (".").</span><span class="sxs-lookup"><span data-stu-id="ce427-213">The local computer (".").</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="ce427-214">O exemplo a seguir lê as entradas no log de eventos, "myNewLog", no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-214">The following example reads entries in the event log, "myNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="ce427-215">O nome do log é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-215">The log name is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-216">O nome do log é inválido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-216">The log name is invalid.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-217">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-217">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-218">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-218">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string * string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog (logName, machineName)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="ce427-219">O nome do log no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-219">The name of the log on the specified computer.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="ce427-220">O computador no qual o log existe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-220">The computer on which the log exists.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-221">Inicializa uma nova instância da classe <see cref="T:System.Diagnostics.EventLog" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-221">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
          <span data-ttu-id="ce427-222">Associa a instância a um log no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-222">Associates the instance with a log on the specified computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-223">Essa sobrecarga define o <xref:System.Diagnostics.EventLog.Log%2A> propriedade para o `logName` parâmetro e o <xref:System.Diagnostics.EventLog.MachineName%2A> propriedade para o `machineName` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="ce427-223">This overload sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter and the <xref:System.Diagnostics.EventLog.MachineName%2A> property to the `machineName` parameter.</span></span> <span data-ttu-id="ce427-224">Antes de chamar <xref:System.Diagnostics.EventLog.WriteEntry%2A>, especifique o <xref:System.Diagnostics.EventLog.Source%2A> propriedade do <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="ce427-224">Before calling <xref:System.Diagnostics.EventLog.WriteEntry%2A>, specify the <xref:System.Diagnostics.EventLog.Source%2A> property of the <xref:System.Diagnostics.EventLog>.</span></span> <span data-ttu-id="ce427-225">Se você só estiver lendo <xref:System.Diagnostics.EventLog.Entries%2A> do log, você poderá especificar apenas o <xref:System.Diagnostics.EventLog.Log%2A> e <xref:System.Diagnostics.EventLog.MachineName%2A> propriedades.</span><span class="sxs-lookup"><span data-stu-id="ce427-225">If you are only reading <xref:System.Diagnostics.EventLog.Entries%2A> from the log, you can alternatively specify only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-226">Essa sobrecarga do construtor Especifica o <xref:System.Diagnostics.EventLog.Log%2A> e <xref:System.Diagnostics.EventLog.MachineName%2A> propriedades, mas você pode alterar qualquer uma antes de ler o <xref:System.Diagnostics.EventLog.Entries%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="ce427-226">This overload of the constructor specifies the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties, but you can change either before reading the <xref:System.Diagnostics.EventLog.Entries%2A> property.</span></span>  
  
 <span data-ttu-id="ce427-227">A tabela a seguir mostra os valores de propriedade inicial para uma instância do <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="ce427-227">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="ce427-228">Propriedade</span><span class="sxs-lookup"><span data-stu-id="ce427-228">Property</span></span>|<span data-ttu-id="ce427-229">Valor inicial</span><span class="sxs-lookup"><span data-stu-id="ce427-229">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="ce427-230">Uma cadeia de caracteres vazia ("").</span><span class="sxs-lookup"><span data-stu-id="ce427-230">An empty string ("").</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="ce427-231">O parâmetro `logName`.</span><span class="sxs-lookup"><span data-stu-id="ce427-231">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="ce427-232">O parâmetro `machineName`.</span><span class="sxs-lookup"><span data-stu-id="ce427-232">The `machineName` parameter.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="ce427-233">O exemplo a seguir lê as entradas no log de eventos, "myNewLog", no computador "meuservidor".</span><span class="sxs-lookup"><span data-stu-id="ce427-233">The following example reads entries in the event log, "myNewLog", on the computer "myServer".</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog2 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog2 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="ce427-234">O nome do log é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-234">The log name is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-235">O nome do log é inválido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-235">The log name is invalid.</span>
          </span>
          <span data-ttu-id="ce427-236">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-236">-or-</span>
          </span>
          <span data-ttu-id="ce427-237">O nome do computador é inválido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-237">The computer name is invalid.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-238">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-238">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-239">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-239">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public EventLog (string logName, string machineName, string source);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor(string logName, string machineName, string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.#ctor(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub New (logName As String, machineName As String, source As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; EventLog(System::String ^ logName, System::String ^ machineName, System::String ^ source);" />
      <MemberSignature Language="F#" Value="new System.Diagnostics.EventLog : string * string * string -&gt; System.Diagnostics.EventLog" Usage="new System.Diagnostics.EventLog (logName, machineName, source)" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="ce427-240">O nome do log no computador especificado</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-240">The name of the log on the specified computer</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="ce427-241">O computador no qual o log existe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-241">The computer on which the log exists.</span>
          </span>
        </param>
        <param name="source">
          <span data-ttu-id="ce427-242">A origem das entradas de log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-242">The source of event log entries.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-243">Inicializa uma nova instância da classe <see cref="T:System.Diagnostics.EventLog" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-243">Initializes a new instance of the <see cref="T:System.Diagnostics.EventLog" /> class.</span>
          </span>
          <span data-ttu-id="ce427-244">Associa a instância a um log no computador especificado e cria ou atribui a origem indicada para o <see cref="T:System.Diagnostics.EventLog" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-244">Associates the instance with a log on the specified computer and creates or assigns the specified source to the <see cref="T:System.Diagnostics.EventLog" />.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-245">Este construtor define a <xref:System.Diagnostics.EventLog.Log%2A> propriedade para o `logName` parâmetro, o <xref:System.Diagnostics.EventLog.MachineName%2A> propriedade para o `machineName` parâmetro e o <xref:System.Diagnostics.EventLog.Source%2A> propriedade para o `source` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="ce427-245">This constructor sets the <xref:System.Diagnostics.EventLog.Log%2A> property to the `logName` parameter, the <xref:System.Diagnostics.EventLog.MachineName%2A> property to the `machineName` parameter, and the <xref:System.Diagnostics.EventLog.Source%2A> property to the `source` parameter.</span></span> <span data-ttu-id="ce427-246">O <xref:System.Diagnostics.EventLog.Source%2A> propriedade é necessária ao gravar em um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-246">The <xref:System.Diagnostics.EventLog.Source%2A> property is required when writing to an event log.</span></span> <span data-ttu-id="ce427-247">No entanto, se você estiver lendo apenas de um log de eventos, apenas o <xref:System.Diagnostics.EventLog.Log%2A> e <xref:System.Diagnostics.EventLog.MachineName%2A> propriedades são necessárias (desde que o log de eventos no servidor tem uma fonte que já está associada a ele).</span><span class="sxs-lookup"><span data-stu-id="ce427-247">However, if you are only reading from an event log, only the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> properties are required (as long as the event log on the server has a source already associated with it).</span></span> <span data-ttu-id="ce427-248">Se você estiver lendo apenas do log de eventos, outra sobrecarga do construtor deve ser suficiente.</span><span class="sxs-lookup"><span data-stu-id="ce427-248">If you are only reading from the event log, another overload of the constructor might suffice.</span></span>  
  
 <span data-ttu-id="ce427-249">A tabela a seguir mostra os valores de propriedade inicial para uma instância do <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="ce427-249">The following table shows initial property values for an instance of <xref:System.Diagnostics.EventLog>.</span></span>  
  
|<span data-ttu-id="ce427-250">Propriedade</span><span class="sxs-lookup"><span data-stu-id="ce427-250">Property</span></span>|<span data-ttu-id="ce427-251">Valor inicial</span><span class="sxs-lookup"><span data-stu-id="ce427-251">Initial Value</span></span>|  
|--------------|-------------------|  
|<xref:System.Diagnostics.EventLog.Source%2A>|<span data-ttu-id="ce427-252">O parâmetro `source`.</span><span class="sxs-lookup"><span data-stu-id="ce427-252">The `source` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.Log%2A>|<span data-ttu-id="ce427-253">O parâmetro `logName`.</span><span class="sxs-lookup"><span data-stu-id="ce427-253">The `logName` parameter.</span></span>|  
|<xref:System.Diagnostics.EventLog.MachineName%2A>|<span data-ttu-id="ce427-254">O parâmetro `machineName`.</span><span class="sxs-lookup"><span data-stu-id="ce427-254">The `machineName` parameter.</span></span>|  
  
   
  
## Examples  
 <span data-ttu-id="ce427-255">O exemplo a seguir grava uma entrada para um log de eventos "MyNewLog" no computador local, usando a fonte "MySource".</span><span class="sxs-lookup"><span data-stu-id="ce427-255">The following example writes an entry to an event log, "MyNewLog", on the local computer, using the source "MySource".</span></span>  
  
 [!code-cpp[Classic EventLog.EventLog3 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EventLog3 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EventLog3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EventLog3 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="ce427-256">O nome do log é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-256">The log name is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-257">O nome do log é inválido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-257">The log name is invalid.</span>
          </span>
          <span data-ttu-id="ce427-258">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-258">-or-</span>
          </span>
          <span data-ttu-id="ce427-259">O nome do computador é inválido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-259">The computer name is invalid.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-260">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-260">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-261">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-261">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEvent" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
      </Docs>
    </Member>
    <Member MemberName="BeginInit">
      <MemberSignature Language="C#" Value="public void BeginInit ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void BeginInit() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.BeginInit" />
      <MemberSignature Language="VB.NET" Value="Public Sub BeginInit ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void BeginInit();" />
      <MemberSignature Language="F#" Value="abstract member BeginInit : unit -&gt; unit&#xA;override this.BeginInit : unit -&gt; unit" Usage="eventLog.BeginInit " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.ComponentModel.ISupportInitialize.BeginInit</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="ce427-262">Começa a inicialização de um <see cref="T:System.Diagnostics.EventLog" /> usado em um formulário ou por outro componente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-262">Begins the initialization of an <see cref="T:System.Diagnostics.EventLog" /> used on a form or used by another component.</span>
          </span>
          <span data-ttu-id="ce427-263">A inicialização ocorre em tempo de execução.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-263">The initialization occurs at runtime.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-264">O [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] ambiente usa esse método para iniciar a inicialização de um componente usado em um formulário ou por outro componente de design.</span><span class="sxs-lookup"><span data-stu-id="ce427-264">The [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] design environment uses this method to start the initialization of a component used on a form or by another component.</span></span> <span data-ttu-id="ce427-265">O <xref:System.Diagnostics.EventLog.EndInit%2A> método encerra a inicialização.</span><span class="sxs-lookup"><span data-stu-id="ce427-265">The <xref:System.Diagnostics.EventLog.EndInit%2A> method ends the initialization.</span></span> <span data-ttu-id="ce427-266">Usando o <xref:System.Diagnostics.EventLog.BeginInit%2A> e <xref:System.Diagnostics.EventLog.EndInit%2A> métodos impedir que o controle que está sendo usado antes de ser totalmente inicializado.</span><span class="sxs-lookup"><span data-stu-id="ce427-266">Using the <xref:System.Diagnostics.EventLog.BeginInit%2A> and <xref:System.Diagnostics.EventLog.EndInit%2A> methods prevent the control from being used before it is fully initialized.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-267">
            <see cref="T:System.Diagnostics.EventLog" /> já foi inicializado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-267">
              <see cref="T:System.Diagnostics.EventLog" /> is already initialized.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-268">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-268">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-269">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-269">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.EndInit" />
      </Docs>
    </Member>
    <Member MemberName="Clear">
      <MemberSignature Language="C#" Value="public void Clear ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Clear() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Clear" />
      <MemberSignature Language="VB.NET" Value="Public Sub Clear ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Clear();" />
      <MemberSignature Language="F#" Value="member this.Clear : unit -&gt; unit" Usage="eventLog.Clear " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="ce427-270">Remove todas as entradas do log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-270">Removes all entries from the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-271">Logs de eventos são definidos com um tamanho máximo que determina quantas entradas podem conter.</span><span class="sxs-lookup"><span data-stu-id="ce427-271">Event logs are set with a maximum size that determines how many entries they can contain.</span></span> <span data-ttu-id="ce427-272">Quando um log de eventos estiver cheio, ele interrompe a gravação de novas informações de evento ou começa a substituir entradas anteriores.</span><span class="sxs-lookup"><span data-stu-id="ce427-272">When an event log is full, it stops recording new event information or begins to overwrite earlier entries.</span></span> <span data-ttu-id="ce427-273">Se parar a gravação de eventos, você pode usar esse método para limpar o log de entradas existentes e permitir que ele inicie novamente o registro de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-273">If event recording stops, you can use this method to clear the log of existing entries and allow it to start recording events again.</span></span> <span data-ttu-id="ce427-274">Você deve ter permissões de administrador no computador no qual o log reside para limpar entradas de log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-274">You must have administrator permissions to the computer on which the log resides to clear event log entries.</span></span>  
  
 <span data-ttu-id="ce427-275"><xref:System.Diagnostics.EventLog.Clear%2A> Fecha o log de eventos, libera os identificadores de eventos, recupera a nova leitura e gravação de identificadores e reabrir o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-275"><xref:System.Diagnostics.EventLog.Clear%2A> closes the event log, releases the event handles, retrieves new read and write handles, and reopens the event log.</span></span> <span data-ttu-id="ce427-276">Eventos recebidos após a chamada para o método não são removidos, juntamente com os eventos existentes.</span><span class="sxs-lookup"><span data-stu-id="ce427-276">Events received after the call to the method are not cleared along with the existing events.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-277">O exemplo a seguir limpa um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-277">The following example clears an event log.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="ce427-278">Porque o aplicativo, sistema, segurança e outros logs não personalizado podem conter informações cruciais; Certifique-se de especificar um log personalizado antes de executar esse código de exemplo.</span><span class="sxs-lookup"><span data-stu-id="ce427-278">Because Application, System, Security, and other non-custom logs can contain crucial information; be sure to specify a custom log before executing this example code.</span></span> <span data-ttu-id="ce427-279">Este exemplo exclui o log personalizado `myNewLog`.</span><span class="sxs-lookup"><span data-stu-id="ce427-279">This example deletes the custom log `myNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Clear Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Clear Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Clear Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Clear Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-280">Não foi possível limpar o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-280">The event log was not cleared successfully.</span>
          </span>
          <span data-ttu-id="ce427-281">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-281">-or-</span>
          </span>
          <span data-ttu-id="ce427-282">Não é possível abrir o log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-282">The log cannot be opened.</span>
          </span>
          <span data-ttu-id="ce427-283">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-283">A Windows error code is not available.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-284">Não há valor especificado para a propriedade <see cref="P:System.Diagnostics.EventLog.Log" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-284">A value is not specified for the <see cref="P:System.Diagnostics.EventLog.Log" /> property.</span>
          </span>
          <span data-ttu-id="ce427-285">Verifique se que o nome do log não é uma cadeia de caracteres vazia.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-285">Make sure the log name is not an empty string.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-286">Log inexistente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-286">The log does not exist.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-287">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-287">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-288">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-288">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="Close">
      <MemberSignature Language="C#" Value="public void Close ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void Close() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Close" />
      <MemberSignature Language="VB.NET" Value="Public Sub Close ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void Close();" />
      <MemberSignature Language="F#" Value="member this.Close : unit -&gt; unit" Usage="eventLog.Close " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="ce427-289">Fecha o log de eventos e libera os identificadores de leitura e gravação.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-289">Closes the event log and releases read and write handles.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-290">O <xref:System.Diagnostics.EventLog.Close%2A> método é chamado pelo protegido <xref:System.ComponentModel.Component.Dispose%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-290">The <xref:System.Diagnostics.EventLog.Close%2A> method is called by the protected <xref:System.ComponentModel.Component.Dispose%2A> method.</span></span> <span data-ttu-id="ce427-291">Você não precisa invocar <xref:System.Diagnostics.EventLog.Close%2A> antes de chamar <xref:System.ComponentModel.Component.Dispose%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-291">You do not need to invoke <xref:System.Diagnostics.EventLog.Close%2A> before calling <xref:System.ComponentModel.Component.Dispose%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-292">O identificador de leitura ou de gravação do log de evento não foi liberado com êxito.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-292">The event log's read handle or write handle was not released successfully.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-293">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-293">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-294">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-294">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <MemberGroup MemberName="CreateEventSource">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-295">Estabelece um aplicativo como capaz de gravar informações de evento em um log específico no sistema.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-295">Establishes an application as able to write event information to a particular log on the system.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (System.Diagnostics.EventSourceCreationData sourceData);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(class System.Diagnostics.EventSourceCreationData sourceData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.Diagnostics.EventSourceCreationData)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (sourceData As EventSourceCreationData)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::Diagnostics::EventSourceCreationData ^ sourceData);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : System.Diagnostics.EventSourceCreationData -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource sourceData" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="sourceData" Type="System.Diagnostics.EventSourceCreationData" />
      </Parameters>
      <Docs>
        <param name="sourceData">
          <span data-ttu-id="ce427-296">As propriedades de configuração para a origem do evento e seu log de eventos de destino.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-296">The configuration properties for the event source and its target event log.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-297">Estabelece uma origem do evento válido para a gravação de mensagens de evento localizadas, usando as propriedades de configuração especificadas para a origem do evento e o log de eventos correspondente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-297">Establishes a valid event source for writing localized event messages, using the specified configuration properties for the event source and the corresponding event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-298">Use essa sobrecarga para configurar uma nova fonte para gravar entradas em um log de eventos no computador local ou em um computador remoto.</span><span class="sxs-lookup"><span data-stu-id="ce427-298">Use this overload to configure a new source for writing entries to an event log on the local computer or a remote computer.</span></span> <span data-ttu-id="ce427-299">Não é necessário usar esse método para ler de um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-299">It is not necessary to use this method to read from an event log.</span></span>  
  
 <span data-ttu-id="ce427-300">O <xref:System.Diagnostics.EventLog.CreateEventSource%2A> usa o método de entrada `sourceData` <xref:System.Diagnostics.EventSourceCreationData.Source%2A>, <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> e <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> as propriedades para criar valores do registro no computador de destino para a nova fonte e seu log de eventos associado.</span><span class="sxs-lookup"><span data-stu-id="ce427-300">The <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method uses the input `sourceData`<xref:System.Diagnostics.EventSourceCreationData.Source%2A>, <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> and <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> properties to create registry values on the target computer for the new source and its associated event log.</span></span> <span data-ttu-id="ce427-301">Um novo nome de origem não pode corresponder a um nome de origem existente ou um nome de log de eventos existente no computador de destino.</span><span class="sxs-lookup"><span data-stu-id="ce427-301">A new source name cannot match an existing source name or an existing event log name on the target computer.</span></span> <span data-ttu-id="ce427-302">Se o <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> não está definida, a origem é registrada para o log de eventos do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-302">If the <xref:System.Diagnostics.EventSourceCreationData.LogName%2A> property is not set, the source is registered for the Application event log.</span></span> <span data-ttu-id="ce427-303">Se o <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> não for definido, a fonte é registrada no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-303">If the <xref:System.Diagnostics.EventSourceCreationData.MachineName%2A> is not set, the source is registered on the local computer.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-304">Para criar uma fonte de eventos no Windows Vista e posterior ou o Windows Server 2003, você deve ter privilégios administrativos.</span><span class="sxs-lookup"><span data-stu-id="ce427-304">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="ce427-305">O motivo para esse requisito é que todos os logs de eventos, incluindo segurança, devem ser pesquisados para determinar se a origem do evento é exclusiva.</span><span class="sxs-lookup"><span data-stu-id="ce427-305">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="ce427-306">Começando com o Windows Vista, os usuários não têm permissão para acessar o log de segurança; Portanto, um <xref:System.Security.SecurityException> é gerada.</span><span class="sxs-lookup"><span data-stu-id="ce427-306">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="ce427-307">Começando com o Windows Vista, o controle de conta de usuário (UAC) determina os privilégios de um usuário.</span><span class="sxs-lookup"><span data-stu-id="ce427-307">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="ce427-308">Se for um membro do grupo Administradores Internos, você receberá dois tokens de acesso do tempo de execução: um token de acesso do usuário padrão e um token de acesso do administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-308">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="ce427-309">Por padrão, você está na função de usuário padrão.</span><span class="sxs-lookup"><span data-stu-id="ce427-309">By default, you are in the standard user role.</span></span> <span data-ttu-id="ce427-310">Para executar o código que acessa o log de segurança, você deve primeiro elevar seus privilégios de usuário padrão ao administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-310">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="ce427-311">Você pode fazer isso quando você iniciar um aplicativo clicando duas vezes no ícone do aplicativo e que indica que você deseja executar como administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-311">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="ce427-312">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> e <xref:System.Diagnostics.EventLog.WriteEntry%2A> para gravar eventos em um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-312">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="ce427-313">Você deve especificar uma origem de evento para gravar eventos; Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-313">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="ce427-314">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-314">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-315">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-315">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-316">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-316">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-317">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-317">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-318">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-318">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-319">Você pode criar uma fonte de evento para um log de eventos existente ou um novo log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-319">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="ce427-320">Quando você cria uma nova origem para um novo log de eventos, o sistema registra a origem para que o log, mas o log não é criado até que a primeira entrada seja gravada nele.</span><span class="sxs-lookup"><span data-stu-id="ce427-320">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="ce427-321">O sistema operacional armazena os logs de eventos como arquivos.</span><span class="sxs-lookup"><span data-stu-id="ce427-321">The operating system stores event logs as files.</span></span> <span data-ttu-id="ce427-322">Quando você usa <xref:System.Diagnostics.EventLogInstaller> ou <xref:System.Diagnostics.EventLog.CreateEventSource%2A> para criar um novo log de eventos, o arquivo associado é armazenado no diretório %SystemRoot%\System32\Config no computador especificado.</span><span class="sxs-lookup"><span data-stu-id="ce427-322">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="ce427-323">O nome do arquivo é definido por meio do acréscimo 8 primeiros caracteres da <xref:System.Diagnostics.EventLog.Log%2A> propriedade com a extensão de nome de arquivo ". evt".</span><span class="sxs-lookup"><span data-stu-id="ce427-323">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="ce427-324">Cada fonte pode gravar apenas em apenas um log de eventos ao mesmo tempo; No entanto, seu aplicativo pode usar várias fontes para gravar em vários logs de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-324">Each source can only write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="ce427-325">Por exemplo, seu aplicativo pode exigir várias fontes, configurados para arquivos de recurso diferente ou logs de eventos diferentes.</span><span class="sxs-lookup"><span data-stu-id="ce427-325">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="ce427-326">Você pode registrar a origem do evento com os arquivos de recurso localizado para suas cadeias de caracteres de categoria e mensagem de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-326">You can register the event source with localized resource file(s) for your event category and message strings.</span></span> <span data-ttu-id="ce427-327">Seu aplicativo pode gravar entradas de log de eventos usando identificadores de recurso, em vez de especificar a cadeia de caracteres real.</span><span class="sxs-lookup"><span data-stu-id="ce427-327">Your application can write event log entries using resource identifiers, rather than specifying the actual string.</span></span> <span data-ttu-id="ce427-328">O Visualizador de eventos usa o identificador de recurso para localizar e exibir a cadeia de caracteres correspondente do arquivo de recurso localizada com base nas configurações de idioma atual.</span><span class="sxs-lookup"><span data-stu-id="ce427-328">The Event Viewer uses the resource identifier to find and display the corresponding string from the localized resource file based on current language settings.</span></span> <span data-ttu-id="ce427-329">Você pode registrar um arquivo separado para categorias de evento, mensagens e cadeias de caracteres de inserção de parâmetro, ou você pode registrar o mesmo arquivo de recurso para todos os três tipos de cadeias de caracteres.</span><span class="sxs-lookup"><span data-stu-id="ce427-329">You can register a separate file for event categories, messages and parameter insertion strings, or you can register the same resource file for all three types of strings.</span></span> <span data-ttu-id="ce427-330">Use o <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>, e <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> propriedades para configurar a fonte para gravar entradas localizadas para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-330">Use the <xref:System.Diagnostics.EventSourceCreationData.CategoryCount%2A>, <xref:System.Diagnostics.EventSourceCreationData.CategoryResourceFile%2A>, <xref:System.Diagnostics.EventSourceCreationData.MessageResourceFile%2A>, and <xref:System.Diagnostics.EventSourceCreationData.ParameterResourceFile%2A> properties to configure the source to write localized entries to the event log.</span></span> <span data-ttu-id="ce427-331">Se seu aplicativo grava os valores de cadeias de caracteres diretamente ao log de eventos, você precisa definir essas propriedades.</span><span class="sxs-lookup"><span data-stu-id="ce427-331">If your application writes strings values directly to the event log, you do not need to set these properties.</span></span>  
  
 <span data-ttu-id="ce427-332">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-332">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-333">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-333">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-334">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-334">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-335">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-335">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="ce427-336">Para alterar os detalhes de configuração de uma fonte existente, você deve excluir a fonte e, em seguida, criá-lo com a nova configuração.</span><span class="sxs-lookup"><span data-stu-id="ce427-336">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="ce427-337">Se outros aplicativos ou componentes de usam o código-fonte existente, crie uma nova fonte com a configuração atualizada, em vez de excluir o código-fonte existente.</span><span class="sxs-lookup"><span data-stu-id="ce427-337">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-338">Se uma fonte é configurada para um log de eventos e reconfigurá-lo para outro log de eventos, você deve reiniciar o computador para que as alterações entrem em vigor.</span><span class="sxs-lookup"><span data-stu-id="ce427-338">If a source is configured for an event log, and you reconfigure it for another event log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-339">O exemplo a seguir determina se a origem do evento nomeado `SampleApplicationSource` está registrado no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-339">The following example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="ce427-340">Se a origem do evento não existir, o exemplo define o arquivo de recurso de mensagem para a fonte e cria a nova origem do evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-340">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="ce427-341">Por fim, o exemplo define o nome de exibição localizado para o log de eventos, usando o valor do identificador de recurso de `DisplayNameMsgId` e o caminho do arquivo de recurso no `messageFile`.</span><span class="sxs-lookup"><span data-stu-id="ce427-341">Finally, the example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="ce427-342">O exemplo usa o seguinte arquivo de texto de mensagem, criado para a biblioteca do recurso EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="ce427-342">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="ce427-343">Um arquivo de texto da mensagem é a origem do qual o arquivo de recurso de mensagem é criado.</span><span class="sxs-lookup"><span data-stu-id="ce427-343">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="ce427-344">O arquivo de texto de mensagem define os identificadores de recurso e o texto para a categoria, a mensagem de evento e a cadeias de caracteres de inserção de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="ce427-344">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="ce427-345">Especificamente, o identificador de recurso 5001 é definido para o nome localizado do log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-345">Specifically, resource identifier 5001 is defined for the localized name of the event log.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-346">O nome do computador especificado em <paramref name="sourceData" /> não é válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-346">The computer name specified in <paramref name="sourceData" /> is not valid.</span>
          </span>
          <span data-ttu-id="ce427-347">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-347">\- or -</span>
          </span>
          <span data-ttu-id="ce427-348">O nome da origem especificado em <paramref name="sourceData" /> é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-348">The source name specified in <paramref name="sourceData" /> is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="ce427-349">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-349">\- or -</span>
          </span>
          <span data-ttu-id="ce427-350">O nome do log especificado em <paramref name="sourceData" /> não é válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-350">The log name specified in <paramref name="sourceData" /> is not valid.</span>
          </span>
          <span data-ttu-id="ce427-351">Os nomes de log de eventos precisam serem compostos por caracteres imprimíveis e não podem incluir os caracteres “\*”, “?” ou “\\”.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-351">Event log names must consist of printable characters and cannot include the characters '\*', '?', or '\\'.</span>
          </span>
          <span data-ttu-id="ce427-352">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-352">\- or -</span>
          </span>
          <span data-ttu-id="ce427-353">O nome do log especificado em <paramref name="sourceData" /> não é válido para a criação de log do usuário.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-353">The log name specified in <paramref name="sourceData" /> is not valid for user log creation.</span>
          </span>
          <span data-ttu-id="ce427-354">Os nomes de log de eventos AppEvent, SysEvent e SecEvent são reservados para uso do sistema.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-354">The Event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span>
          </span>
          <span data-ttu-id="ce427-355">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-355">\- or -</span>
          </span>
          <span data-ttu-id="ce427-356">O nome do log corresponde a um nome de origem de evento existente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-356">The log name matches an existing event source name.</span>
          </span>
          <span data-ttu-id="ce427-357">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-357">\- or -</span>
          </span>
          <span data-ttu-id="ce427-358">O nome da origem especificado no <paramref name="sourceData" /> resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-358">The source name specified in <paramref name="sourceData" /> results in a registry key path longer than 254 characters.</span>
          </span>
          <span data-ttu-id="ce427-359">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-359">\- or -</span>
          </span>
          <span data-ttu-id="ce427-360">Os primeiros oito caracteres do nome do log especificado em <paramref name="sourceData" /> não são exclusivos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-360">The first 8 characters of the log name specified in <paramref name="sourceData" /> are not unique.</span>
          </span>
          <span data-ttu-id="ce427-361">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-361">\- or -</span>
          </span>
          <span data-ttu-id="ce427-362">O nome da origem especificado em <paramref name="sourceData" /> já está registrado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-362">The source name specified in <paramref name="sourceData" /> is already registered.</span>
          </span>
          <span data-ttu-id="ce427-363">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-363">\- or -</span>
          </span>
          <span data-ttu-id="ce427-364">O nome de origem especificado no <paramref name="sourceData" /> corresponde a um nome de log de eventos existente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-364">The source name specified in <paramref name="sourceData" /> matches an existing event log name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-365">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-365">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="ce427-366">
            <paramref name="sourceData" /> é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-366">
              <paramref name="sourceData" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-367">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-367">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-368">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-368">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventSourceCreationData" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="T:System.Diagnostics.EventLogInstaller" />
      </Docs>
    </Member>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (string source, string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(string source, string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (source As String, logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::String ^ source, System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource (source, logName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="ce427-369">O nome de origem com o qual o aplicativo está registrado no computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-369">The source name by which the application is registered on the local computer.</span>
          </span>
        </param>
        <param name="logName">
          <span data-ttu-id="ce427-370">O nome do log no qual as entradas da fonte são gravadas.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-370">The name of the log the source's entries are written to.</span>
          </span>
          <span data-ttu-id="ce427-371">Os valores possíveis incluem Aplicativo, Sistema ou um log de eventos personalizado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-371">Possible values include Application, System, or a custom event log.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-372">Estabelece o nome de origem especificado como uma origem de evento válida para gravar entradas em um log no computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-372">Establishes the specified source name as a valid event source for writing entries to a log on the local computer.</span>
          </span>
          <span data-ttu-id="ce427-373">Esse método também pode criar um novo log personalizado no computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-373">This method can also create a new custom log on the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-374">Use essa sobrecarga para criar um log personalizado ou para criar e registrar um <xref:System.Diagnostics.EventLog.Source%2A> em um log existente no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-374">Use this overload to create a custom log or to create and register a <xref:System.Diagnostics.EventLog.Source%2A> to an existing log on the local computer.</span></span>  
  
 <span data-ttu-id="ce427-375">Se `logName` está `null` ou uma cadeia de caracteres vazia ("") quando você chama <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, o log padrão é o log de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-375">If `logName` is `null` or an empty string ("") when you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, the log defaults to the Application log.</span></span> <span data-ttu-id="ce427-376">Se o log não existe no computador local, o sistema cria um log personalizado e registra seu aplicativo como um <xref:System.Diagnostics.EventLog.Source%2A> para que o log.</span><span class="sxs-lookup"><span data-stu-id="ce427-376">If the log does not exist on the local computer, the system creates a custom log and registers your application as a <xref:System.Diagnostics.EventLog.Source%2A> for that log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-377">Para criar uma fonte de eventos no Windows Vista e posterior ou o Windows Server 2003, você deve ter privilégios administrativos.</span><span class="sxs-lookup"><span data-stu-id="ce427-377">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="ce427-378">O motivo para esse requisito é que todos os logs de eventos, incluindo segurança, devem ser pesquisados para determinar se a origem do evento é exclusiva.</span><span class="sxs-lookup"><span data-stu-id="ce427-378">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="ce427-379">Começando com o Windows Vista, os usuários não têm permissão para acessar o log de segurança; Portanto, um <xref:System.Security.SecurityException> é gerada.</span><span class="sxs-lookup"><span data-stu-id="ce427-379">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="ce427-380">No Windows Vista e posterior, UAC (Controle de Conta de Usuário) determina os privilégios de um usuário.</span><span class="sxs-lookup"><span data-stu-id="ce427-380">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="ce427-381">Se for um membro do grupo Administradores Internos, você receberá dois tokens de acesso do tempo de execução: um token de acesso do usuário padrão e um token de acesso do administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-381">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="ce427-382">Por padrão, você está na função de usuário padrão.</span><span class="sxs-lookup"><span data-stu-id="ce427-382">By default, you are in the standard user role.</span></span> <span data-ttu-id="ce427-383">Para executar o código que acessa o log de segurança, você deve primeiro elevar seus privilégios de usuário padrão ao administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-383">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="ce427-384">Você pode fazer isso quando você iniciar um aplicativo clicando duas vezes no ícone do aplicativo e que indica que você deseja executar como administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-384">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="ce427-385">Você só precisa criar uma fonte de evento, se você estiver gravando no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-385">You only need to create an event source if you are writing to the event log.</span></span> <span data-ttu-id="ce427-386">Antes de gravar uma entrada para um log de eventos, você deve registrar a origem do evento no log de eventos como uma origem válida de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-386">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="ce427-387">Quando você grava uma entrada de log, o sistema usa o <xref:System.Diagnostics.EventLog.Source%2A> para localizar o log adequado no qual colocar sua entrada.</span><span class="sxs-lookup"><span data-stu-id="ce427-387">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="ce427-388">Se você estiver lendo o log de eventos, você pode especificar o <xref:System.Diagnostics.EventLog.Source%2A>, ou uma <xref:System.Diagnostics.EventLog.Log%2A> e <xref:System.Diagnostics.EventLog.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-388">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-389">Não é necessário especificar o <xref:System.Diagnostics.EventLog.MachineName%2A> se você estiver se conectando a um log no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-389">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log on the local computer.</span></span> <span data-ttu-id="ce427-390">Se você não especificar o <xref:System.Diagnostics.EventLog.MachineName%2A> ao ler de um log, o computador local (".") é assumido.</span><span class="sxs-lookup"><span data-stu-id="ce427-390">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A> when reading from a log, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="ce427-391">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> e <xref:System.Diagnostics.EventLog.WriteEntry%2A> para gravar eventos em um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-391">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="ce427-392">Você deve especificar uma origem de evento para gravar eventos; Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-392">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="ce427-393">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-393">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-394">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-394">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-395">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-395">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-396">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-396">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-397">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-397">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-398">Você pode criar uma fonte de evento para um log de eventos existente ou um novo log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-398">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="ce427-399">Quando você cria uma nova origem para um novo log de eventos, o sistema registra a origem para que o log, mas o log não é criado até que a primeira entrada seja gravada nele.</span><span class="sxs-lookup"><span data-stu-id="ce427-399">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="ce427-400">O sistema operacional armazena os logs de eventos como arquivos.</span><span class="sxs-lookup"><span data-stu-id="ce427-400">The operating system stores event logs as files.</span></span> <span data-ttu-id="ce427-401">Quando você usa <xref:System.Diagnostics.EventLogInstaller> ou <xref:System.Diagnostics.EventLog.CreateEventSource%2A> para criar um novo log de eventos, o arquivo associado é armazenado no diretório %SystemRoot%\System32\Config no computador especificado.</span><span class="sxs-lookup"><span data-stu-id="ce427-401">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="ce427-402">O nome do arquivo é definido por meio do acréscimo 8 primeiros caracteres da <xref:System.Diagnostics.EventLog.Log%2A> propriedade com a extensão de nome de arquivo ". evt".</span><span class="sxs-lookup"><span data-stu-id="ce427-402">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="ce427-403">A origem deve ser exclusiva no computador local; um novo nome de origem não pode corresponder a um nome de origem existente ou um nome de log de eventos existente.</span><span class="sxs-lookup"><span data-stu-id="ce427-403">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="ce427-404">Cada fonte pode gravar apenas um log de eventos ao mesmo tempo; No entanto, seu aplicativo pode usar várias fontes para gravar em vários logs de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-404">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="ce427-405">Por exemplo, seu aplicativo pode exigir várias fontes, configurados para arquivos de recurso diferente ou logs de eventos diferentes.</span><span class="sxs-lookup"><span data-stu-id="ce427-405">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="ce427-406">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-406">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-407">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-407">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-408">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-408">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-409">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-409">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="ce427-410">Para alterar os detalhes de configuração de uma fonte existente, você deve excluir a fonte e, em seguida, criá-lo com a nova configuração.</span><span class="sxs-lookup"><span data-stu-id="ce427-410">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="ce427-411">Se outros aplicativos ou componentes de usam o código-fonte existente, crie uma nova fonte com a configuração atualizada, em vez de excluir o código-fonte existente.</span><span class="sxs-lookup"><span data-stu-id="ce427-411">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-412">Se uma fonte já tiver sido mapeada para um log e remapeá-la para um novo log, você deve reiniciar o computador para que as alterações entrem em vigor.</span><span class="sxs-lookup"><span data-stu-id="ce427-412">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-413">O exemplo a seguir cria a fonte `MySource` se ele ainda não existir e grava uma entrada no log de eventos `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="ce427-413">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-414">
            <paramref name="source" /> é uma cadeia de caracteres vazia ("") ou <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-414">
              <paramref name="source" /> is an empty string ("") or <see langword="null" />.</span>
          </span>
          <span data-ttu-id="ce427-415">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-415">\- or -</span>
          </span>
          <span data-ttu-id="ce427-416">
            <paramref name="logName" /> não é um nome válido de log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-416">
              <paramref name="logName" /> is not a valid event log name.</span>
          </span>
          <span data-ttu-id="ce427-417">Os nomes de log de eventos devem conter caracteres imprimíveis e não podem incluir os caracteres “\*”, “?” ou “\\”.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-417">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span>
          </span>
          <span data-ttu-id="ce427-418">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-418">\- or -</span>
          </span>
          <span data-ttu-id="ce427-419">
            <paramref name="logName" /> não é válido para a criação de log de usuário.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-419">
              <paramref name="logName" /> is not valid for user log creation.</span>
          </span>
          <span data-ttu-id="ce427-420">Os nomes de log de eventos AppEvent, SysEvent e SecEvent são reservados para uso do sistema.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-420">The event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span>
          </span>
          <span data-ttu-id="ce427-421">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-421">\- or -</span>
          </span>
          <span data-ttu-id="ce427-422">O nome do log corresponde a um nome de origem de evento existente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-422">The log name matches an existing event source name.</span>
          </span>
          <span data-ttu-id="ce427-423">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-423">\- or -</span>
          </span>
          <span data-ttu-id="ce427-424">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-424">The source name results in a registry key path longer than 254 characters.</span>
          </span>
          <span data-ttu-id="ce427-425">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-425">\- or -</span>
          </span>
          <span data-ttu-id="ce427-426">Os 8 primeiros caracteres de <paramref name="logName" /> correspondem aos 8 primeiros caracteres de um log de eventos existente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-426">The first 8 characters of <paramref name="logName" /> match the first 8 characters of an existing event log name.</span>
          </span>
          <span data-ttu-id="ce427-427">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-427">\- or -</span>
          </span>
          <span data-ttu-id="ce427-428">A fonte não pode ser registrada porque já existe no computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-428">The source cannot be registered because it already exists on the local computer.</span>
          </span>
          <span data-ttu-id="ce427-429">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-429">\- or -</span>
          </span>
          <span data-ttu-id="ce427-430">O nome de origem corresponde a um nome de log de eventos existente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-430">The source name matches an existing event log name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-431">Não foi possível abrir a chave do Registro do log de eventos no computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-431">The registry key for the event log could not be opened on the local computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-432">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-432">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-433">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-433">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="CreateEventSource">
      <MemberSignature Language="C#" Value="public static void CreateEventSource (string source, string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void CreateEventSource(string source, string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.CreateEventSource(System.String,System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub CreateEventSource (source As String, logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void CreateEventSource(System::String ^ source, System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member CreateEventSource : string * string * string -&gt; unit" Usage="System.Diagnostics.EventLog.CreateEventSource (source, logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Obsolete("use CreateEventSource(EventSourceCreationData) instead")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Obsolete("This method has been deprecated.  Please use System.Diagnostics.EventLog.CreateEventSource(EventSourceCreationData sourceData) instead.  http://go.microsoft.com/fwlink/?linkid=14202")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="ce427-434">A origem pela qual o aplicativo está registrado no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-434">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="logName">
          <span data-ttu-id="ce427-435">O nome do log no qual as entradas da fonte são gravadas.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-435">The name of the log the source's entries are written to.</span>
          </span>
          <span data-ttu-id="ce427-436">Os valores possíveis incluem Aplicativo, Sistema ou um log de eventos personalizado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-436">Possible values include Application, System, or a custom event log.</span>
          </span>
          <span data-ttu-id="ce427-437">Se você não especificar um valor, <c>logName</c> reverterá para o padrão de Aplicativo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-437">If you do not specify a value, <c>logName</c> defaults to Application.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="ce427-438">O nome do computador que registrará essa origem de evento ou "." para o computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-438">The name of the computer to register this event source with, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-439">Estabelece o nome de origem especificado como uma origem de evento válida para gravar entradas em um log no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-439">Establishes the specified source name as a valid event source for writing entries to a log on the specified computer.</span>
          </span>
          <span data-ttu-id="ce427-440">Também é possível usar esse método para criar um novo log personalizado no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-440">This method can also be used to create a new custom log on the specified computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-441">Use essa sobrecarga para criar um log personalizado ou para criar e registrar um <xref:System.Diagnostics.EventLog.Source%2A> em um log existente no computador especificado.</span><span class="sxs-lookup"><span data-stu-id="ce427-441">Use this overload to create a custom log or to create and register a <xref:System.Diagnostics.EventLog.Source%2A> to an existing log on the specified computer.</span></span>  
  
 <span data-ttu-id="ce427-442">Se `logName` está `null` ou uma cadeia de caracteres vazia ("") quando você chama <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, o log padrão é o log de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-442">If `logName` is `null` or an empty string ("") when you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, the log defaults to the Application log.</span></span> <span data-ttu-id="ce427-443">Se o log não existe no computador especificado, o sistema cria um log personalizado e registra seu aplicativo como um <xref:System.Diagnostics.EventLog.Source%2A> para que o log.</span><span class="sxs-lookup"><span data-stu-id="ce427-443">If the log does not exist on the specified computer, the system creates a custom log and registers your application as a <xref:System.Diagnostics.EventLog.Source%2A> for that log.</span></span>  
  
 <span data-ttu-id="ce427-444">Você só precisa criar uma fonte de evento, se você estiver gravando no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-444">You only need to create an event source if you are writing to the event log.</span></span> <span data-ttu-id="ce427-445">Antes de gravar uma entrada para um log de eventos, você deve registrar a origem do evento no log de eventos como uma origem válida de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-445">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="ce427-446">Quando você grava uma entrada de log, o sistema usa o <xref:System.Diagnostics.EventLog.Source%2A> para localizar o log adequado no qual colocar sua entrada.</span><span class="sxs-lookup"><span data-stu-id="ce427-446">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="ce427-447">Se você estiver lendo o log de eventos, você pode especificar o <xref:System.Diagnostics.EventLog.Source%2A>, ou uma <xref:System.Diagnostics.EventLog.Log%2A> e <xref:System.Diagnostics.EventLog.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-447">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-448">Para criar uma fonte de eventos no Windows Vista e posterior ou o Windows Server 2003, você deve ter privilégios administrativos.</span><span class="sxs-lookup"><span data-stu-id="ce427-448">To create an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="ce427-449">O motivo para esse requisito é que todos os logs de eventos, incluindo segurança, devem ser pesquisados para determinar se a origem do evento é exclusiva.</span><span class="sxs-lookup"><span data-stu-id="ce427-449">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="ce427-450">No Windows Vista e versões posteriores, os usuários não tem permissão para acessar o log de segurança; Portanto, um <xref:System.Security.SecurityException> é gerada.</span><span class="sxs-lookup"><span data-stu-id="ce427-450">In Windows Vista and later, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="ce427-451">No Windows Vista e posterior, UAC (Controle de Conta de Usuário) determina os privilégios de um usuário.</span><span class="sxs-lookup"><span data-stu-id="ce427-451">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="ce427-452">Se for um membro do grupo Administradores Internos, você receberá dois tokens de acesso do tempo de execução: um token de acesso do usuário padrão e um token de acesso do administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-452">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="ce427-453">Por padrão, você está na função de usuário padrão.</span><span class="sxs-lookup"><span data-stu-id="ce427-453">By default, you are in the standard user role.</span></span> <span data-ttu-id="ce427-454">Para executar o código que acessa o log de segurança, você deve primeiro elevar seus privilégios de usuário padrão ao administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-454">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="ce427-455">Você pode fazer isso quando você iniciar um aplicativo clicando duas vezes no ícone do aplicativo e que indica que você deseja executar como administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-455">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
 <span data-ttu-id="ce427-456">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> e <xref:System.Diagnostics.EventLog.WriteEntry%2A> para gravar eventos em um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-456">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="ce427-457">Você deve especificar uma origem de evento para gravar eventos; Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-457">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="ce427-458">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-458">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-459">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-459">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-460">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-460">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-461">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-461">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-462">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-462">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-463">Você pode criar uma fonte de evento para um log de eventos existente ou um novo log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-463">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="ce427-464">Quando você cria uma nova origem para um novo log de eventos, o sistema registra a origem para que o log, mas o log não é criado até que a primeira entrada seja gravada nele.</span><span class="sxs-lookup"><span data-stu-id="ce427-464">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="ce427-465">O sistema operacional armazena os logs de eventos como arquivos.</span><span class="sxs-lookup"><span data-stu-id="ce427-465">The operating system stores event logs as files.</span></span> <span data-ttu-id="ce427-466">Quando você usa <xref:System.Diagnostics.EventLogInstaller> ou <xref:System.Diagnostics.EventLog.CreateEventSource%2A> para criar um novo log de eventos, o arquivo associado é armazenado no diretório %SystemRoot%\System32\Config no computador especificado.</span><span class="sxs-lookup"><span data-stu-id="ce427-466">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="ce427-467">O nome do arquivo é definido por meio do acréscimo 8 primeiros caracteres da <xref:System.Diagnostics.EventLog.Log%2A> propriedade com a extensão de nome de arquivo ". evt".</span><span class="sxs-lookup"><span data-stu-id="ce427-467">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="ce427-468">A origem deve ser exclusiva no computador local; um novo nome de origem não pode corresponder a um nome de origem existente ou um nome de log de eventos existente.</span><span class="sxs-lookup"><span data-stu-id="ce427-468">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="ce427-469">Cada fonte pode gravar apenas um log de eventos ao mesmo tempo; No entanto, seu aplicativo pode usar várias fontes para gravar em vários logs de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-469">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="ce427-470">Por exemplo, seu aplicativo pode exigir várias fontes, configurados para arquivos de recurso diferente ou logs de eventos diferentes.</span><span class="sxs-lookup"><span data-stu-id="ce427-470">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="ce427-471">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-471">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-472">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-472">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-473">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-473">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-474">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-474">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="ce427-475">Para alterar os detalhes de configuração de uma fonte existente, você deve excluir a fonte e, em seguida, criá-lo com a nova configuração.</span><span class="sxs-lookup"><span data-stu-id="ce427-475">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="ce427-476">Se outros aplicativos ou componentes de usam o código-fonte existente, crie uma nova fonte com a configuração atualizada, em vez de excluir o código-fonte existente.</span><span class="sxs-lookup"><span data-stu-id="ce427-476">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-477">Se uma fonte já tiver sido mapeada para um log e remapeá-la para um novo log, você deve reiniciar o computador para que as alterações entrem em vigor.</span><span class="sxs-lookup"><span data-stu-id="ce427-477">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-478">O exemplo a seguir cria a fonte `MySource` no computador `MyServer`e grava uma entrada no log de eventos `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="ce427-478">The following example creates the source `MySource` on the computer `MyServer`, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-479">
            <paramref name="machineName" /> não é um nome do computador válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-479">The <paramref name="machineName" /> is not a valid computer name.</span>
          </span>
          <span data-ttu-id="ce427-480">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-480">\- or -</span>
          </span>
          <span data-ttu-id="ce427-481">
            <paramref name="source" /> é uma cadeia de caracteres vazia ("") ou <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-481">
              <paramref name="source" /> is an empty string ("") or <see langword="null" />.</span>
          </span>
          <span data-ttu-id="ce427-482">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-482">\- or -</span>
          </span>
          <span data-ttu-id="ce427-483">
            <paramref name="logName" /> não é um nome válido de log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-483">
              <paramref name="logName" /> is not a valid event log name.</span>
          </span>
          <span data-ttu-id="ce427-484">Os nomes de log de eventos devem conter caracteres imprimíveis e não podem incluir os caracteres “\*”, “?” ou “\\”.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-484">Event log names must consist of printable characters, and cannot include the characters '\*', '?', or '\\'.</span>
          </span>
          <span data-ttu-id="ce427-485">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-485">\- or -</span>
          </span>
          <span data-ttu-id="ce427-486">
            <paramref name="logName" /> não é válido para a criação de log de usuário.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-486">
              <paramref name="logName" /> is not valid for user log creation.</span>
          </span>
          <span data-ttu-id="ce427-487">Os nomes de log de eventos AppEvent, SysEvent e SecEvent são reservados para uso do sistema.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-487">The event log names AppEvent, SysEvent, and SecEvent are reserved for system use.</span>
          </span>
          <span data-ttu-id="ce427-488">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-488">\- or -</span>
          </span>
          <span data-ttu-id="ce427-489">O nome do log corresponde a um nome de origem de evento existente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-489">The log name matches an existing event source name.</span>
          </span>
          <span data-ttu-id="ce427-490">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-490">\- or -</span>
          </span>
          <span data-ttu-id="ce427-491">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-491">The source name results in a registry key path longer than 254 characters.</span>
          </span>
          <span data-ttu-id="ce427-492">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-492">\- or -</span>
          </span>
          <span data-ttu-id="ce427-493">Os oito primeiros caracteres de <paramref name="logName" /> correspondem aos oito primeiros caracteres de um log de eventos existente no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-493">The first 8 characters of <paramref name="logName" /> match the first 8 characters of an existing event log name on the specified computer.</span>
          </span>
          <span data-ttu-id="ce427-494">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-494">\- or -</span>
          </span>
          <span data-ttu-id="ce427-495">A origem não pode ser registrada porque já existe no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-495">The source cannot be registered because it already exists on the specified computer.</span>
          </span>
          <span data-ttu-id="ce427-496">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-496">\- or -</span>
          </span>
          <span data-ttu-id="ce427-497">O nome da origem corresponde a um nome de origem de evento existente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-497">The source name matches an existing event source name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-498">Não foi possível abrir a chave do Registro do log de eventos no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-498">The registry key for the event log could not be opened on the specified computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-499">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-499">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-500">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-500">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Delete">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-501">Remove um recurso de log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-501">Removes a log resource.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Delete(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (logName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member Delete : string -&gt; unit" Usage="System.Diagnostics.EventLog.Delete logName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="ce427-502">O nome do log a ser excluído.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-502">The name of the log to delete.</span>
          </span>
          <span data-ttu-id="ce427-503">Os valores possíveis incluem: log de aplicativo, segurança, sistema e quaisquer outros logs de eventos personalizados no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-503">Possible values include: Application, Security, System, and any custom event logs on the computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-504">Remove um log de eventos do computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-504">Removes an event log from the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-505">Use esse método quando o log que deseja excluir está no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-505">Use this method when the log you want to delete is on the local computer.</span></span> <span data-ttu-id="ce427-506">Você pode excluir qualquer log no computador, desde que você tenha as permissões de registro apropriadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-506">You can delete any log on the computer, provided you have the appropriate registry permissions.</span></span>  
  
 <span data-ttu-id="ce427-507"><xref:System.Diagnostics.EventLog.Delete%2A> Remove o log especificado pelo `logName` do computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-507"><xref:System.Diagnostics.EventLog.Delete%2A> removes the log specified by `logName` from the local computer.</span></span> <span data-ttu-id="ce427-508">Se você quiser excluir apenas a fonte é registrado em um log, chame <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-508">If you want to delete only the source registered to a log, call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="ce427-509">Se você quiser excluir as entradas de log, chame <xref:System.Diagnostics.EventLog.Clear%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-509">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="ce427-510"><xref:System.Diagnostics.EventLog.Delete%2A> e <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> são `static` métodos, portanto, eles podem ser chamados na classe em si.</span><span class="sxs-lookup"><span data-stu-id="ce427-510"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="ce427-511">Não é necessário criar uma nova instância da <xref:System.Diagnostics.EventLog> para chamar qualquer um dos métodos.</span><span class="sxs-lookup"><span data-stu-id="ce427-511">It is not necessary to create a new instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="ce427-512">O <xref:System.Diagnostics.EventLog.Delete%2A> método primeiro exclui o arquivo que contém o conteúdo do log.</span><span class="sxs-lookup"><span data-stu-id="ce427-512">The <xref:System.Diagnostics.EventLog.Delete%2A> method first deletes the file that holds the contents of the log.</span></span> <span data-ttu-id="ce427-513">Em seguida, ele acessa o registro e remove todas as fontes de evento registradas para que o log.</span><span class="sxs-lookup"><span data-stu-id="ce427-513">It then accesses the registry and removes all the event sources registered for that log.</span></span> <span data-ttu-id="ce427-514">Se você recriar o log em um momento posterior, você deve registrar as fontes de evento novamente, se eles devem ser reutilizado.</span><span class="sxs-lookup"><span data-stu-id="ce427-514">If you recreate the log at a later point, you should register the event sources again, if they are to be reused.</span></span> <span data-ttu-id="ce427-515">Se você não registrar as fontes de evento e outros usuários de gravação a uma fonte de evento sem especificar um nome de log, a origem do evento será criada no log de eventos do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-515">If you do not register the event sources and other users write to an event source without specifying a log name, the event source will be created in the Application event log.</span></span> <span data-ttu-id="ce427-516">Portanto, os aplicativos que anteriormente eram capazes de gravar entradas no log que você excluiu e recriou gravará no log de aplicativo em vez disso, porque agora ele contém a origem do evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-516">Therefore, applications that previously were able to write entries to the log you deleted and recreated will write to the Application log instead, because it now contains the event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-517">Recriar um log de eventos pode ser um processo difícil.</span><span class="sxs-lookup"><span data-stu-id="ce427-517">Recreating an event log can be a difficult process.</span></span> <span data-ttu-id="ce427-518">Evite a exclusão de qualquer um dos logs de eventos criado pelo sistema, como o log de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-518">Avoid deleting any of the system-created event logs, such as the Application log.</span></span>  
  
 <span data-ttu-id="ce427-519">Excluir um log por meio de uma chamada para <xref:System.Diagnostics.EventLog.Delete%2A> exclui automaticamente fontes registradas nesse log.</span><span class="sxs-lookup"><span data-stu-id="ce427-519">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="ce427-520">Isso pode tornar a outros aplicativos que usam esse log inoperante.</span><span class="sxs-lookup"><span data-stu-id="ce427-520">This can make other applications using that log inoperative.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-521">O exemplo a seguir exclui um log do computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-521">The following example deletes a log from the local computer.</span></span> <span data-ttu-id="ce427-522">O exemplo determina o log de sua origem.</span><span class="sxs-lookup"><span data-stu-id="ce427-522">The example determines the log from its source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-523">Mais de uma fonte pode gravar um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-523">More than one source might write to an event log.</span></span> <span data-ttu-id="ce427-524">Antes de excluir um log personalizado, verifique se há não há outras fontes de gravação nesse log.</span><span class="sxs-lookup"><span data-stu-id="ce427-524">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-525">
            <paramref name="logName" /> é uma cadeia de caracteres vazia ("") ou <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-525">
              <paramref name="logName" /> is an empty string ("") or <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-526">Não foi possível abrir a chave do Registro do log de eventos no computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-526">The registry key for the event log could not be opened on the local computer.</span>
          </span>
          <span data-ttu-id="ce427-527">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-527">\- or -</span>
          </span>
          <span data-ttu-id="ce427-528">O log não existe no computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-528">The log does not exist on the local computer.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-529">Não foi possível limpar o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-529">The event log was not cleared successfully.</span>
          </span>
          <span data-ttu-id="ce427-530">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-530">-or-</span>
          </span>
          <span data-ttu-id="ce427-531">Não é possível abrir o log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-531">The log cannot be opened.</span>
          </span>
          <span data-ttu-id="ce427-532">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-532">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-533">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-533">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-534">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-534">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="Delete">
      <MemberSignature Language="C#" Value="public static void Delete (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void Delete(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Delete(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub Delete (logName As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void Delete(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member Delete : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.Delete (logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="ce427-535">O nome do log a ser excluído.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-535">The name of the log to delete.</span>
          </span>
          <span data-ttu-id="ce427-536">Os valores possíveis incluem: Aplicativo, Segurança, Sistema e quaisquer outros logs de eventos personalizados no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-536">Possible values include: Application, Security, System, and any custom event logs on the specified computer.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="ce427-537">O nome do computador a ser excluído do log ou "." para o computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-537">The name of the computer to delete the log from, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-538">Remove um log de eventos do computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-538">Removes an event log from the specified computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-539">Use esse método quando o log que deseja excluir está em um computador remoto.</span><span class="sxs-lookup"><span data-stu-id="ce427-539">Use this method when the log you want to delete is on a remote computer.</span></span> <span data-ttu-id="ce427-540">Você pode excluir qualquer log no computador, desde que você tenha as permissões de registro apropriadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-540">You can delete any log on the computer, provided you have the appropriate registry permissions.</span></span>  
  
 <span data-ttu-id="ce427-541"><xref:System.Diagnostics.EventLog.Delete%2A> Remove o log especificado pelo `logName` do computador especificado pelo `machineName`.</span><span class="sxs-lookup"><span data-stu-id="ce427-541"><xref:System.Diagnostics.EventLog.Delete%2A> removes the log specified by `logName` from the computer specified by `machineName`.</span></span> <span data-ttu-id="ce427-542">Se você quiser excluir apenas a fonte é registrado em um log, chame <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-542">If you want to delete only the source registered to a log, call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="ce427-543">Se você quiser excluir as entradas de log, chame <xref:System.Diagnostics.EventLog.Clear%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-543">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="ce427-544"><xref:System.Diagnostics.EventLog.Delete%2A> e <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> são `static` métodos, portanto, eles podem ser chamados na classe em si.</span><span class="sxs-lookup"><span data-stu-id="ce427-544"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="ce427-545">Não é necessário criar uma instância de <xref:System.Diagnostics.EventLog> para chamar qualquer um dos métodos.</span><span class="sxs-lookup"><span data-stu-id="ce427-545">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="ce427-546">Esse método primeiro exclui o arquivo que contém o conteúdo do log.</span><span class="sxs-lookup"><span data-stu-id="ce427-546">This method first deletes the file that holds the contents of the log.</span></span> <span data-ttu-id="ce427-547">Em seguida, ele acessa o registro e remove todas as fontes de evento registradas para que o log.</span><span class="sxs-lookup"><span data-stu-id="ce427-547">It then accesses the registry and removes all the event sources registered for that log.</span></span> <span data-ttu-id="ce427-548">Se você recriar o log em um momento posterior, você deve registrar as fontes de evento novamente, se eles devem ser reutilizado.</span><span class="sxs-lookup"><span data-stu-id="ce427-548">If you recreate the log at a later point, you should register the event sources again, if they are to be reused.</span></span> <span data-ttu-id="ce427-549">Se você não registrar as fontes de evento e outros usuários de gravação a uma fonte de evento sem especificar um nome de log, a origem do evento será criada no log de eventos do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-549">If you do not register the event sources and other users write to an event source without specifying a log name, the event source will be created in the Application event log.</span></span> <span data-ttu-id="ce427-550">Portanto, os aplicativos que anteriormente eram capazes de gravar entradas no log que você excluiu e recriou gravará no log de aplicativo em vez disso, porque agora ele contém a origem do evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-550">Therefore, applications that previously were able to write entries to the log you deleted and recreated will write to the Application log instead, because it now contains the event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-551">Recriar um log de eventos pode ser um processo difícil.</span><span class="sxs-lookup"><span data-stu-id="ce427-551">Recreating an event log can be a difficult process.</span></span> <span data-ttu-id="ce427-552">Evite a exclusão de qualquer um dos logs de eventos criado pelo sistema, como o log de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-552">Avoid deleting any of the system-created event logs, such as the Application log.</span></span>  
  
 <span data-ttu-id="ce427-553">Excluir um log por meio de uma chamada para <xref:System.Diagnostics.EventLog.Delete%2A> exclui automaticamente fontes registradas nesse log.</span><span class="sxs-lookup"><span data-stu-id="ce427-553">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="ce427-554">Isso pode tornar a outros aplicativos que usam esse log inoperante.</span><span class="sxs-lookup"><span data-stu-id="ce427-554">This can make other applications using that log inoperative.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-555">O exemplo a seguir exclui um log do computador especificado.</span><span class="sxs-lookup"><span data-stu-id="ce427-555">The following example deletes a log from the specified computer.</span></span> <span data-ttu-id="ce427-556">O exemplo determina o log de sua origem.</span><span class="sxs-lookup"><span data-stu-id="ce427-556">The example determines the log from its source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-557">Mais de uma fonte pode gravar um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-557">More than one source might write to an event log.</span></span> <span data-ttu-id="ce427-558">Antes de excluir um log personalizado, verifique se há não há outras fontes de gravação nesse log.</span><span class="sxs-lookup"><span data-stu-id="ce427-558">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.Delete1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Delete1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Delete1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-559">
            <paramref name="logName" /> é uma cadeia de caracteres vazia ("") ou <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-559">
              <paramref name="logName" /> is an empty string ("") or <see langword="null" />.</span>
          </span>
          <span data-ttu-id="ce427-560">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-560">\- or -</span>
          </span>
          <span data-ttu-id="ce427-561">
            <paramref name="machineName" /> não é um nome do computador válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-561">
              <paramref name="machineName" /> is not a valid computer name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-562">Não foi possível abrir a chave do Registro do log de eventos no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-562">The registry key for the event log could not be opened on the specified computer.</span>
          </span>
          <span data-ttu-id="ce427-563">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-563">\- or -</span>
          </span>
          <span data-ttu-id="ce427-564">O log não existe no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-564">The log does not exist on the specified computer.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-565">Não foi possível limpar o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-565">The event log was not cleared successfully.</span>
          </span>
          <span data-ttu-id="ce427-566">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-566">-or-</span>
          </span>
          <span data-ttu-id="ce427-567">Não é possível abrir o log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-567">The log cannot be opened.</span>
          </span>
          <span data-ttu-id="ce427-568">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-568">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-569">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-569">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-570">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-570">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
        <altmember cref="M:System.Diagnostics.EventLog.Close" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="DeleteEventSource">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-571">Remove o registro da origem do evento de um aplicativo do log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-571">Removes an application's event source registration from the event log.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="DeleteEventSource">
      <MemberSignature Language="C#" Value="public static void DeleteEventSource (string source);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteEventSource(string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteEventSource (source As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteEventSource(System::String ^ source);" />
      <MemberSignature Language="F#" Value="static member DeleteEventSource : string -&gt; unit" Usage="System.Diagnostics.EventLog.DeleteEventSource source" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="ce427-572">O nome pelo qual o aplicativo está registrado no sistema de log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-572">The name by which the application is registered in the event log system.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-573">Remove o registro da origem do evento do log de eventos do computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-573">Removes the event source registration from the event log of the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-574">Use esse método para remover o registro de um <xref:System.Diagnostics.EventLog.Source%2A> do computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-574">Use this method to remove the registration of a <xref:System.Diagnostics.EventLog.Source%2A> from the local computer.</span></span> <span data-ttu-id="ce427-575"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> acessa o registro no computador local e remove o registro do seu aplicativo como uma origem válida de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-575"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> accesses the registry on the local computer and removes the registration of your application as a valid source of events.</span></span>  
  
 <span data-ttu-id="ce427-576">Você pode remover seu componente como uma origem válida de eventos se você não precisa gravar entradas nesse log.</span><span class="sxs-lookup"><span data-stu-id="ce427-576">You can remove your component as a valid source of events if you no longer need it to write entries to that log.</span></span> <span data-ttu-id="ce427-577">Por exemplo, você pode fazer isso se você precisar alterar seu componente de um log para outro.</span><span class="sxs-lookup"><span data-stu-id="ce427-577">For example, you might do this if you need to change your component from one log to another.</span></span> <span data-ttu-id="ce427-578">Como uma origem só pode ser registrada para um log cada vez, alterar o log exige que você remover o registro atual.</span><span class="sxs-lookup"><span data-stu-id="ce427-578">Because a source can only be registered to one log at a time, changing the log requires you to remove the current registration.</span></span>  
  
 <span data-ttu-id="ce427-579"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> Remove somente a fonte registrada em um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-579"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> removes only the source registered to a log.</span></span> <span data-ttu-id="ce427-580">Se você quiser remover o log em si, chame <xref:System.Diagnostics.EventLog.Delete%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-580">If you want to remove the log itself, call <xref:System.Diagnostics.EventLog.Delete%2A>.</span></span> <span data-ttu-id="ce427-581">Se você quiser excluir as entradas de log, chame <xref:System.Diagnostics.EventLog.Clear%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-581">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="ce427-582"><xref:System.Diagnostics.EventLog.Delete%2A> e <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> são `static` métodos, portanto, eles podem ser chamados na classe em si.</span><span class="sxs-lookup"><span data-stu-id="ce427-582"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="ce427-583">Não é necessário criar uma instância de <xref:System.Diagnostics.EventLog> para chamar qualquer um dos métodos.</span><span class="sxs-lookup"><span data-stu-id="ce427-583">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="ce427-584">Excluir um log por meio de uma chamada para <xref:System.Diagnostics.EventLog.Delete%2A> exclui automaticamente fontes registradas nesse log.</span><span class="sxs-lookup"><span data-stu-id="ce427-584">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="ce427-585">Isso pode tornar a outros aplicativos que usam esse log inoperante.</span><span class="sxs-lookup"><span data-stu-id="ce427-585">This can make other applications using that log inoperative.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-586">Se uma fonte já tiver sido mapeada para um log e remapeá-la para um novo log, você deve reiniciar o computador para que as alterações entrem em vigor.</span><span class="sxs-lookup"><span data-stu-id="ce427-586">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-587">O exemplo a seguir exclui uma fonte do computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-587">The following example deletes a source from the local computer.</span></span> <span data-ttu-id="ce427-588">O exemplo determina o log de sua origem e, em seguida, exclui o log.</span><span class="sxs-lookup"><span data-stu-id="ce427-588">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-589">Mais de uma fonte pode gravar um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-589">More than one source might write to an event log.</span></span> <span data-ttu-id="ce427-590">Antes de excluir um log personalizado, verifique se há não há outras fontes de gravação nesse log.</span><span class="sxs-lookup"><span data-stu-id="ce427-590">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-591">O parâmetro <paramref name="source" /> não existe no Registro do computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-591">The <paramref name="source" /> parameter does not exist in the registry of the local computer.</span>
          </span>
          <span data-ttu-id="ce427-592">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-592">\- or -</span>
          </span>
          <span data-ttu-id="ce427-593">Você não tem acesso para gravação na chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-593">You do not have write access on the registry key for the event log.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-594">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-594">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-595">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-595">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <Member MemberName="DeleteEventSource">
      <MemberSignature Language="C#" Value="public static void DeleteEventSource (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void DeleteEventSource(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.DeleteEventSource(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub DeleteEventSource (source As String, machineName As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void DeleteEventSource(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member DeleteEventSource : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.DeleteEventSource (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="ce427-596">O nome pelo qual o aplicativo está registrado no sistema de log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-596">The name by which the application is registered in the event log system.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="ce427-597">O nome do computador do qual remover o registro ou "." para o computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-597">The name of the computer to remove the registration from, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-598">Remove o registro da fonte de eventos do aplicativo do computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-598">Removes the application's event source registration from the specified computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-599">Use essa sobrecarga para remover o registro de um <xref:System.Diagnostics.EventLog.Source%2A> de um computador remoto.</span><span class="sxs-lookup"><span data-stu-id="ce427-599">Use this overload to remove the registration of a <xref:System.Diagnostics.EventLog.Source%2A> from a remote computer.</span></span> <span data-ttu-id="ce427-600"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> acessa o registro no computador especificado pelo `machineName` e remove o registro do seu aplicativo como uma origem válida de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-600"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> accesses the registry on the computer specified by `machineName` and removes the registration of your application as a valid source of events.</span></span>  
  
 <span data-ttu-id="ce427-601">Você pode remover seu componente como uma origem válida de eventos se você não precisa gravar entradas nesse log.</span><span class="sxs-lookup"><span data-stu-id="ce427-601">You can remove your component as a valid source of events if you no longer need it to write entries to that log.</span></span> <span data-ttu-id="ce427-602">Por exemplo, você pode fazer isso se você precisar alterar seu componente de um log para outro.</span><span class="sxs-lookup"><span data-stu-id="ce427-602">For example, you might do this if you need to change your component from one log to another.</span></span> <span data-ttu-id="ce427-603">Como uma origem só pode ser registrada para um log cada vez, alterar o log exige que você remover o registro atual.</span><span class="sxs-lookup"><span data-stu-id="ce427-603">Because a source can only be registered to one log at a time, changing the log requires you to remove the current registration.</span></span>  
  
 <span data-ttu-id="ce427-604"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> Remove somente a fonte registrada em um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-604"><xref:System.Diagnostics.EventLog.DeleteEventSource%2A> removes only the source registered to a log.</span></span> <span data-ttu-id="ce427-605">Se você quiser remover o log em si, chame <xref:System.Diagnostics.EventLog.Delete%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-605">If you want to remove the log itself, call <xref:System.Diagnostics.EventLog.Delete%2A>.</span></span> <span data-ttu-id="ce427-606">Se você quiser excluir as entradas de log, chame <xref:System.Diagnostics.EventLog.Clear%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-606">If you only want to delete the log entries, call <xref:System.Diagnostics.EventLog.Clear%2A>.</span></span> <span data-ttu-id="ce427-607"><xref:System.Diagnostics.EventLog.Delete%2A> e <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> são `static` métodos, portanto, eles podem ser chamados na classe em si.</span><span class="sxs-lookup"><span data-stu-id="ce427-607"><xref:System.Diagnostics.EventLog.Delete%2A> and <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> are `static` methods, so they can be called on the class itself.</span></span> <span data-ttu-id="ce427-608">Não é necessário criar uma instância de <xref:System.Diagnostics.EventLog> para chamar qualquer um dos métodos.</span><span class="sxs-lookup"><span data-stu-id="ce427-608">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call either method.</span></span>  
  
 <span data-ttu-id="ce427-609">Excluir um log por meio de uma chamada para <xref:System.Diagnostics.EventLog.Delete%2A> exclui automaticamente fontes registradas nesse log.</span><span class="sxs-lookup"><span data-stu-id="ce427-609">Deleting a log through a call to <xref:System.Diagnostics.EventLog.Delete%2A> automatically deletes the sources registered to that log.</span></span> <span data-ttu-id="ce427-610">Isso pode tornar a outros aplicativos que usam esse log inoperante.</span><span class="sxs-lookup"><span data-stu-id="ce427-610">This can make other applications using that log inoperative.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-611">Se uma fonte já tiver sido mapeada para um log e remapeá-la para um novo log, você deve reiniciar o computador para que as alterações entrem em vigor.</span><span class="sxs-lookup"><span data-stu-id="ce427-611">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-612">O exemplo a seguir exclui uma fonte do computador especificado.</span><span class="sxs-lookup"><span data-stu-id="ce427-612">The following example deletes a source from the specified computer.</span></span> <span data-ttu-id="ce427-613">O exemplo determina o log de sua origem e, em seguida, exclui o log.</span><span class="sxs-lookup"><span data-stu-id="ce427-613">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-614">Mais de uma fonte pode gravar um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-614">More than one source might write to an event log.</span></span> <span data-ttu-id="ce427-615">Antes de excluir um log personalizado, verifique se há não há outras fontes de gravação nesse log.</span><span class="sxs-lookup"><span data-stu-id="ce427-615">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.Delete1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Delete1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Delete1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Delete1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-616">O parâmetro <paramref name="machineName" /> é inválido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-616">The <paramref name="machineName" /> parameter is invalid.</span>
          </span>
          <span data-ttu-id="ce427-617">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-617">\- or -</span>
          </span>
          <span data-ttu-id="ce427-618">O parâmetro <paramref name="source" /> não existe no Registro do computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-618">The <paramref name="source" /> parameter does not exist in the registry of the specified computer.</span>
          </span>
          <span data-ttu-id="ce427-619">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-619">\- or -</span>
          </span>
          <span data-ttu-id="ce427-620">Você não tem acesso para gravação na chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-620">You do not have write access on the registry key for the event log.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-621">
            <paramref name="source" /> não pode ser excluída porque no Registro, a chave do Registro pai para <paramref name="source" /> não contém uma subchave com o mesmo nome.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-621">
              <paramref name="source" /> cannot be deleted because in the registry, the parent registry key for <paramref name="source" /> does not contain a subkey with the same name.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-622">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-622">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-623">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-623">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Clear" />
      </Docs>
    </Member>
    <Member MemberName="Dispose">
      <MemberSignature Language="C#" Value="protected override void Dispose (bool disposing);" />
      <MemberSignature Language="ILAsm" Value=".method familyhidebysig virtual instance void Dispose(bool disposing) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Dispose(System.Boolean)" />
      <MemberSignature Language="VB.NET" Value="Protected Overrides Sub Dispose (disposing As Boolean)" />
      <MemberSignature Language="C++ CLI" Value="protected:&#xA; override void Dispose(bool disposing);" />
      <MemberSignature Language="F#" Value="override this.Dispose : bool -&gt; unit" Usage="eventLog.Dispose disposing" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="disposing" Type="System.Boolean" />
      </Parameters>
      <Docs>
        <param name="disposing">
          <span data-ttu-id="ce427-624">
            <see langword="true" /> para liberar recursos gerenciados e não gerenciados; <see langword="false" /> para liberar apenas recursos não gerenciados.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-624">
              <see langword="true" /> to release both managed and unmanaged resources; <see langword="false" /> to release only unmanaged resources.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-625">Libera os recursos não gerenciados usados pelo <see cref="T:System.Diagnostics.EventLog" /> e opcionalmente libera os recursos gerenciados.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-625">Releases the unmanaged resources used by the <see cref="T:System.Diagnostics.EventLog" />, and optionally releases the managed resources.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-626">Este método é chamado pelo método público `Dispose()` e pelo método <xref:System.Object.Finalize%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-626">This method is called by the public `Dispose()` method and the <xref:System.Object.Finalize%2A> method.</span></span> <span data-ttu-id="ce427-627">`Dispose()` invoca o método `Dispose(Boolean)` protegido com o parâmetro `disposing` definido como `true`.</span><span class="sxs-lookup"><span data-stu-id="ce427-627">`Dispose()` invokes the protected `Dispose(Boolean)` method with the `disposing` parameter set to `true`.</span></span> <span data-ttu-id="ce427-628"><xref:System.Object.Finalize%2A> invoca `Dispose` com `disposing` definido como `false`.</span><span class="sxs-lookup"><span data-stu-id="ce427-628"><xref:System.Object.Finalize%2A> invokes `Dispose` with `disposing` set to `false`.</span></span>  
  
 <span data-ttu-id="ce427-629">Quando o `disposing` parâmetro for true, esse método libera todos os recursos mantidos por qualquer objeto gerenciado que este <xref:System.Diagnostics.EventLog> referências.</span><span class="sxs-lookup"><span data-stu-id="ce427-629">When the `disposing` parameter is true, this method releases all resources held by any managed objects that this <xref:System.Diagnostics.EventLog> references.</span></span> <span data-ttu-id="ce427-630">Este método invoca o método `Dispose()` de cada objeto referenciado.</span><span class="sxs-lookup"><span data-stu-id="ce427-630">This method invokes the `Dispose()` method of each referenced object.</span></span>  
  
 ]]></format>
        </remarks>
        <block subset="none" type="overrides">
          <span data-ttu-id="ce427-631">
            <para>
              <see langword="Dispose" /> pode ser chamado várias vezes por outros objetos. Ao substituir <see langword="Dispose(Boolean)" /> tenha cuidado para não referenciar objetos que tenham sido descartados anteriormente em uma chamada anterior para <see langword="Dispose" />. Para obter mais informações sobre como implementar <see langword="Dispose(Boolean)" />, consulte [implementando um método Dispose](~/docs/standard/garbage-collection/implementing-dispose.md).  Para obter mais informações sobre <see langword="Dispose" /> e <see cref="M:System.Object.Finalize" />, consulte [limpeza de recursos não gerenciados](~/docs/standard/garbage-collection/unmanaged.md).</para>
          </span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-631">
              <para>
                <see langword="Dispose" /> can be called multiple times by other objects. When overriding <see langword="Dispose(Boolean)" /> be careful not to reference objects that have been previously disposed of in an earlier call to <see langword="Dispose" />. For more information about how to implement <see langword="Dispose(Boolean)" />, see [Implementing a Dispose Method](~/docs/standard/garbage-collection/implementing-dispose.md).  For more information about <see langword="Dispose" /> and <see cref="M:System.Object.Finalize" />, see [Cleaning Up Unmanaged Resources](~/docs/standard/garbage-collection/unmanaged.md).</para>
            </span>
          </span>
        </block>
      </Docs>
    </Member>
    <Member MemberName="EnableRaisingEvents">
      <MemberSignature Language="C#" Value="public bool EnableRaisingEvents { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool EnableRaisingEvents" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.EnableRaisingEvents" />
      <MemberSignature Language="VB.NET" Value="Public Property EnableRaisingEvents As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool EnableRaisingEvents { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.EnableRaisingEvents : bool with get, set" Usage="System.Diagnostics.EventLog.EnableRaisingEvents" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("If enabled raises event when a log is written.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogMonitoring")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-632">Obtém ou define um valor que indica se o <see cref="T:System.Diagnostics.EventLog" /> recebe notificações do evento <see cref="E:System.Diagnostics.EventLog.EntryWritten" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-632">Gets or sets a value indicating whether the <see cref="T:System.Diagnostics.EventLog" /> receives <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> event notifications.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="ce427-633">
            <see langword="true" /> se o <see cref="T:System.Diagnostics.EventLog" /> receber uma notificação quando uma entrada for escrita no log; caso contrário, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-633">
              <see langword="true" /> if the <see cref="T:System.Diagnostics.EventLog" /> receives notification when an entry is written to the log; otherwise, <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-634">O <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> propriedade determina se o <xref:System.Diagnostics.EventLog> gera eventos quando as entradas são gravadas no log.</span><span class="sxs-lookup"><span data-stu-id="ce427-634">The <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> property determines whether the <xref:System.Diagnostics.EventLog> raises events when entries are written to the log.</span></span> <span data-ttu-id="ce427-635">Quando a propriedade é `true`, componentes que recebem a <xref:System.Diagnostics.EventLog.EntryWritten> evento receberão a notificação sempre que uma entrada é gravada no log especificado no <xref:System.Diagnostics.EventLog.Log%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="ce427-635">When the property is `true`, components that receive the <xref:System.Diagnostics.EventLog.EntryWritten> event will receive notification any time an entry is written to the log that is specified in the <xref:System.Diagnostics.EventLog.Log%2A> property.</span></span> <span data-ttu-id="ce427-636">Se <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> é `false`, nenhum evento é gerado.</span><span class="sxs-lookup"><span data-stu-id="ce427-636">If <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> is `false`, no events are raised.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-637">Você pode receber notificações de eventos somente quando as entradas são gravadas no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-637">You can receive event notifications only when entries are written on the local computer.</span></span> <span data-ttu-id="ce427-638">Você não pode receber notificações para entradas gravadas em computadores remotos.</span><span class="sxs-lookup"><span data-stu-id="ce427-638">You cannot receive notifications for entries written on remote computers.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-639">A exemplo a seguir identifica um <xref:System.Diagnostics.EventLog.EntryWritten> eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-639">The following example handles an <xref:System.Diagnostics.EventLog.EntryWritten> event.</span></span>  
  
 [!code-cpp[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EnableRaisingEvents Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EnableRaisingEvents Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-640">O log do evento está em um computador remoto.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-640">The event log is on a remote computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-641">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-641">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-642">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-642">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="E:System.Diagnostics.EventLog.EntryWritten" />
      </Docs>
    </Member>
    <Member MemberName="EndInit">
      <MemberSignature Language="C#" Value="public void EndInit ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig newslot virtual instance void EndInit() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.EndInit" />
      <MemberSignature Language="VB.NET" Value="Public Sub EndInit ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; virtual void EndInit();" />
      <MemberSignature Language="F#" Value="abstract member EndInit : unit -&gt; unit&#xA;override this.EndInit : unit -&gt; unit" Usage="eventLog.EndInit " />
      <MemberType>Method</MemberType>
      <Implements>
        <InterfaceMember>M:System.ComponentModel.ISupportInitialize.EndInit</InterfaceMember>
      </Implements>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="ce427-643">Encerra a inicialização de um <see cref="T:System.Diagnostics.EventLog" /> usado em um formulário ou por outro componente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-643">Ends the initialization of an <see cref="T:System.Diagnostics.EventLog" /> used on a form or by another component.</span>
          </span>
          <span data-ttu-id="ce427-644">A inicialização ocorre em tempo de execução.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-644">The initialization occurs at runtime.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-645">O [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] ambiente usa esse método para terminar a inicialização de um componente usado em um formulário ou por outro componente de design.</span><span class="sxs-lookup"><span data-stu-id="ce427-645">The [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] design environment uses this method to end the initialization of a component used on a form or by another component.</span></span> <span data-ttu-id="ce427-646">O <xref:System.Diagnostics.EventLog.BeginInit%2A> método começa a inicialização.</span><span class="sxs-lookup"><span data-stu-id="ce427-646">The <xref:System.Diagnostics.EventLog.BeginInit%2A> method starts the initialization.</span></span> <span data-ttu-id="ce427-647">Usando o <xref:System.Diagnostics.EventLog.BeginInit%2A> e <xref:System.Diagnostics.EventLog.EndInit%2A> métodos impede que o controle seja usado antes de ser totalmente inicializado.</span><span class="sxs-lookup"><span data-stu-id="ce427-647">Using the <xref:System.Diagnostics.EventLog.BeginInit%2A> and <xref:System.Diagnostics.EventLog.EndInit%2A> methods prevents the control from being used before it is fully initialized.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-648">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-648">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-649">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-649">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.BeginInit" />
      </Docs>
    </Member>
    <Member MemberName="Entries">
      <MemberSignature Language="C#" Value="public System.Diagnostics.EventLogEntryCollection Entries { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.Diagnostics.EventLogEntryCollection Entries" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Entries" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property Entries As EventLogEntryCollection" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Diagnostics::EventLogEntryCollection ^ Entries { System::Diagnostics::EventLogEntryCollection ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.Entries : System.Diagnostics.EventLogEntryCollection" Usage="System.Diagnostics.EventLog.Entries" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("The entries in the log.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogEntries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLogEntryCollection</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-650">Obtém o conteúdo do log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-650">Gets the contents of the event log.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="ce427-651">Um <see cref="T:System.Diagnostics.EventLogEntryCollection" /> que contém as entradas no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-651">An <see cref="T:System.Diagnostics.EventLogEntryCollection" /> holding the entries in the event log.</span>
          </span>
          <span data-ttu-id="ce427-652">Cada entrada é associada a uma instância da classe <see cref="T:System.Diagnostics.EventLogEntry" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-652">Each entry is associated with an instance of the <see cref="T:System.Diagnostics.EventLogEntry" /> class.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-653">Use o <xref:System.Diagnostics.EventLog.Entries%2A> membro durante a leitura do log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-653">Use the <xref:System.Diagnostics.EventLog.Entries%2A> member when reading from the event log.</span></span>  
  
 <span data-ttu-id="ce427-654">Como a propriedade é somente leitura, você não pode modificar uma entrada ou gravar no log usando <xref:System.Diagnostics.EventLog.Entries%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-654">Because the property is read-only, you cannot modify an entry or write to the log using <xref:System.Diagnostics.EventLog.Entries%2A>.</span></span> <span data-ttu-id="ce427-655">Em vez disso, especifique um <xref:System.Diagnostics.EventLog.Source%2A> e chamar <xref:System.Diagnostics.EventLog.WriteEntry%2A> para gravar uma nova entrada de log.</span><span class="sxs-lookup"><span data-stu-id="ce427-655">Instead, specify a <xref:System.Diagnostics.EventLog.Source%2A> and call <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write a new log entry.</span></span> <span data-ttu-id="ce427-656">Você pode usar <xref:System.Diagnostics.EventLog.Entries%2A> para contar o número de entradas no log de eventos e exibir cada <xref:System.Diagnostics.EventLogEntry> na coleção.</span><span class="sxs-lookup"><span data-stu-id="ce427-656">You can use <xref:System.Diagnostics.EventLog.Entries%2A> to count the number of entries in the event log, and view each <xref:System.Diagnostics.EventLogEntry> in the collection.</span></span> <span data-ttu-id="ce427-657">Use o indexada <xref:System.Diagnostics.EventLogEntryCollection.Item%2A> membro para recuperar informações sobre uma entrada específica, como <xref:System.Diagnostics.EventLogEntry.Message%2A>, <xref:System.Diagnostics.EventLogEntry.Category%2A>, <xref:System.Diagnostics.EventLogEntry.TimeWritten%2A>, ou <xref:System.Diagnostics.EventLogEntry.EntryType%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-657">Use the indexed <xref:System.Diagnostics.EventLogEntryCollection.Item%2A> member to retrieve information about a specific entry, such as <xref:System.Diagnostics.EventLogEntry.Message%2A>, <xref:System.Diagnostics.EventLogEntry.Category%2A>, <xref:System.Diagnostics.EventLogEntry.TimeWritten%2A>, or <xref:System.Diagnostics.EventLogEntry.EntryType%2A>.</span></span>  
  
 <span data-ttu-id="ce427-658">Não é necessário especificar um <xref:System.Diagnostics.EventLog.Source%2A> quando somente leitura de um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-658">It is not necessary to specify a <xref:System.Diagnostics.EventLog.Source%2A> when only reading from a log.</span></span> <span data-ttu-id="ce427-659">Você pode especificar apenas o <xref:System.Diagnostics.EventLog.Log%2A> nome e <xref:System.Diagnostics.EventLog.MachineName%2A> propriedades de (nome de computador do servidor) para o <xref:System.Diagnostics.EventLog> instância.</span><span class="sxs-lookup"><span data-stu-id="ce427-659">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name) properties for the <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="ce427-660">Em ambos os casos, o <xref:System.Diagnostics.EventLog.Entries%2A> membro é preenchido automaticamente com a lista de eventos do log de entradas.</span><span class="sxs-lookup"><span data-stu-id="ce427-660">In either case, the <xref:System.Diagnostics.EventLog.Entries%2A> member is automatically populated with the event log's list of entries.</span></span> <span data-ttu-id="ce427-661">Você pode selecionar o índice apropriado para um item nessa lista para ler as entradas individuais.</span><span class="sxs-lookup"><span data-stu-id="ce427-661">You can select the appropriate index for an item in this list to read individual entries.</span></span>  
  
 <span data-ttu-id="ce427-662">Uma importante distinção entre leitura e gravação de entradas de log é que não é necessário chamar explicitamente um método read.</span><span class="sxs-lookup"><span data-stu-id="ce427-662">An important distinction between reading and writing log entries is that it is not necessary to explicitly call a read method.</span></span> <span data-ttu-id="ce427-663">Após o <xref:System.Diagnostics.EventLog.Log%2A> e <xref:System.Diagnostics.EventLog.MachineName%2A> forem especificados, o <xref:System.Diagnostics.EventLog.Entries%2A> propriedade é preenchida automaticamente.</span><span class="sxs-lookup"><span data-stu-id="ce427-663">After the <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A> are specified, the <xref:System.Diagnostics.EventLog.Entries%2A> property is automatically populated.</span></span> <span data-ttu-id="ce427-664">Se você alterar o valor da <xref:System.Diagnostics.EventLog.Log%2A> ou <xref:System.Diagnostics.EventLog.MachineName%2A> propriedade, o <xref:System.Diagnostics.EventLog.Entries%2A> propriedade é preenchida novamente na próxima vez que você lê-lo.</span><span class="sxs-lookup"><span data-stu-id="ce427-664">If you change the value of the <xref:System.Diagnostics.EventLog.Log%2A> or <xref:System.Diagnostics.EventLog.MachineName%2A> property, the <xref:System.Diagnostics.EventLog.Entries%2A> property is repopulated the next time you read it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-665">Não é necessário especificar o <xref:System.Diagnostics.EventLog.MachineName%2A> se você estiver se conectando a um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-665">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="ce427-666">Se você não especificar o <xref:System.Diagnostics.EventLog.MachineName%2A>, o computador local, ".", será assumido.</span><span class="sxs-lookup"><span data-stu-id="ce427-666">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer, ".", is assumed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-667">O exemplo a seguir lê as entradas no log de eventos, "MyNewLog" no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-667">The following example reads entries in the event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.Entries Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Entries Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Entries Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Entries Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-668">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-668">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-669">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-669">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryCollection" />
        <altmember cref="T:System.Diagnostics.EventLogEntry" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="Overload:System.Diagnostics.EventLog.WriteEntry" />
      </Docs>
    </Member>
    <Member MemberName="EntryWritten">
      <MemberSignature Language="C#" Value="public event System.Diagnostics.EntryWrittenEventHandler EntryWritten;" />
      <MemberSignature Language="ILAsm" Value=".event class System.Diagnostics.EntryWrittenEventHandler EntryWritten" />
      <MemberSignature Language="DocId" Value="E:System.Diagnostics.EventLog.EntryWritten" />
      <MemberSignature Language="VB.NET" Value="Public Custom Event EntryWritten As EntryWrittenEventHandler " />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; event System::Diagnostics::EntryWrittenEventHandler ^ EntryWritten;" />
      <MemberSignature Language="F#" Value="member this.EntryWritten : System.Diagnostics.EntryWrittenEventHandler " Usage="member this.EntryWritten : System.Diagnostics.EntryWrittenEventHandler " />
      <MemberType>Event</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("Raised for each EventLog entry written.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogEntryWritten")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EntryWrittenEventHandler</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-670">Ocorre quando uma entrada é gravada em um log de eventos no computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-670">Occurs when an entry is written to an event log on the local computer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-671">Para obter notificações de eventos, você deve definir <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> para `true`.</span><span class="sxs-lookup"><span data-stu-id="ce427-671">To get event notifications, you must set <xref:System.Diagnostics.EventLog.EnableRaisingEvents%2A> to `true`.</span></span> <span data-ttu-id="ce427-672">Você só pode receber notificações de eventos quando as entradas são gravadas no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-672">You can only receive event notifications when entries are written on the local computer.</span></span> <span data-ttu-id="ce427-673">Você não pode receber notificações para entradas gravadas em computadores remotos.</span><span class="sxs-lookup"><span data-stu-id="ce427-673">You cannot receive notifications for entries written on remote computers.</span></span>  
  
 <span data-ttu-id="ce427-674">Quando você cria um <xref:System.Diagnostics.EventLog.EntryWritten> delegado, você identificar o método que manipulará o evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-674">When you create an <xref:System.Diagnostics.EventLog.EntryWritten> delegate, you identify the method that will handle the event.</span></span> <span data-ttu-id="ce427-675">Para associar o evento com o manipulador de eventos, adicione uma instância do delegado ao evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-675">To associate the event with your event handler, add an instance of the delegate to the event.</span></span> <span data-ttu-id="ce427-676">O manipulador de eventos é chamado sempre que o evento ocorre, até que você remova o delegado.</span><span class="sxs-lookup"><span data-stu-id="ce427-676">The event handler is called whenever the event occurs, until you remove the delegate.</span></span> <span data-ttu-id="ce427-677">Para obter mais informações sobre como manipular eventos com delegados, consulte [tratando e gerando eventos](~/docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="ce427-677">For more information about handling events with delegates, see [Handling and Raising Events](~/docs/standard/events/index.md).</span></span>  
  
 <span data-ttu-id="ce427-678">O sistema responde a <xref:System.Diagnostics.EventLog.WriteEntry%2A> somente se o último evento de gravação ocorreu pelo menos seis segundos anteriormente.</span><span class="sxs-lookup"><span data-stu-id="ce427-678">The system responds to <xref:System.Diagnostics.EventLog.WriteEntry%2A> only if the last write event occurred at least six seconds previously.</span></span> <span data-ttu-id="ce427-679">Isso significa que você só receberá um <xref:System.Diagnostics.EventLog.EntryWritten> notificação de eventos dentro de um intervalo de seis segundos, mesmo se mais de um evento de alteração de log ocorre.</span><span class="sxs-lookup"><span data-stu-id="ce427-679">This implies you will only receive one <xref:System.Diagnostics.EventLog.EntryWritten> event notification within a six-second interval, even if more than one event log change occurs.</span></span> <span data-ttu-id="ce427-680">Se você inserir um intervalo de suspensão suficientemente longa (cerca de 10 segundos) entre as chamadas para <xref:System.Diagnostics.EventLog.WriteEntry%2A>, é menos prováveis de perder um evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-680">If you insert a sufficiently long sleep interval (around 10 seconds) between calls to <xref:System.Diagnostics.EventLog.WriteEntry%2A>, you are less likely to miss an event.</span></span> <span data-ttu-id="ce427-681">No entanto, se os eventos de gravação ocorrem com mais frequência, você pode não receber a notificação de eventos até o próximo intervalo.</span><span class="sxs-lookup"><span data-stu-id="ce427-681">However, if write events occur more frequently, you might not recieve the event notification until the next interval.</span></span> <span data-ttu-id="ce427-682">Normalmente, as notificações de eventos ausentes não são perdidas, mas atrasadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-682">Typically, missed event notifications are not lost, but delayed.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-683">O exemplo a seguir lida com uma entrada de evento de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-683">The following example handles an entry written event.</span></span>  
  
 [!code-cpp[Classic EventLog.EntryWritten Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.EntryWritten Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.EntryWritten Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.EntryWritten Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-684">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-684">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-685">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-685">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.EnableRaisingEvents" />
      </Docs>
    </Member>
    <MemberGroup MemberName="Exists">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-686">Determina se o log especificado existe.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-686">Determines whether the specified log exists.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string logName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string logName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Exists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (logName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ logName);" />
      <MemberSignature Language="F#" Value="static member Exists : string -&gt; bool" Usage="System.Diagnostics.EventLog.Exists logName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="ce427-687">O nome do log a ser pesquisado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-687">The name of the log to search for.</span>
          </span>
          <span data-ttu-id="ce427-688">Os valores possíveis incluem: aplicativos, segurança, sistema, outros logs específicos do aplicativo (como aqueles associados ao Active Directory) ou qualquer log personalizado no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-688">Possible values include: Application, Security, System, other application-specific logs (such as those associated with Active Directory), or any custom log on the computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-689">Determina se o log existe no computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-689">Determines whether the log exists on the local computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="ce427-690">
            <see langword="true" /> se o log existir no computador local; caso contrário, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-690">
              <see langword="true" /> if the log exists on the local computer; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-691">Use esse método para determinar se um log existe no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-691">Use this method to determine if a log exists on the local computer.</span></span> <span data-ttu-id="ce427-692">Se você deseja determinar se existe uma fonte no computador local, use <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-692">If you want to determine whether a source exists on the local computer, use <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
 <span data-ttu-id="ce427-693">Como esse método acessa o registro, você deve ter as permissões de registro apropriados no computador local; Caso contrário, a consulta retorna `false`.</span><span class="sxs-lookup"><span data-stu-id="ce427-693">Because this method accesses the registry, you must have the appropriate registry permissions on the local computer; otherwise, the query returns `false`.</span></span>  
  
 <span data-ttu-id="ce427-694">Porque você não pode dar um novo log o nome de um log existente no mesmo computador, use esse método antes de criar um novo log para determinar se especificado `logName` já existe no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-694">Because you cannot give a new log the name of an existing log on the same computer, use this method before creating a new log to determine if the specified `logName` already exists on the local computer.</span></span> <span data-ttu-id="ce427-695">O `logName` parâmetro não diferencia maiusculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="ce427-695">The `logName` parameter is not case sensitive.</span></span>  
  
 <span data-ttu-id="ce427-696"><xref:System.Diagnostics.EventLog.Exists%2A> é um `static` método, ele pode ser chamado na classe em si.</span><span class="sxs-lookup"><span data-stu-id="ce427-696"><xref:System.Diagnostics.EventLog.Exists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="ce427-697">Não é necessário criar uma instância do <xref:System.Diagnostics.EventLog> chamar <xref:System.Diagnostics.EventLog.Exists%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-697">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_Exists_1#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_Exists_1/CPP/eventlog_exists_1.cpp#1)]
 [!code-csharp[EventLog_Exists_1#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_Exists_1/CS/eventlog_exists_1.cs#1)]
 [!code-vb[EventLog_Exists_1#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_Exists_1/VB/eventlog_exists_1.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-698">O logName é <see langword="null" /> ou o valor está vazio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-698">The logName is <see langword="null" /> or the value is empty.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-699">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-699">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-700">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-700">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="Exists">
      <MemberSignature Language="C#" Value="public static bool Exists (string logName, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool Exists(string logName, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.Exists(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function Exists (logName As String, machineName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool Exists(System::String ^ logName, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member Exists : string * string -&gt; bool" Usage="System.Diagnostics.EventLog.Exists (logName, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="logName" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="logName">
          <span data-ttu-id="ce427-701">O log pelo qual pesquisar.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-701">The log for which to search.</span>
          </span>
          <span data-ttu-id="ce427-702">Os valores possíveis incluem: aplicativos, segurança, sistema, outros logs específicos do aplicativo (como aqueles associados ao Active Directory) ou qualquer log personalizado no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-702">Possible values include: Application, Security, System, other application-specific logs (such as those associated with Active Directory), or any custom log on the computer.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="ce427-703">O nome do computador no qual pesquisar pelo log ou "." para o computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-703">The name of the computer on which to search for the log, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-704">Determina se o log existe no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-704">Determines whether the log exists on the specified computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="ce427-705">
            <see langword="true" /> se o log existir no computador especificado; caso contrário, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-705">
              <see langword="true" /> if the log exists on the specified computer; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-706">Use esse método para determinar se existe um log em um computador remoto.</span><span class="sxs-lookup"><span data-stu-id="ce427-706">Use this method to determine if a log exists on a remote computer.</span></span> <span data-ttu-id="ce427-707">Se você deseja determinar se existe uma fonte em um computador remoto, use <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-707">If you want to determine whether a source exists on a remote computer, use <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
 <span data-ttu-id="ce427-708">Como esse método acessa o registro, você deve ter as permissões de registro apropriados no computador especificado. Caso contrário, a consulta retorna `false`.</span><span class="sxs-lookup"><span data-stu-id="ce427-708">Because this method accesses the registry, you must have the appropriate registry permissions on the specified computer; otherwise, the query returns `false`.</span></span>  
  
 <span data-ttu-id="ce427-709">Porque você não pode dar um novo log o nome de um log existente no mesmo computador, use esse método antes de criar um novo log para determinar se um com a especificada `logName` já existe no servidor especificado pelo `machineName` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="ce427-709">Because you cannot give a new log the name of an existing log on the same computer, use this method before creating a new log to determine if one with the specified `logName` already exists on the server specified by the `machineName` parameter.</span></span> <span data-ttu-id="ce427-710">O `logName` e `machineName` parâmetros não diferenciam maiusculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="ce427-710">The `logName` and `machineName` parameters are not case sensitive.</span></span>  
  
 <span data-ttu-id="ce427-711"><xref:System.Diagnostics.EventLog.Exists%2A> é um `static` método, ele pode ser chamado na classe em si.</span><span class="sxs-lookup"><span data-stu-id="ce427-711"><xref:System.Diagnostics.EventLog.Exists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="ce427-712">Não é necessário criar uma nova instância da <xref:System.Diagnostics.EventLog> chamar <xref:System.Diagnostics.EventLog.Exists%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-712">It is not necessary to create a new instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-713">O parâmetro <paramref name="machineName" /> está em um formato inválido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-713">The <paramref name="machineName" /> parameter is an invalid format.</span>
          </span>
          <span data-ttu-id="ce427-714">Verifique se que você usou a sintaxe apropriada para o computador no qual você está pesquisando.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-714">Make sure you have used proper syntax for the computer on which you are searching.</span>
          </span>
          <span data-ttu-id="ce427-715">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-715">-or-</span>
          </span>
          <span data-ttu-id="ce427-716">O <paramref name="logName" /> é <see langword="null" /> ou o valor está vazio.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-716">The <paramref name="logName" /> is <see langword="null" /> or the value is empty.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-717">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-717">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-718">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-718">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <MemberGroup MemberName="GetEventLogs">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-719">Cria uma matriz dos logs de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-719">Creates an array of the event logs.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="GetEventLogs">
      <MemberSignature Language="C#" Value="public static System.Diagnostics.EventLog[] GetEventLogs ();" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Diagnostics.EventLog[] GetEventLogs() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.GetEventLogs" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetEventLogs () As EventLog()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Diagnostics::EventLog ^&gt; ^ GetEventLogs();" />
      <MemberSignature Language="F#" Value="static member GetEventLogs : unit -&gt; System.Diagnostics.EventLog[]" Usage="System.Diagnostics.EventLog.GetEventLogs " />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLog[]</ReturnType>
      </ReturnValue>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="ce427-720">Pesquisa todos os logs de eventos em um computador local e cria uma matriz de objetos <see cref="T:System.Diagnostics.EventLog" /> que contêm a lista.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-720">Searches for all event logs on the local computer and creates an array of <see cref="T:System.Diagnostics.EventLog" /> objects that contain the list.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="ce427-721">Uma matriz do tipo <see cref="T:System.Diagnostics.EventLog" /> que representa os logs no computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-721">An array of type <see cref="T:System.Diagnostics.EventLog" /> that represents the logs on the local computer.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-722">A matriz de <xref:System.Diagnostics.EventLog> objetos é um instantâneo de todos os logs de eventos no computador local quando a chamada para <xref:System.Diagnostics.EventLog.GetEventLogs%2A> é feita.</span><span class="sxs-lookup"><span data-stu-id="ce427-722">The array of <xref:System.Diagnostics.EventLog> objects is a snapshot of all event logs on the local computer when the call to <xref:System.Diagnostics.EventLog.GetEventLogs%2A> is made.</span></span> <span data-ttu-id="ce427-723">Isso não é uma coleção dinâmica, portanto, ele não reflete a exclusão ou a criação de logs em tempo real.</span><span class="sxs-lookup"><span data-stu-id="ce427-723">This is not a dynamic collection, so it does not reflect the deletion or creation of logs in real time.</span></span> <span data-ttu-id="ce427-724">Você deve verificar se um log na matriz existe antes de ler ou gravar nele.</span><span class="sxs-lookup"><span data-stu-id="ce427-724">You should verify that a log in the array exists before you read or write to it.</span></span> <span data-ttu-id="ce427-725">A matriz geralmente inclui pelo menos três logs: aplicativo, sistema e segurança.</span><span class="sxs-lookup"><span data-stu-id="ce427-725">The array usually includes at least three logs: Application, System, and Security.</span></span> <span data-ttu-id="ce427-726">Se você criou logs personalizados no computador local, eles serão exibidos na matriz também.</span><span class="sxs-lookup"><span data-stu-id="ce427-726">If you created custom logs on the local computer, they will appear in the array as well.</span></span>  
  
 <span data-ttu-id="ce427-727">Para recuperar a lista de logs de eventos, você deve ter as permissões de registro apropriadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-727">To retrieve the list of event logs, you must have the appropriate registry permissions.</span></span> <span data-ttu-id="ce427-728">Essas permissões são idênticas àquelas necessárias para chamar <xref:System.Diagnostics.EventLog.Exists%2A> e <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-728">These permissions are identical to those required to call <xref:System.Diagnostics.EventLog.Exists%2A> and <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-729">O exemplo a seguir enumera os logs de evento definidos no computador local e exibe os detalhes de configuração para cada log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-729">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.SystemException">
          <span data-ttu-id="ce427-730">Você não tem acesso de leitura ao Registro.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-730">You do not have read access to the registry.</span>
          </span>
          <span data-ttu-id="ce427-731">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-731">-or-</span>
          </span>
          <span data-ttu-id="ce427-732">Não há nenhum serviço de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-732">There is no event log service on the computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-733">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-733">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-734">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-734">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
      </Docs>
    </Member>
    <Member MemberName="GetEventLogs">
      <MemberSignature Language="C#" Value="public static System.Diagnostics.EventLog[] GetEventLogs (string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig class System.Diagnostics.EventLog[] GetEventLogs(string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.GetEventLogs(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function GetEventLogs (machineName As String) As EventLog()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static cli::array &lt;System::Diagnostics::EventLog ^&gt; ^ GetEventLogs(System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member GetEventLogs : string -&gt; System.Diagnostics.EventLog[]" Usage="System.Diagnostics.EventLog.GetEventLogs machineName" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.EventLog[]</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="machineName">
          <span data-ttu-id="ce427-735">O computador no qual os logs de eventos serão pesquisados.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-735">The computer on which to search for event logs.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-736">Pesquisa todos os logs de eventos em determinado computador e cria uma matriz de objetos <see cref="T:System.Diagnostics.EventLog" /> que contêm a lista.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-736">Searches for all event logs on the given computer and creates an array of <see cref="T:System.Diagnostics.EventLog" /> objects that contain the list.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="ce427-737">Uma matriz do tipo <see cref="T:System.Diagnostics.EventLog" /> que representa os logs em determinado computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-737">An array of type <see cref="T:System.Diagnostics.EventLog" /> that represents the logs on the given computer.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-738">A matriz de <xref:System.Diagnostics.EventLog> objetos é um instantâneo de todos os logs de eventos no computador especificado o `machineName` parâmetro quando a chamada para <xref:System.Diagnostics.EventLog.GetEventLogs%2A> é feita.</span><span class="sxs-lookup"><span data-stu-id="ce427-738">The array of <xref:System.Diagnostics.EventLog> objects is a snapshot of all event logs on the computer specified by the `machineName` parameter when the call to <xref:System.Diagnostics.EventLog.GetEventLogs%2A> is made.</span></span> <span data-ttu-id="ce427-739">Isso não é uma coleção dinâmica, portanto, ele não reflete a exclusão ou a criação de logs em tempo real.</span><span class="sxs-lookup"><span data-stu-id="ce427-739">This is not a dynamic collection, so it does not reflect the deletion or creation of logs in real time.</span></span> <span data-ttu-id="ce427-740">Você deve verificar se um log na matriz existe antes de ler ou gravar nele.</span><span class="sxs-lookup"><span data-stu-id="ce427-740">You should verify that a log in the array exists before you read or write to it.</span></span> <span data-ttu-id="ce427-741">A matriz geralmente inclui pelo menos três logs: aplicativo, sistema e segurança.</span><span class="sxs-lookup"><span data-stu-id="ce427-741">The array usually includes at least three logs: Application, System, and Security.</span></span> <span data-ttu-id="ce427-742">Se você criou logs personalizados no computador especificado, eles serão exibidos na matriz também.</span><span class="sxs-lookup"><span data-stu-id="ce427-742">If you created custom logs on the specified computer, they will appear in the array as well.</span></span>  
  
 <span data-ttu-id="ce427-743"><xref:System.Diagnostics.EventLog.GetEventLogs%2A> é um `static` método, ele pode ser chamado no <xref:System.Diagnostics.EventLog> própria classe.</span><span class="sxs-lookup"><span data-stu-id="ce427-743"><xref:System.Diagnostics.EventLog.GetEventLogs%2A> is a `static` method, so it can be called on the <xref:System.Diagnostics.EventLog> class itself.</span></span> <span data-ttu-id="ce427-744">Não é necessário criar uma instância de um <xref:System.Diagnostics.EventLog> objeto para fazer uma chamada ao método.</span><span class="sxs-lookup"><span data-stu-id="ce427-744">It is not necessary to create an instance of an <xref:System.Diagnostics.EventLog> object to make a call to the method.</span></span>  
  
 <span data-ttu-id="ce427-745">Para recuperar a lista de logs de eventos, você deve ter as permissões de registro apropriadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-745">To retrieve the list of event logs, you must have the appropriate registry permissions.</span></span> <span data-ttu-id="ce427-746">Essas permissões são idênticas àquelas necessárias para chamar <xref:System.Diagnostics.EventLog.Exists%2A> e <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-746">These permissions are identical to those required to call <xref:System.Diagnostics.EventLog.Exists%2A> and <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-747">O exemplo a seguir obtém uma lista dos logs no computador "meuservidor".</span><span class="sxs-lookup"><span data-stu-id="ce427-747">The following example gets a list of logs on the computer "myServer".</span></span> <span data-ttu-id="ce427-748">Em seguida, ele gera o nome de cada log.</span><span class="sxs-lookup"><span data-stu-id="ce427-748">It then outputs the name of each log.</span></span>  
  
 [!code-cpp[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.GetEventLogs1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.GetEventLogs1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-749">O parâmetro <paramref name="machineName" /> é um nome do computador inválido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-749">The <paramref name="machineName" /> parameter is an invalid computer name.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-750">Você não tem acesso de leitura ao Registro.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-750">You do not have read access to the registry.</span>
          </span>
          <span data-ttu-id="ce427-751">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-751">-or-</span>
          </span>
          <span data-ttu-id="ce427-752">Não há nenhum serviço de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-752">There is no event log service on the computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-753">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-753">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-754">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-754">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="Log">
      <MemberSignature Language="C#" Value="public string Log { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Log" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Log" />
      <MemberSignature Language="VB.NET" Value="Public Property Log As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Log { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Log : string with get, set" Usage="System.Diagnostics.EventLog.Log" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.LogConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("Name of the log that is read and written.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.LogConverter, System.Design, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogLog")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.LogConverter, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-755">Obtém ou define o nome do log a ser lido ou gravado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-755">Gets or sets the name of the log to read from or write to.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="ce427-756">O nome do log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-756">The name of the log.</span>
          </span>
          <span data-ttu-id="ce427-757">Pode ser o log de Aplicativo, Sistema, Segurança ou um nome de log personalizado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-757">This can be Application, System, Security, or a custom log name.</span>
          </span>
          <span data-ttu-id="ce427-758">O padrão é uma cadeia de caracteres vazia ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-758">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-759">Três arquivos de log existem por padrão no servidor: aplicativo, sistema e segurança.</span><span class="sxs-lookup"><span data-stu-id="ce427-759">Three log files exist by default on the server: Application, System, and Security.</span></span> <span data-ttu-id="ce427-760">Aplicativos e serviços usam o arquivo de log do aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-760">Applications and services use the Application log file.</span></span> <span data-ttu-id="ce427-761">Drivers de dispositivo usam o arquivo de log do sistema.</span><span class="sxs-lookup"><span data-stu-id="ce427-761">Device drivers use the System log file.</span></span> <span data-ttu-id="ce427-762">O sistema gera eventos de auditoria de êxito e falha no log de segurança quando a auditoria está ativada.</span><span class="sxs-lookup"><span data-stu-id="ce427-762">The system generates success and failure audit events in the Security log when auditing is turned on.</span></span> <span data-ttu-id="ce427-763">Se você tiver outros aplicativos instalados, como o Active Directory em servidores Windows, pode haver outros arquivos de log padrão.</span><span class="sxs-lookup"><span data-stu-id="ce427-763">If you have other applications installed, like Active Directory on Windows servers, there might be other default log files.</span></span> <span data-ttu-id="ce427-764">Além disso, você pode criar arquivos de log personalizado em um computador local ou remoto.</span><span class="sxs-lookup"><span data-stu-id="ce427-764">In addition, you can create custom log files on a local or remote computer.</span></span> <span data-ttu-id="ce427-765">Logs personalizados ajudam a organizar suas entradas em uma forma mais detalhada do que é permitido quando seus componentes gravar eventos no log de aplicativo padrão.</span><span class="sxs-lookup"><span data-stu-id="ce427-765">Custom logs help organize your entries in a more detailed way than is allowed when your components write events to the default Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-766">Nomes de log são limitados a oito caracteres.</span><span class="sxs-lookup"><span data-stu-id="ce427-766">Log names are limited to eight characters.</span></span> <span data-ttu-id="ce427-767">De acordo com o sistema, MyLogSample1 e MyLogSample2 são do mesmo log.</span><span class="sxs-lookup"><span data-stu-id="ce427-767">According to the system, MyLogSample1 and MyLogSample2 are the same log.</span></span>  
  
 <span data-ttu-id="ce427-768">Se você gravar um log de eventos, não é suficiente especificar o <xref:System.Diagnostics.EventLog.Log%2A> propriedade.</span><span class="sxs-lookup"><span data-stu-id="ce427-768">If you write to an event log, it is not enough to specify the <xref:System.Diagnostics.EventLog.Log%2A> property.</span></span> <span data-ttu-id="ce427-769">Você deve associar um <xref:System.Diagnostics.EventLog.Source%2A> propriedade com o recurso de log de eventos para conectá-lo em um log específico.</span><span class="sxs-lookup"><span data-stu-id="ce427-769">You must associate a <xref:System.Diagnostics.EventLog.Source%2A> property with your event log resource to connect it to a particular log.</span></span> <span data-ttu-id="ce427-770">Não é necessário especificar um <xref:System.Diagnostics.EventLog.Source%2A> quando lendo apenas de um log, mas uma origem do evento deve ser associado com o recurso de log de eventos no registro do servidor.</span><span class="sxs-lookup"><span data-stu-id="ce427-770">It is not necessary to specify a <xref:System.Diagnostics.EventLog.Source%2A> when only reading from a log, but an event source must be associated with the event log resource in the server's registry.</span></span> <span data-ttu-id="ce427-771">Você pode especificar apenas o <xref:System.Diagnostics.EventLog.Log%2A> nome e <xref:System.Diagnostics.EventLog.MachineName%2A> (nome do computador de servidor) para lê-lo.</span><span class="sxs-lookup"><span data-stu-id="ce427-771">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name) to read from it.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-772">Não é necessário especificar o <xref:System.Diagnostics.EventLog.MachineName%2A> se você estiver se conectando a um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-772">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="ce427-773">Se você não especificar o <xref:System.Diagnostics.EventLog.MachineName%2A>, o computador local (".") é assumido.</span><span class="sxs-lookup"><span data-stu-id="ce427-773">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="ce427-774">Se o <xref:System.Diagnostics.EventLog.Source%2A> propriedade não foi especificada, uma chamada para <xref:System.Diagnostics.EventLog.Log%2A> retorna uma cadeia de caracteres vazia se <xref:System.Diagnostics.EventLog.Log%2A> não tiver sido definido explicitamente (definindo o <xref:System.Diagnostics.EventLog.Log%2A> propriedade, ou por meio do construtor).</span><span class="sxs-lookup"><span data-stu-id="ce427-774">If the <xref:System.Diagnostics.EventLog.Source%2A> property has not been specified, a call to <xref:System.Diagnostics.EventLog.Log%2A> returns an empty string if <xref:System.Diagnostics.EventLog.Log%2A> has not been explicitly set (by setting the <xref:System.Diagnostics.EventLog.Log%2A> property, or through the constructor).</span></span> <span data-ttu-id="ce427-775">Se o <xref:System.Diagnostics.EventLog.Source%2A> tiver sido especificada, <xref:System.Diagnostics.EventLog.Log%2A> retorna o nome do log em que essa fonte foi registrada.</span><span class="sxs-lookup"><span data-stu-id="ce427-775">If the <xref:System.Diagnostics.EventLog.Source%2A> has been specified, <xref:System.Diagnostics.EventLog.Log%2A> returns the name of the log to which that source was registered.</span></span>  
  
 <span data-ttu-id="ce427-776">Uma origem só pode ser registrada para um log cada vez.</span><span class="sxs-lookup"><span data-stu-id="ce427-776">A source can only be registered to one log at a time.</span></span> <span data-ttu-id="ce427-777">Se o <xref:System.Diagnostics.EventLog.Source%2A> propriedade foi definida para uma instância do <xref:System.Diagnostics.EventLog>, não é possível alterar o <xref:System.Diagnostics.EventLog.Log%2A> propriedade para fazer isso <xref:System.Diagnostics.EventLog> sem alterar o valor de <xref:System.Diagnostics.EventLog.Source%2A> ou chamar <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> primeiro.</span><span class="sxs-lookup"><span data-stu-id="ce427-777">If the <xref:System.Diagnostics.EventLog.Source%2A> property was set for an instance of <xref:System.Diagnostics.EventLog>, you cannot change the <xref:System.Diagnostics.EventLog.Log%2A> property for that <xref:System.Diagnostics.EventLog> without changing the value of <xref:System.Diagnostics.EventLog.Source%2A> or calling <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> first.</span></span> <span data-ttu-id="ce427-778">Se você alterar o <xref:System.Diagnostics.EventLog.Log%2A> propriedade após o <xref:System.Diagnostics.EventLog.Source%2A> propriedade tiver sido definida, escrever uma entrada de log gera uma exceção.</span><span class="sxs-lookup"><span data-stu-id="ce427-778">If you change the <xref:System.Diagnostics.EventLog.Log%2A> property after the <xref:System.Diagnostics.EventLog.Source%2A> property has been set, writing a log entry throws an exception.</span></span>  
  
 <span data-ttu-id="ce427-779">O sistema operacional armazena os logs de eventos como arquivos.</span><span class="sxs-lookup"><span data-stu-id="ce427-779">The operating system stores event logs as files.</span></span> <span data-ttu-id="ce427-780">Quando você usa <xref:System.Diagnostics.EventLogInstaller> ou <xref:System.Diagnostics.EventLog.CreateEventSource%2A> para criar um novo log de eventos, o arquivo associado é armazenado no diretório %SystemRoot%\System32\Config no computador especificado.</span><span class="sxs-lookup"><span data-stu-id="ce427-780">When you use <xref:System.Diagnostics.EventLogInstaller> or <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to create a new event log, the associated file is stored in the %SystemRoot%\System32\Config directory on the specified computer.</span></span> <span data-ttu-id="ce427-781">O nome do arquivo é definido por meio do acréscimo 8 primeiros caracteres da <xref:System.Diagnostics.EventLog.Log%2A> propriedade com a extensão de nome de arquivo ". evt".</span><span class="sxs-lookup"><span data-stu-id="ce427-781">The file name is set by appending the first 8 characters of the <xref:System.Diagnostics.EventLog.Log%2A> property with the ".evt" file name extension.</span></span>  
  
 <span data-ttu-id="ce427-782">Você não pode criar um novo log usando o <xref:System.Diagnostics.EventLog.Log%2A> propriedade sozinha (sem especificar uma origem para o log).</span><span class="sxs-lookup"><span data-stu-id="ce427-782">You cannot create a new log using the <xref:System.Diagnostics.EventLog.Log%2A> property alone (without specifying a source for the log).</span></span> <span data-ttu-id="ce427-783">Você pode chamar <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, passando um novo nome de log como um parâmetro e, em seguida, chamar <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-783">You can call <xref:System.Diagnostics.EventLog.CreateEventSource%2A>, passing in a new log name as a parameter, and then call <xref:System.Diagnostics.EventLog.DeleteEventSource%2A>.</span></span> <span data-ttu-id="ce427-784">No entanto, a intenção é geralmente criar (e gravar entradas) novos logs específicos do aplicativo, ou para ler de logs existentes.</span><span class="sxs-lookup"><span data-stu-id="ce427-784">However, the intent is usually either to create (and write entries to) new application-specific logs, or to read from existing logs.</span></span>  
  
 <span data-ttu-id="ce427-785">Se o <xref:System.Diagnostics.EventLog.Log%2A> alterações de valor, o log de eventos é fechado e todos os identificadores de eventos são liberados.</span><span class="sxs-lookup"><span data-stu-id="ce427-785">If the <xref:System.Diagnostics.EventLog.Log%2A> value changes, the event log is closed and all event handles are released.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="ce427-786">Se você definir a <xref:System.Diagnostics.EventLog.Log%2A> o sistema de propriedade para o nome de um log que não existe, anexa o <xref:System.Diagnostics.EventLog> no log de aplicativo, mas não avisa que ele está usando um log diferente daquele especificado por você.</span><span class="sxs-lookup"><span data-stu-id="ce427-786">If you set the <xref:System.Diagnostics.EventLog.Log%2A> property to the name of a log that does not exist, the system attaches the <xref:System.Diagnostics.EventLog> to the Application log, but does not warn you that it is using a log other than the one you specified.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-787">O exemplo a seguir lê as entradas no log de eventos, "NewEventLog" no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-787">The following example reads entries in the event log, "NewEventLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.Log Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Log Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Log Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Log Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Log Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Log Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-788">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-788">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-789">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-789">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="T:System.Diagnostics.EventLogEntryCollection" />
      </Docs>
    </Member>
    <Member MemberName="LogDisplayName">
      <MemberSignature Language="C#" Value="public string LogDisplayName { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string LogDisplayName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.LogDisplayName" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property LogDisplayName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ LogDisplayName { System::String ^ get(); };" />
      <MemberSignature Language="F#" Value="member this.LogDisplayName : string" Usage="System.Diagnostics.EventLog.LogDisplayName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-790">Obtém o nome amigável do log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-790">Gets the event log's friendly name.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="ce427-791">Um nome que representa o log de eventos no Visualizador de Eventos do sistema.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-791">A name that represents the event log in the system's event viewer.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
  
> [!NOTE]
>  <span data-ttu-id="ce427-792">No Windows Vista e versões posteriores, os usuários não tem permissão para acessar o log de segurança.</span><span class="sxs-lookup"><span data-stu-id="ce427-792">In Windows Vista and later, users do not have permission to access the security log.</span></span> <span data-ttu-id="ce427-793">Se você estiver executando o Windows Vista ou posterior como um usuário, você obterá um <xref:System.Security.SecurityException> quando você tenta acessar o nome de exibição para um evento no log de segurança.</span><span class="sxs-lookup"><span data-stu-id="ce427-793">If you are running Windows Vista or later as a user, you will get a <xref:System.Security.SecurityException> when you attempt to access the display name for an event in the security log.</span></span>  
>   
>  <span data-ttu-id="ce427-794">No Windows Vista e posterior, UAC (Controle de Conta de Usuário) determina os privilégios de um usuário.</span><span class="sxs-lookup"><span data-stu-id="ce427-794">In Windows Vista and later, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="ce427-795">Se for um membro do grupo Administradores Internos, você receberá dois tokens de acesso do tempo de execução: um token de acesso do usuário padrão e um token de acesso do administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-795">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="ce427-796">Por padrão, você está na função de usuário padrão.</span><span class="sxs-lookup"><span data-stu-id="ce427-796">By default, you are in the standard user role.</span></span> <span data-ttu-id="ce427-797">Para executar o código que acessa o log de segurança, você deve primeiro elevar seus privilégios de usuário padrão ao administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-797">To execute the code that accesses the security log, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="ce427-798">Você pode fazer isso quando você iniciar um aplicativo clicando duas vezes no ícone do aplicativo e que indica que você deseja executar como administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-798">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-799">O exemplo a seguir enumera os logs de evento definidos no computador local e exibe o <xref:System.Diagnostics.EventLog.LogDisplayName%2A> para cada log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-799">The following example enumerates the event logs defined on the local computer and displays the <xref:System.Diagnostics.EventLog.LogDisplayName%2A> for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-800">O <see cref="P:System.Diagnostics.EventLog.Log" /> especificado não existe no Registro deste computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-800">The specified <see cref="P:System.Diagnostics.EventLog.Log" /> does not exist in the registry for this computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-801">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-801">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-802">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-802">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.RegistryPermission">
          <span data-ttu-id="ce427-803">para a capacidade de ler a chave do Registro especificada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-803">for the ability to read the specified registry key.</span>
          </span>
          <span data-ttu-id="ce427-804">Enumeração associada: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-804">Associated enumeration: <see cref="F:System.Security.Permissions.RegistryPermissionAccess.Read" /></span>
          </span>
        </permission>
        <permission cref="T:System.Security.Permissions.SecurityPermission">
          <span data-ttu-id="ce427-805">para a capacidade de acessar a chave do Registro especificada caso ela seja uma chave remota.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-805">for the ability to access the specified registry key if it is a remote key.</span>
          </span>
          <span data-ttu-id="ce427-806">Enumeração associada: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-806">Associated enumeration: <see cref="F:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode" /></span>
          </span>
        </permission>
        <altmember cref="M:System.Diagnostics.EventLog.RegisterDisplayName(System.String,System.Int64)" />
      </Docs>
    </Member>
    <Member MemberName="LogNameFromSourceName">
      <MemberSignature Language="C#" Value="public static string LogNameFromSourceName (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig string LogNameFromSourceName(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.LogNameFromSourceName(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function LogNameFromSourceName (source As String, machineName As String) As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static System::String ^ LogNameFromSourceName(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member LogNameFromSourceName : string * string -&gt; string" Usage="System.Diagnostics.EventLog.LogNameFromSourceName (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="ce427-807">O nome da origem do evento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-807">The name of the event source.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="ce427-808">O nome do computador no qual procurar ou "." para o computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-808">The name of the computer on which to look, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-809">Obtém o nome do log no qual a origem especificada é registrada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-809">Gets the name of the log to which the specified source is registered.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="ce427-810">O nome do log associado à origem especificada no Registro.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-810">The name of the log associated with the specified source in the registry.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-811">A origem do evento indica que o que registra o evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-811">The event source indicates what logs the event.</span></span> <span data-ttu-id="ce427-812">Geralmente é o nome do aplicativo ou o nome de um subcomponente do aplicativo, se o aplicativo for grande.</span><span class="sxs-lookup"><span data-stu-id="ce427-812">It is often the name of the application, or the name of a subcomponent of the application, if the application is large.</span></span> <span data-ttu-id="ce427-813">Aplicativos e serviços devem gravar no log do aplicativo ou um log personalizado.</span><span class="sxs-lookup"><span data-stu-id="ce427-813">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="ce427-814">Drivers de dispositivo devem gravar no log do sistema.</span><span class="sxs-lookup"><span data-stu-id="ce427-814">Device drivers should write to the System log.</span></span>  
  
 <span data-ttu-id="ce427-815">Quando você cria uma nova origem, que pode gravar apenas em um log cada vez, o sistema registra seu aplicativo com o log de eventos como uma fonte válida de entradas.</span><span class="sxs-lookup"><span data-stu-id="ce427-815">When you create a new source, which can only write to one log at a time, the system registers your application with the event log as a valid source of entries.</span></span> <span data-ttu-id="ce427-816">O <xref:System.Diagnostics.EventLog.Source%2A> propriedade pode ser qualquer cadeia de caracteres, mas o nome não pode ser usado por outras fontes no computador.</span><span class="sxs-lookup"><span data-stu-id="ce427-816">The <xref:System.Diagnostics.EventLog.Source%2A> property can be any string, but the name cannot be used by other sources on the computer.</span></span> <span data-ttu-id="ce427-817">Uma tentativa de criar um duplicado <xref:System.Diagnostics.EventLog.Source%2A> valor lança uma exceção.</span><span class="sxs-lookup"><span data-stu-id="ce427-817">An attempt to create a duplicated <xref:System.Diagnostics.EventLog.Source%2A> value throws an exception.</span></span> <span data-ttu-id="ce427-818">No entanto, um único log de eventos pode ter várias fontes diferentes, gravando a ele.</span><span class="sxs-lookup"><span data-stu-id="ce427-818">However, a single event log can have many different sources writing to it.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-819">O exemplo a seguir exclui uma fonte do computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-819">The following example deletes a source from the local computer.</span></span> <span data-ttu-id="ce427-820">O exemplo determina o log de sua origem e, em seguida, exclui o log.</span><span class="sxs-lookup"><span data-stu-id="ce427-820">The example determines the log from its source, and then deletes the log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-821">Mais de uma fonte pode gravar um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-821">More than one source might write to an event log.</span></span> <span data-ttu-id="ce427-822">Antes de excluir um log personalizado, verifique se há não há outras fontes de gravação nesse log.</span><span class="sxs-lookup"><span data-stu-id="ce427-822">Before deleting a custom log, make sure there are no other sources writing to that log.</span></span>  
  
 [!code-cpp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.DeleteEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.DeleteEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-823">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-823">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-824">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-824">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      </Docs>
    </Member>
    <Member MemberName="MachineName">
      <MemberSignature Language="C#" Value="public string MachineName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string MachineName" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MachineName" />
      <MemberSignature Language="VB.NET" Value="Public Property MachineName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ MachineName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.MachineName : string with get, set" Usage="System.Diagnostics.EventLog.MachineName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.DefaultValue(".")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("Name of the machine that this log get written to.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogMachineName")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-825">Obtém ou define o nome do computador em que os eventos devem ser lidos ou gravados.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-825">Gets or sets the name of the computer on which to read or write events.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="ce427-826">O nome do servidor no qual reside o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-826">The name of the server on which the event log resides.</span>
          </span>
          <span data-ttu-id="ce427-827">O padrão é o computador local (".").</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-827">The default is the local computer (".").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-828">Se você gravar um log de eventos, você deve associar um <xref:System.Diagnostics.EventLog.Source%2A> com seu objeto de log de eventos para conectá-lo em um log específico.</span><span class="sxs-lookup"><span data-stu-id="ce427-828">If you write to an event log, you must associate a <xref:System.Diagnostics.EventLog.Source%2A> with your event log object to connect it to a particular log.</span></span> <span data-ttu-id="ce427-829">Não é necessário especificar o <xref:System.Diagnostics.EventLog.Source%2A> propriedade quando somente leitura de um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-829">It is not necessary to specify the <xref:System.Diagnostics.EventLog.Source%2A> property when only reading from a log.</span></span> <span data-ttu-id="ce427-830">Você pode especificar apenas o <xref:System.Diagnostics.EventLog.Log%2A> nome e <xref:System.Diagnostics.EventLog.MachineName%2A> (nome de computador do servidor).</span><span class="sxs-lookup"><span data-stu-id="ce427-830">You can specify only the <xref:System.Diagnostics.EventLog.Log%2A> name and <xref:System.Diagnostics.EventLog.MachineName%2A> (server computer name).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-831">Você não precisa especificar o <xref:System.Diagnostics.EventLog.MachineName%2A> se você estiver se conectando a um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-831">You need not specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log.</span></span> <span data-ttu-id="ce427-832">Se você não especificar o <xref:System.Diagnostics.EventLog.MachineName%2A>, o computador local (".") é assumido.</span><span class="sxs-lookup"><span data-stu-id="ce427-832">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="ce427-833">Uma origem só pode ser registrada para um log cada vez.</span><span class="sxs-lookup"><span data-stu-id="ce427-833">A source can only be registered to one log at a time.</span></span> <span data-ttu-id="ce427-834">Se o <xref:System.Diagnostics.EventLog.Source%2A> propriedade foi definida para uma instância do <xref:System.Diagnostics.EventLog>, não é possível alterar o <xref:System.Diagnostics.EventLog.MachineName%2A> propriedade para fazer isso <xref:System.Diagnostics.EventLog> sem alterar o valor de <xref:System.Diagnostics.EventLog.Source%2A> ou chamar <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> primeiro.</span><span class="sxs-lookup"><span data-stu-id="ce427-834">If the <xref:System.Diagnostics.EventLog.Source%2A> property was set for an instance of <xref:System.Diagnostics.EventLog>, you cannot change the <xref:System.Diagnostics.EventLog.MachineName%2A> property for that <xref:System.Diagnostics.EventLog> without changing the value of <xref:System.Diagnostics.EventLog.Source%2A> or calling <xref:System.Diagnostics.EventLog.DeleteEventSource%2A> first.</span></span> <span data-ttu-id="ce427-835">Se você alterar o <xref:System.Diagnostics.EventLog.MachineName%2A> propriedade, o <xref:System.Diagnostics.EventLog> fecha todos os identificadores e anexa novamente para o log e o código-fonte no novo computador.</span><span class="sxs-lookup"><span data-stu-id="ce427-835">If you change the <xref:System.Diagnostics.EventLog.MachineName%2A> property, the <xref:System.Diagnostics.EventLog> closes all handles and reattaches to the log and source on the new computer.</span></span>  
  
 <span data-ttu-id="ce427-836">O <xref:System.Diagnostics.EventLog.MachineName%2A> valor não pode ser uma cadeia de caracteres vazia.</span><span class="sxs-lookup"><span data-stu-id="ce427-836">The <xref:System.Diagnostics.EventLog.MachineName%2A> value cannot be an empty string.</span></span> <span data-ttu-id="ce427-837">Se ele não for definido explicitamente, ele assume como padrão no computador local (".").</span><span class="sxs-lookup"><span data-stu-id="ce427-837">If it is not explicitly set, it defaults to the local computer (".").</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-838">O exemplo a seguir lê as entradas no log de eventos, "NewEventLog", em um computador especificado.</span><span class="sxs-lookup"><span data-stu-id="ce427-838">The following example reads entries in the event log, "NewEventLog", on a specified computer.</span></span>  
  
 [!code-cpp[Classic EventLog.MachineName Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.MachineName Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.MachineName Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.MachineName Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-839">O nome do computador é inválido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-839">The computer name is invalid.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-840">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-840">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-841">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-841">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Delete(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.GetEventLogs" />
      </Docs>
    </Member>
    <Member MemberName="MaximumKilobytes">
      <MemberSignature Language="C#" Value="public long MaximumKilobytes { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int64 MaximumKilobytes" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MaximumKilobytes" />
      <MemberSignature Language="VB.NET" Value="Public Property MaximumKilobytes As Long" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property long MaximumKilobytes { long get(); void set(long value); };" />
      <MemberSignature Language="F#" Value="member this.MaximumKilobytes : int64 with get, set" Usage="System.Diagnostics.EventLog.MaximumKilobytes" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.DesignerSerializationVisibility(System.ComponentModel.DesignerSerializationVisibility.Hidden)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int64</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-842">Obtém ou define o tamanho máximo do log de eventos em quilobytes.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-842">Gets or sets the maximum event log size in kilobytes.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="ce427-843">O tamanho máximo do log de eventos em quilobytes.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-843">The maximum event log size in kilobytes.</span>
          </span>
          <span data-ttu-id="ce427-844">O padrão é 512, indicando um tamanho do arquivo máximo de 512 KB.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-844">The default is 512, indicating a maximum file size of 512 kilobytes.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-845">O <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> propriedade representa o limite de tamanho do arquivo de log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-845">The <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> property represents the size limit of the event log file.</span></span> <span data-ttu-id="ce427-846">Quando o log de eventos atinge o limite de tamanho configurado <xref:System.Diagnostics.EventLog.OverflowAction%2A> valor determina se as novas entradas são descartadas, ou se novas entradas de substituir as entradas mais antigas.</span><span class="sxs-lookup"><span data-stu-id="ce427-846">When the event log reaches the size limit, the configured <xref:System.Diagnostics.EventLog.OverflowAction%2A> value determines whether new entries are discarded, or whether new entries overwrite older entries.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-847">Esta propriedade representa uma definição de configuração para o log de evento representado por esta instância.</span><span class="sxs-lookup"><span data-stu-id="ce427-847">This property represents a configuration setting for the event log represented by this instance.</span></span> <span data-ttu-id="ce427-848">Quando o log de eventos atinge seu tamanho máximo, essa propriedade especifica como o sistema operacional trata as novas entradas gravadas por todas as fontes de evento registradas para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-848">When the event log reaches its maximum size, this property specifies how the operating system handles new entries written by all event sources registered for the event log.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-849">O exemplo a seguir enumera os logs de evento definidos no computador local e exibe os detalhes de configuração para cada log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-849">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="ce427-850">O valor especificado é menor do que 64 ou maior que 4194240 ou é não um múltiplo par de 64.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-850">The specified value is less than 64, or greater than 4194240, or not an even multiple of 64.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-851">O valor <see cref="P:System.Diagnostics.EventLog.Log" /> não é um nome de log válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-851">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span>
          </span>
          <span data-ttu-id="ce427-852">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-852">\- or -</span>
          </span>
          <span data-ttu-id="ce427-853">Não foi possível abrir a chave do Registro do log de eventos no computador de destino.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-853">The registry key for the event log could not be opened on the target computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-854">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-854">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-855">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-855">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
      </Docs>
    </Member>
    <Member MemberName="MinimumRetentionDays">
      <MemberSignature Language="C#" Value="public int MinimumRetentionDays { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance int32 MinimumRetentionDays" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property MinimumRetentionDays As Integer" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property int MinimumRetentionDays { int get(); };" />
      <MemberSignature Language="F#" Value="member this.MinimumRetentionDays : int" Usage="System.Diagnostics.EventLog.MinimumRetentionDays" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Int32</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-856">Obtém o número de dias para reter as entradas no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-856">Gets the number of days to retain entries in the event log.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="ce427-857">O número de dias durante os quais as entradas no log de eventos são retidas.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-857">The number of days that entries in the event log are retained.</span>
          </span>
          <span data-ttu-id="ce427-858">O valor padrão é 7.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-858">The default value is 7.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-859">Use o <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> propriedade para examinar a configuração atual de um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-859">Use the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> property to examine the current setting for an event log.</span></span> <span data-ttu-id="ce427-860">Use <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> para alterar o número mínimo de dias que cada entrada no log de eventos deve ser mantida.</span><span class="sxs-lookup"><span data-stu-id="ce427-860">Use <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> to change the minimum number of days that each entry in the event log must be retained.</span></span>  
  
 <span data-ttu-id="ce427-861">O <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> valor depende do comportamento de estouro de configurado o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-861">The <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value depends on the configured overflow behavior of the event log.</span></span> <span data-ttu-id="ce427-862">Se o <xref:System.Diagnostics.OverflowAction> propriedade para um log de eventos é definida como <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, em seguida, a <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> valor é 0.</span><span class="sxs-lookup"><span data-stu-id="ce427-862">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is 0.</span></span> <span data-ttu-id="ce427-863">Se o <xref:System.Diagnostics.OverflowAction> propriedade para um log de eventos é definida como <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, em seguida, a <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> valor é -1.</span><span class="sxs-lookup"><span data-stu-id="ce427-863">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is -1.</span></span> <span data-ttu-id="ce427-864">Se o <xref:System.Diagnostics.OverflowAction> propriedade para um log de eventos é definida como <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, em seguida, a <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> valor é maior que zero e representa o número de dias para manter entradas do log de eventos quando o log de eventos está cheio.</span><span class="sxs-lookup"><span data-stu-id="ce427-864">If the <xref:System.Diagnostics.OverflowAction> property for an event log is set to <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, then the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> value is greater than zero, and represents the number of days to retain event log entries when the event log is full.</span></span>  
  
 <span data-ttu-id="ce427-865">O comportamento de estouro ocorre apenas quando um log de eventos atinge seu limite de tamanho.</span><span class="sxs-lookup"><span data-stu-id="ce427-865">The overflow behavior only occurs when an event log reaches its size limit.</span></span> <span data-ttu-id="ce427-866">Quando um <xref:System.Diagnostics.EventLog> tem sua <xref:System.Diagnostics.EventLog.OverflowAction%2A> definido como <xref:System.Diagnostics.OverflowAction.OverwriteOlder>e o log de eventos atinge seu tamanho máximo, em seguida, novas entradas são gravadas somente se eles podem substituir entradas cuja idade excede o <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> período.</span><span class="sxs-lookup"><span data-stu-id="ce427-866">When an <xref:System.Diagnostics.EventLog> has its <xref:System.Diagnostics.EventLog.OverflowAction%2A> set to <xref:System.Diagnostics.OverflowAction.OverwriteOlder>, and the event log reaches its maximum size, then new entries are written only if they can replace entries whose age exceeds the <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> period.</span></span> <span data-ttu-id="ce427-867">Retenção de entradas de eventos por um período mínimo é apropriado quando o log de eventos é arquivado regularmente.</span><span class="sxs-lookup"><span data-stu-id="ce427-867">Retaining event entries for a minimum period is appropriate when the event log is archived regularly.</span></span> <span data-ttu-id="ce427-868">Caso contrário, você corre o risco de perder novas entradas quando o log de eventos atinge seu limite.</span><span class="sxs-lookup"><span data-stu-id="ce427-868">Otherwise, you risk losing new entries when the event log reaches its limit.</span></span> <span data-ttu-id="ce427-869">Para evitar perder as novas informações de evento, defina os dias de retenção mínimo para eventos com base em seu agendamento de arquivo morto para um determinado log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-869">To avoid losing new event information, set the minimum retention days for events based on your archive schedule for a particular event log.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-870">O exemplo a seguir enumera os logs de evento definidos no computador local e exibe os detalhes de configuração para cada log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-870">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-871">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-871">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-872">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-872">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
      </Docs>
    </Member>
    <Member MemberName="ModifyOverflowPolicy">
      <MemberSignature Language="C#" Value="public void ModifyOverflowPolicy (System.Diagnostics.OverflowAction action, int retentionDays);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void ModifyOverflowPolicy(valuetype System.Diagnostics.OverflowAction action, int32 retentionDays) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub ModifyOverflowPolicy (action As OverflowAction, retentionDays As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void ModifyOverflowPolicy(System::Diagnostics::OverflowAction action, int retentionDays);" />
      <MemberSignature Language="F#" Value="member this.ModifyOverflowPolicy : System.Diagnostics.OverflowAction * int -&gt; unit" Usage="eventLog.ModifyOverflowPolicy (action, retentionDays)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="action" Type="System.Diagnostics.OverflowAction" />
        <Parameter Name="retentionDays" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="action">
          <span data-ttu-id="ce427-873">O comportamento de estouro para gravar novas entradas no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-873">The overflow behavior for writing new entries to the event log.</span>
          </span>
        </param>
        <param name="retentionDays">
          <span data-ttu-id="ce427-874">O número mínimo de dias durante os quais cada entrada de log de eventos é mantida.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-874">The minimum number of days each event log entry is retained.</span>
          </span>
          <span data-ttu-id="ce427-875">Este parâmetro será usado apenas se <c>action</c> for definido como <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-875">This parameter is used only if <c>action</c> is set to <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-876">Altera o comportamento configurado para gravar novas entradas quando o log de eventos atinge o tamanho máximo do arquivo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-876">Changes the configured behavior for writing new entries when the event log reaches its maximum file size.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-877">O comportamento de estouro para um log de eventos especifica o que acontece quando novas entradas devem ser gravados em um log que atingiu seu tamanho máximo do arquivo.</span><span class="sxs-lookup"><span data-stu-id="ce427-877">The overflow behavior for an event log specifies what happens when new entries are to be written to a log that has reached its maximum file size.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-878">O comportamento de estouro entra em vigor somente quando um log de eventos atinge o tamanho máximo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="ce427-878">The overflow behavior takes effect only when an event log reaches its maximum file size.</span></span> <span data-ttu-id="ce427-879">O comportamento de estouro não afeta a gravar uma nova entrada em um log que possa acomodar as entradas de log de eventos adicionais.</span><span class="sxs-lookup"><span data-stu-id="ce427-879">The overflow behavior does not affect writing a new entry to a log that can accommodate additional event log entries.</span></span>  
  
 <span data-ttu-id="ce427-880">O <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> método configura o comportamento de estouro de um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-880">The <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method configures the overflow behavior of an event log.</span></span> <span data-ttu-id="ce427-881"><xref:System.Diagnostics.EventLog> instância.</span><span class="sxs-lookup"><span data-stu-id="ce427-881"><xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="ce427-882">Depois de chamar esse método para o log de eventos especificado pelo <xref:System.Diagnostics.EventLog.Log%2A> propriedade, o <xref:System.Diagnostics.EventLog.OverflowAction%2A> e <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> valores de propriedade refletem o comportamento de estouro recém-configurado.</span><span class="sxs-lookup"><span data-stu-id="ce427-882">After calling this method for the event log specified by the <xref:System.Diagnostics.EventLog.Log%2A> property, the <xref:System.Diagnostics.EventLog.OverflowAction%2A> and <xref:System.Diagnostics.EventLog.MinimumRetentionDays%2A> property values reflect the newly configured overflow behavior.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-883">Esta propriedade representa uma definição de configuração para o log de evento representado por esta instância.</span><span class="sxs-lookup"><span data-stu-id="ce427-883">This property represents a configuration setting for the event log represented by this instance.</span></span> <span data-ttu-id="ce427-884">Quando o log de eventos atinge seu tamanho máximo, essa propriedade especifica como o sistema operacional trata as novas entradas gravadas por todas as fontes de evento registradas para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-884">When the event log reaches its maximum size, this property specifies how the operating system handles new entries written by all event sources registered for the event log.</span></span>  
  
 <span data-ttu-id="ce427-885">Defina as `action` parâmetro para <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded> para indicar que uma nova entrada substitui a entrada mais antiga quando o <xref:System.Diagnostics.EventLog> atinge seu tamanho máximo.</span><span class="sxs-lookup"><span data-stu-id="ce427-885">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded> to indicate that a new entry overwrites the oldest entry when the <xref:System.Diagnostics.EventLog> reaches its maximum size.</span></span> <span data-ttu-id="ce427-886">Se o `action` parâmetro é definido como <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, o `retentionDays` valor do parâmetro é ignorado.</span><span class="sxs-lookup"><span data-stu-id="ce427-886">If the `action` parameter is set to <xref:System.Diagnostics.OverflowAction.OverwriteAsNeeded>, the `retentionDays` parameter value is ignored.</span></span>  
  
 <span data-ttu-id="ce427-887">Defina as `action` parâmetro para <xref:System.Diagnostics.OverflowAction.OverwriteOlder> para indicar que cada nova entrada substitui as entradas mais antigas quando o <xref:System.Diagnostics.EventLog> atinge seu tamanho máximo.</span><span class="sxs-lookup"><span data-stu-id="ce427-887">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.OverwriteOlder> to indicate that each new entry overwrites older entries when the <xref:System.Diagnostics.EventLog> reaches its maximum size.</span></span> <span data-ttu-id="ce427-888">Especifique o número de dias que os eventos devem ser mantidos no log usando o `retentionDays` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="ce427-888">Specify the number of days that events must be retained in the log using the `retentionDays` parameter.</span></span> <span data-ttu-id="ce427-889">Eventos gravados dentro do intervalo de retenção não são substituídos por novas entradas.</span><span class="sxs-lookup"><span data-stu-id="ce427-889">Events written within the retention range are not overwritten by new entries.</span></span>  
  
 <span data-ttu-id="ce427-890">Defina as `action` parâmetro para <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> para descartar os novos eventos quando o tamanho máximo do log for atingido.</span><span class="sxs-lookup"><span data-stu-id="ce427-890">Set the `action` parameter to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> to discard new events when the maximum log size is reached.</span></span> <span data-ttu-id="ce427-891">Se o `action` parâmetro é definido como <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, o `retentionDays` valor do parâmetro é ignorado.</span><span class="sxs-lookup"><span data-stu-id="ce427-891">If the `action` parameter is set to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite>, the `retentionDays` parameter value is ignored.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="ce427-892">Configuração da diretiva de estouro <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> Especifica que novas entradas são descartadas quando o log de eventos está cheio.</span><span class="sxs-lookup"><span data-stu-id="ce427-892">Setting the overflow policy to <xref:System.Diagnostics.OverflowAction.DoNotOverwrite> specifies that new entries are discarded when the event log is full.</span></span> <span data-ttu-id="ce427-893">Se você usar essa configuração, verifique se o log de eventos regularmente é arquivado e limpo para evitar atingir seu limite de tamanho máximo.</span><span class="sxs-lookup"><span data-stu-id="ce427-893">If you use this setting, ensure the event log is regularly archived and cleared to avoid reaching its maximum size limit.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-894">O exemplo a seguir exibe a política de estouro configurado para um log de eventos especificado e permite que o usuário selecionar uma nova configuração de política de estouro do log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-894">The following example displays the configured overflow policy for a specified event log, and allows the user to select a new overflow policy setting for the event log.</span></span>  
  
 [!code-cpp[EventLogProperties#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#3)]
 [!code-csharp[EventLogProperties#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#3)]
 [!code-vb[EventLogProperties#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="ce427-895">
            <paramref name="action" /> não é um valor <see cref="P:System.Diagnostics.EventLog.OverflowAction" /> válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-895">
              <paramref name="action" /> is not a valid <see cref="P:System.Diagnostics.EventLog.OverflowAction" /> value.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentOutOfRangeException">
          <span data-ttu-id="ce427-896">
            <paramref name="retentionDays" /> é menor do que um ou maior que 365.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-896">
              <paramref name="retentionDays" /> is less than one, or larger than 365.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-897">O valor <see cref="P:System.Diagnostics.EventLog.Log" /> não é um nome de log válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-897">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span>
          </span>
          <span data-ttu-id="ce427-898">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-898">\- or -</span>
          </span>
          <span data-ttu-id="ce427-899">Não foi possível abrir a chave do Registro do log de eventos no computador de destino.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-899">The registry key for the event log could not be opened on the target computer.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-900">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-900">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-901">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-901">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="P:System.Diagnostics.EventLog.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      </Docs>
    </Member>
    <Member MemberName="OverflowAction">
      <MemberSignature Language="C#" Value="public System.Diagnostics.OverflowAction OverflowAction { get; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.Diagnostics.OverflowAction OverflowAction" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.OverflowAction" />
      <MemberSignature Language="VB.NET" Value="Public ReadOnly Property OverflowAction As OverflowAction" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::Diagnostics::OverflowAction OverflowAction { System::Diagnostics::OverflowAction get(); };" />
      <MemberSignature Language="F#" Value="member this.OverflowAction : System.Diagnostics.OverflowAction" Usage="System.Diagnostics.EventLog.OverflowAction" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Diagnostics.OverflowAction</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-902">Obtém o comportamento configurado para armazenar novas entradas quando o log de eventos atinge o tamanho máximo do arquivo de log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-902">Gets the configured behavior for storing new entries when the event log reaches its maximum log file size.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="ce427-903">O valor <see cref="T:System.Diagnostics.OverflowAction" /> que especifica o comportamento configurado para armazenar novas entradas quando o log de eventos atinge o tamanho máximo do log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-903">The <see cref="T:System.Diagnostics.OverflowAction" /> value that specifies the configured behavior for storing new entries when the event log reaches its maximum log size.</span>
          </span>
          <span data-ttu-id="ce427-904">O padrão é <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-904">The default is <see cref="F:System.Diagnostics.OverflowAction.OverwriteOlder" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-905">Logs de eventos crescem em tamanho, como novos eventos são gravados neles.</span><span class="sxs-lookup"><span data-stu-id="ce427-905">Event logs grow in size as new events are written to them.</span></span> <span data-ttu-id="ce427-906">Cada log de eventos tem um limite de tamanho máximo configurado; o <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> propriedade define o número máximo de kilobytes permitidos para o tamanho do arquivo de log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-906">Each event log has a configured maximum size limit; the <xref:System.Diagnostics.EventLog.MaximumKilobytes%2A> property defines the maximum number of kilobytes allowed for the event log file size.</span></span>  
  
 <span data-ttu-id="ce427-907">Use o <xref:System.Diagnostics.EventLog.OverflowAction%2A> valor da propriedade para examinar o comportamento de estouro configurado para um log de eventos em seu tamanho máximo.</span><span class="sxs-lookup"><span data-stu-id="ce427-907">Use the <xref:System.Diagnostics.EventLog.OverflowAction%2A> property value to examine the configured overflow behavior for an event log at its maximum size.</span></span> <span data-ttu-id="ce427-908">Use o <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> método para alterar o comportamento de estouro para um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-908">Use the <xref:System.Diagnostics.EventLog.ModifyOverflowPolicy%2A> method to change the overflow behavior for an event log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-909">O comportamento de estouro entra em vigor somente quando um log de eventos atinge o tamanho máximo de arquivo.</span><span class="sxs-lookup"><span data-stu-id="ce427-909">The overflow behavior takes effect only when an event log reaches its maximum file size.</span></span> <span data-ttu-id="ce427-910">O comportamento de estouro não afeta a gravar uma nova entrada em um log que possa acomodar as entradas de log de eventos adicionais.</span><span class="sxs-lookup"><span data-stu-id="ce427-910">The overflow behavior does not affect writing a new entry to a log that can accommodate additional event log entries.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-911">O exemplo a seguir enumera os logs de evento definidos no computador local e exibe os detalhes de configuração para cada log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-911">The following example enumerates the event logs defined on the local computer, and displays configuration details for each event log.</span></span>  
  
 [!code-cpp[EventLogProperties#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLogProperties/CPP/source.cpp#2)]
 [!code-csharp[EventLogProperties#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLogProperties/CS/source.cs#2)]
 [!code-vb[EventLogProperties#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLogProperties/VB/source.vb#2)]  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-912">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-912">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-913">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-913">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.OverflowAction" />
        <altmember cref="P:System.Diagnostics.EventLog.MaximumKilobytes" />
        <altmember cref="M:System.Diagnostics.EventLog.ModifyOverflowPolicy(System.Diagnostics.OverflowAction,System.Int32)" />
        <altmember cref="P:System.Diagnostics.EventLog.MinimumRetentionDays" />
      </Docs>
    </Member>
    <Member MemberName="RegisterDisplayName">
      <MemberSignature Language="C#" Value="public void RegisterDisplayName (string resourceFile, long resourceId);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void RegisterDisplayName(string resourceFile, int64 resourceId) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.RegisterDisplayName(System.String,System.Int64)" />
      <MemberSignature Language="VB.NET" Value="Public Sub RegisterDisplayName (resourceFile As String, resourceId As Long)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void RegisterDisplayName(System::String ^ resourceFile, long resourceId);" />
      <MemberSignature Language="F#" Value="member this.RegisterDisplayName : string * int64 -&gt; unit" Usage="eventLog.RegisterDisplayName (resourceFile, resourceId)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoTODO</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="resourceFile" Type="System.String" />
        <Parameter Name="resourceId" Type="System.Int64" />
      </Parameters>
      <Docs>
        <param name="resourceFile">
          <span data-ttu-id="ce427-914">O caminho totalmente especificado para um arquivo de recurso localizado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-914">The fully specified path to a localized resource file.</span>
          </span>
        </param>
        <param name="resourceId">
          <span data-ttu-id="ce427-915">O identificador de recurso que indexa uma cadeia de caracteres localizada dentro do arquivo de recurso.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-915">The resource identifier that indexes a localized string within the resource file.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-916">Especifica o nome localizado do log de eventos, que é exibido no Visualizador de Eventos do servidor.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-916">Specifies the localized name of the event log, which is displayed in the server Event Viewer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-917">Use <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> para registrar e exibir um nome localizado no Visualizador de eventos para logs de eventos personalizados.</span><span class="sxs-lookup"><span data-stu-id="ce427-917">Use <xref:System.Diagnostics.EventLog.RegisterDisplayName%2A> to register and display a localized name in the Event Viewer for custom event logs.</span></span>  
  
 <span data-ttu-id="ce427-918">O identificador de recurso especificado deve corresponder a uma cadeia de caracteres localizada definida no arquivo de recurso.</span><span class="sxs-lookup"><span data-stu-id="ce427-918">The specified resource identifier must correspond to a localized string defined in the resource file.</span></span> <span data-ttu-id="ce427-919">O Visualizador de eventos exibe o nome do log de eventos personalizado usando a cadeia de caracteres localizada e as configurações de cultura atual.</span><span class="sxs-lookup"><span data-stu-id="ce427-919">The Event Viewer displays the custom event log name using the localized string and the current culture settings.</span></span> <span data-ttu-id="ce427-920">Por exemplo, você pode definir vários nomes de log de eventos, localizados para culturas diferentes em seu arquivo de recurso.</span><span class="sxs-lookup"><span data-stu-id="ce427-920">For example, you can define multiple event log names localized for different cultures in your resource file.</span></span> <span data-ttu-id="ce427-921">O Visualizador de eventos exibe a cadeia de caracteres localizada correspondente às configurações de cultura do usuário atual.</span><span class="sxs-lookup"><span data-stu-id="ce427-921">The Event Viewer displays the localized string corresponding to the culture settings of the current user.</span></span>  
  
 <span data-ttu-id="ce427-922">Se o Visualizador de eventos não é possível carregar a cadeia de caracteres localizada do arquivo de recurso, ou se nenhum nome de exibição foi registrado para o log de eventos, o Visualizador de eventos exibe o nome do log de eventos definido no <xref:System.Diagnostics.EventLog.Log%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-922">If the Event Viewer cannot load the localized string from the resource file, or if no display name was registered for the event log, then the Event Viewer displays the event log name defined in <xref:System.Diagnostics.EventLog.Log%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-923">Você não precisa registrar um nome de exibição para os logs de eventos predefinidos.</span><span class="sxs-lookup"><span data-stu-id="ce427-923">You do not need to register a display name for the pre-defined event logs.</span></span> <span data-ttu-id="ce427-924">O sistema operacional registra os nomes de exibição localizado para os logs de eventos do aplicativo, sistema e segurança.</span><span class="sxs-lookup"><span data-stu-id="ce427-924">The operating system registers the localized display names for the Application, System, and Security event logs.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-925">O exemplo a seguir determina se a origem do evento nomeado `SampleApplicationSource` está registrado no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-925">The following example determines whether the event source named `SampleApplicationSource` is registered on the local computer.</span></span> <span data-ttu-id="ce427-926">Se a origem do evento não existir, o exemplo define o arquivo de recurso de mensagem para a fonte e cria a nova origem do evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-926">If the event source does not exist, the example sets the message resource file for the source and creates the new event source.</span></span> <span data-ttu-id="ce427-927">Por fim, o exemplo define o nome de exibição localizado para o log de eventos, usando o valor do identificador de recurso de `DisplayNameMsgId` e o caminho do arquivo de recurso no `messageFile`.</span><span class="sxs-lookup"><span data-stu-id="ce427-927">Finally, the example sets the localized display name for the event log, using the resource identifier value in `DisplayNameMsgId` and the resource file path in `messageFile`.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#6](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#6)]
 [!code-csharp[EventLog_WriteEvent#6](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#6)]
 [!code-vb[EventLog_WriteEvent#6](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#6)]  
  
 <span data-ttu-id="ce427-928">O exemplo usa o seguinte arquivo de texto de mensagem, criado para a biblioteca do recurso EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="ce427-928">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="ce427-929">Um arquivo de texto da mensagem é a origem do qual o arquivo de recurso de mensagem é criado.</span><span class="sxs-lookup"><span data-stu-id="ce427-929">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="ce427-930">O arquivo de texto de mensagem define os identificadores de recurso e o texto para a categoria, a mensagem de evento e a cadeias de caracteres de inserção de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="ce427-930">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span> <span data-ttu-id="ce427-931">Especificamente, o identificador de recurso 5001 é definido para o nome localizado do log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-931">Specifically, resource identifier 5001 is defined for the localized name of the event log.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-932">O valor <see cref="P:System.Diagnostics.EventLog.Log" /> não é um nome de log válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-932">The <see cref="P:System.Diagnostics.EventLog.Log" /> value is not a valid log name.</span>
          </span>
          <span data-ttu-id="ce427-933">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-933">\- or -</span>
          </span>
          <span data-ttu-id="ce427-934">Não foi possível abrir a chave do Registro do log de eventos no computador de destino.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-934">The registry key for the event log could not be opened on the target computer.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="ce427-935">
            <paramref name="resourceFile" /> é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-935">
              <paramref name="resourceFile" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-936">para administrar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-936">for administering event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-937">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-937">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Administer" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.LogDisplayName" />
      </Docs>
    </Member>
    <Member MemberName="Source">
      <MemberSignature Language="C#" Value="public string Source { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Source" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.Source" />
      <MemberSignature Language="VB.NET" Value="Public Property Source As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Source { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Source : string with get, set" Usage="System.Diagnostics.EventLog.Source" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.ReadOnly(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.RecommendedAsConfigurable(true)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("The application name that writes the log.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogSource")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5">
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.ComponentModel.SettingsBindable(true)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-938">Obtém ou define o nome da fonte a ser registrado e usado ao gravar no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-938">Gets or sets the source name to register and use when writing to the event log.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="ce427-939">O nome registrado com o log de eventos como uma fonte de entradas.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-939">The name registered with the event log as a source of entries.</span>
          </span>
          <span data-ttu-id="ce427-940">O padrão é uma cadeia de caracteres vazia ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-940">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-941">A origem do evento indica que o que registra o evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-941">The event source indicates what logs the event.</span></span> <span data-ttu-id="ce427-942">Geralmente é o nome do aplicativo ou o nome de um subcomponente do aplicativo, se o aplicativo for grande.</span><span class="sxs-lookup"><span data-stu-id="ce427-942">It is often the name of the application, or the name of a subcomponent of the application, if the application is large.</span></span> <span data-ttu-id="ce427-943">Aplicativos e serviços devem gravar no log do aplicativo ou um log personalizado.</span><span class="sxs-lookup"><span data-stu-id="ce427-943">Applications and services should write to the Application log or a custom log.</span></span> <span data-ttu-id="ce427-944">Drivers de dispositivo devem gravar no log do sistema.</span><span class="sxs-lookup"><span data-stu-id="ce427-944">Device drivers should write to the System log.</span></span>  
  
 <span data-ttu-id="ce427-945">Você só precisa especificar uma origem do evento, se você estiver gravando em um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-945">You only need to specify an event source if you are writing to an event log.</span></span> <span data-ttu-id="ce427-946">Antes de gravar uma entrada para um log de eventos, você deve registrar a origem do evento no log de eventos como uma origem válida de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-946">Before writing an entry to an event log, you must register the event source with the event log as a valid source of events.</span></span> <span data-ttu-id="ce427-947">Quando você grava uma entrada de log, o sistema usa o <xref:System.Diagnostics.EventLog.Source%2A> propriedade para localizar o log adequado no qual colocar sua entrada.</span><span class="sxs-lookup"><span data-stu-id="ce427-947">When you write a log entry, the system uses the <xref:System.Diagnostics.EventLog.Source%2A> property to find the appropriate log in which to place your entry.</span></span> <span data-ttu-id="ce427-948">Se você estiver lendo o log de eventos, você pode especificar o <xref:System.Diagnostics.EventLog.Source%2A>, ou uma <xref:System.Diagnostics.EventLog.Log%2A> e <xref:System.Diagnostics.EventLog.MachineName%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-948">If you are reading the event log, you can either specify the <xref:System.Diagnostics.EventLog.Source%2A>, or a <xref:System.Diagnostics.EventLog.Log%2A> and <xref:System.Diagnostics.EventLog.MachineName%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-949">Não é necessário especificar o <xref:System.Diagnostics.EventLog.MachineName%2A> se você estiver se conectando a um log no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-949">You are not required to specify the <xref:System.Diagnostics.EventLog.MachineName%2A> if you are connecting to a log on the local computer.</span></span> <span data-ttu-id="ce427-950">Se você não especificar o <xref:System.Diagnostics.EventLog.MachineName%2A>, o computador local (".") é assumido.</span><span class="sxs-lookup"><span data-stu-id="ce427-950">If you do not specify the <xref:System.Diagnostics.EventLog.MachineName%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="ce427-951">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> e <xref:System.Diagnostics.EventLog.WriteEntry%2A> para gravar eventos em um log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-951">Use <xref:System.Diagnostics.EventLog.WriteEvent%2A> and <xref:System.Diagnostics.EventLog.WriteEntry%2A> to write events to an event log.</span></span> <span data-ttu-id="ce427-952">Você deve especificar uma origem de evento para gravar eventos; Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-952">You must specify an event source to write events; you must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="ce427-953">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-953">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-954">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-954">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-955">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-955">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-956">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-956">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-957">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-957">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-958">Você pode criar uma fonte de evento para um log de eventos existente ou um novo log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-958">You can create an event source for an existing event log or a new event log.</span></span> <span data-ttu-id="ce427-959">Quando você cria uma nova origem para um novo log de eventos, o sistema registra a origem para que o log, mas o log não é criado até que a primeira entrada seja gravada nele.</span><span class="sxs-lookup"><span data-stu-id="ce427-959">When you create a new source for a new event log, the system registers the source for that log, but the log is not created until the first entry is written to it.</span></span>  
  
 <span data-ttu-id="ce427-960">A origem deve ser exclusiva no computador local; um novo nome de origem não pode corresponder a um nome de origem existente ou um nome de log de eventos existente.</span><span class="sxs-lookup"><span data-stu-id="ce427-960">The source must be unique on the local computer; a new source name cannot match an existing source name or an existing event log name.</span></span> <span data-ttu-id="ce427-961">Cada fonte pode gravar apenas um log de eventos ao mesmo tempo; No entanto, seu aplicativo pode usar várias fontes para gravar em vários logs de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-961">Each source can write to only one event log at a time; however, your application can use multiple sources to write to multiple event logs.</span></span> <span data-ttu-id="ce427-962">Por exemplo, seu aplicativo pode exigir várias fontes, configurados para arquivos de recurso diferente ou logs de eventos diferentes.</span><span class="sxs-lookup"><span data-stu-id="ce427-962">For example, your application might require multiple sources configured for different event logs or different resource files.</span></span>  
  
 <span data-ttu-id="ce427-963">Se você alterar o <xref:System.Diagnostics.EventLog.Source%2A> valor, o <xref:System.Diagnostics.EventLog> para que ele esteja registrado é fechado e todos os identificadores de eventos são liberados.</span><span class="sxs-lookup"><span data-stu-id="ce427-963">If you change the <xref:System.Diagnostics.EventLog.Source%2A> value, the <xref:System.Diagnostics.EventLog> to which it is registered is closed and all event handles are released.</span></span>  
  
 <span data-ttu-id="ce427-964">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-964">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-965">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-965">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-966">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-966">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-967">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-967">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
 <span data-ttu-id="ce427-968">Para alterar os detalhes de configuração de uma fonte existente, você deve excluir a fonte e, em seguida, criá-lo com a nova configuração.</span><span class="sxs-lookup"><span data-stu-id="ce427-968">To change the configuration details of an existing source, you must delete the source and then create it with the new configuration.</span></span> <span data-ttu-id="ce427-969">Se outros aplicativos ou componentes de usam o código-fonte existente, crie uma nova fonte com a configuração atualizada, em vez de excluir o código-fonte existente.</span><span class="sxs-lookup"><span data-stu-id="ce427-969">If other applications or components use the existing source, create a new source with the updated configuration rather than deleting the existing source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-970">Se uma fonte já tiver sido mapeada para um log e remapeá-la para um novo log, você deve reiniciar o computador para que as alterações entrem em vigor.</span><span class="sxs-lookup"><span data-stu-id="ce427-970">If a source has already been mapped to a log and you remap it to a new log, you must restart the computer for the changes to take effect.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-971">O exemplo a seguir cria a fonte `MySource` se ele ainda não existir e grava uma entrada no log de eventos `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="ce427-971">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Source Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Source Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Source Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Source Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-972">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-972">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-973">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-973">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-974">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-974">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Log" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      </Docs>
    </Member>
    <MemberGroup MemberName="SourceExists">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-975">Pesquisa determinada origem do evento no Registro do computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-975">Searches a computer's registry for a given event source.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="SourceExists">
      <MemberSignature Language="C#" Value="public static bool SourceExists (string source);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool SourceExists(string source) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function SourceExists (source As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool SourceExists(System::String ^ source);" />
      <MemberSignature Language="F#" Value="static member SourceExists : string -&gt; bool" Usage="System.Diagnostics.EventLog.SourceExists source" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="ce427-976">O nome da origem do evento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-976">The name of the event source.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-977">Determina se um evento de origem foi registrado no computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-977">Determines whether an event source is registered on the local computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="ce427-978">
            <see langword="true" /> se a origem do evento for registrada no computador local; caso contrário, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-978">
              <see langword="true" /> if the event source is registered on the local computer; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-979">Use esse método para determinar se uma fonte de eventos existe no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-979">Use this method to determine whether an event source exists on the local computer.</span></span> <span data-ttu-id="ce427-980">Se você deseja determinar se um log existe no computador local, use <xref:System.Diagnostics.EventLog.Exists%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-980">If you want to determine whether a log exists on the local computer, use <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 <span data-ttu-id="ce427-981">Como esse método acessa o registro, você deve ter as permissões de registro apropriados no computador local; Caso contrário, um <xref:System.Security.SecurityException> será lançada.</span><span class="sxs-lookup"><span data-stu-id="ce427-981">Because this method accesses the registry, you must have the appropriate registry permissions on the local computer; otherwise, a <xref:System.Security.SecurityException> will be thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-982">Para procurar uma fonte de eventos no Windows Vista e posterior ou o Windows Server 2003, você deve ter privilégios administrativos.</span><span class="sxs-lookup"><span data-stu-id="ce427-982">To search for an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="ce427-983">O motivo para esse requisito é que todos os logs de eventos, incluindo segurança, devem ser pesquisados para determinar se a origem do evento é exclusiva.</span><span class="sxs-lookup"><span data-stu-id="ce427-983">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="ce427-984">Começando com o Windows Vista, os usuários não têm permissão para acessar o log de segurança; Portanto, um <xref:System.Security.SecurityException> é gerada.</span><span class="sxs-lookup"><span data-stu-id="ce427-984">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="ce427-985">Começando com o Windows Vista, o controle de conta de usuário (UAC) determina os privilégios de um usuário.</span><span class="sxs-lookup"><span data-stu-id="ce427-985">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="ce427-986">Se for um membro do grupo Administradores Internos, você receberá dois tokens de acesso do tempo de execução: um token de acesso do usuário padrão e um token de acesso do administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-986">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="ce427-987">Por padrão, você está na função de usuário padrão.</span><span class="sxs-lookup"><span data-stu-id="ce427-987">By default, you are in the standard user role.</span></span> <span data-ttu-id="ce427-988">Para executar o código que acessa os contadores de desempenho, você deve primeiro elevar seus privilégios de usuário padrão ao administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-988">To execute the code that accesses performance counters, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="ce427-989">Você pode fazer isso quando você iniciar um aplicativo clicando duas vezes no ícone do aplicativo e que indica que você deseja executar como administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-989">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-990">Um serviço que está executando sob o <xref:System.ServiceProcess.ServiceAccount.LocalSystem> conta não tem os privilégios necessários para executar esse método.</span><span class="sxs-lookup"><span data-stu-id="ce427-990">A service that is executing under the <xref:System.ServiceProcess.ServiceAccount.LocalSystem> account does not have the privileges required to execute this method.</span></span> <span data-ttu-id="ce427-991">A solução é verificar se a origem do evento existe no <xref:System.ServiceProcess.ServiceInstaller>, e se ele não existir, para criar a fonte no instalador.</span><span class="sxs-lookup"><span data-stu-id="ce427-991">The solution is to check whether the event source exists in the <xref:System.ServiceProcess.ServiceInstaller>, and if it does not exist, to create the source in the installer.</span></span>  
  
 <span data-ttu-id="ce427-992">Porque você não pode dar uma nova origem o nome de uma fonte existente no mesmo computador, use esse método antes de tentar chamar <xref:System.Diagnostics.EventLog.CreateEventSource%2A> para garantir que uma fonte com o nome especificado pelo `source` ainda não existir no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-992">Because you cannot give a new source the name of an existing source on the same computer, use this method before attempting to call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to ensure that a source with the name specified by `source` does not already exist on the local computer.</span></span> <span data-ttu-id="ce427-993">O `source` parâmetro não diferencia maiusculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="ce427-993">The `source` parameter is not case-sensitive.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-994">O exemplo a seguir cria a fonte `MySource` se ele ainda não existir e grava uma entrada no log de eventos `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="ce427-994">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.Source Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.Source Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.Source Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.Source Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.Source Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="ce427-995">
            <paramref name="source" /> não foi encontrado, mas alguns ou todos os logs de evento não puderam ser pesquisados.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-995">
              <paramref name="source" /> was not found, but some or all of the event logs could not be searched.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-996">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-996">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-997">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-997">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
      </Docs>
    </Member>
    <Member MemberName="SourceExists">
      <MemberSignature Language="C#" Value="public static bool SourceExists (string source, string machineName);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig bool SourceExists(string source, string machineName) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.SourceExists(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Function SourceExists (source As String, machineName As String) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static bool SourceExists(System::String ^ source, System::String ^ machineName);" />
      <MemberSignature Language="F#" Value="static member SourceExists : string * string -&gt; bool" Usage="System.Diagnostics.EventLog.SourceExists (source, machineName)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.MonoNotSupported("remote machine is not supported")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="machineName" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="ce427-998">O nome da origem do evento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-998">The name of the event source.</span>
          </span>
        </param>
        <param name="machineName">
          <span data-ttu-id="ce427-999">O nome do computador no qual procurar, ou "." para o computador local.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-999">The name the computer on which to look, or "." for the local computer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1000">Determina se uma origem do evento está registrada em um computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1000">Determines whether an event source is registered on a specified computer.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="ce427-1001">
            <see langword="true" /> se a origem do evento for registrada no computador especificado; caso contrário, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1001">
              <see langword="true" /> if the event source is registered on the given computer; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1002">Use esse método para determinar se uma fonte de eventos existe no computador especificado pelo `machineName` parâmetro.</span><span class="sxs-lookup"><span data-stu-id="ce427-1002">Use this method to determine whether an event source exists on the computer specified by the `machineName` parameter.</span></span> <span data-ttu-id="ce427-1003">Se você deseja determinar se um log existe no computador especificado, use <xref:System.Diagnostics.EventLog.Exists%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1003">If you want to determine whether a log exists on the specified computer, use <xref:System.Diagnostics.EventLog.Exists%2A>.</span></span>  
  
 <span data-ttu-id="ce427-1004">Como esse método acessa o registro, você deve ter as permissões de registro apropriadas em determinado servidor; Caso contrário, um <xref:System.Security.SecurityException> será lançada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1004">Because this method accesses the registry, you must have the appropriate registry permissions on the given server; otherwise, a <xref:System.Security.SecurityException> will be thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1005">Para procurar uma fonte de eventos no Windows Vista e posterior ou o Windows Server 2003, você deve ter privilégios administrativos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1005">To search for an event source in Windows Vista and later or Windows Server 2003, you must have administrative privileges.</span></span>  
>   
>  <span data-ttu-id="ce427-1006">O motivo para esse requisito é que todos os logs de eventos, incluindo segurança, devem ser pesquisados para determinar se a origem do evento é exclusiva.</span><span class="sxs-lookup"><span data-stu-id="ce427-1006">The reason for this requirement is that all event logs, including security, must be searched to determine whether the event source is unique.</span></span> <span data-ttu-id="ce427-1007">Começando com o Windows Vista, os usuários não têm permissão para acessar o log de segurança; Portanto, um <xref:System.Security.SecurityException> é gerada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1007">Starting with Windows Vista, users do not have permission to access the security log; therefore, a <xref:System.Security.SecurityException> is thrown.</span></span>  
>   
>  <span data-ttu-id="ce427-1008">Começando com o Windows Vista, o controle de conta de usuário (UAC) determina os privilégios de um usuário.</span><span class="sxs-lookup"><span data-stu-id="ce427-1008">Starting with Windows Vista, User Account Control (UAC) determines the privileges of a user.</span></span> <span data-ttu-id="ce427-1009">Se for um membro do grupo Administradores Internos, você receberá dois tokens de acesso do tempo de execução: um token de acesso do usuário padrão e um token de acesso do administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-1009">If you are a member of the Built-in Administrators group, you are assigned two run-time access tokens: a standard user access token and an administrator access token.</span></span> <span data-ttu-id="ce427-1010">Por padrão, você está na função de usuário padrão.</span><span class="sxs-lookup"><span data-stu-id="ce427-1010">By default, you are in the standard user role.</span></span> <span data-ttu-id="ce427-1011">Para executar o código que acessa os contadores de desempenho, você deve primeiro elevar seus privilégios de usuário padrão ao administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-1011">To execute the code that accesses performance counters, you must first elevate your privileges from standard user to administrator.</span></span> <span data-ttu-id="ce427-1012">Você pode fazer isso quando você iniciar um aplicativo clicando duas vezes no ícone do aplicativo e que indica que você deseja executar como administrador.</span><span class="sxs-lookup"><span data-stu-id="ce427-1012">You can do this when you start an application by right-clicking the application icon and indicating that you want to run as an administrator.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1013">Um serviço que está executando sob o <xref:System.ServiceProcess.ServiceAccount.LocalSystem> conta não tem os privilégios necessários para executar esse método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1013">A service that is executing under the <xref:System.ServiceProcess.ServiceAccount.LocalSystem> account does not have the privileges required to execute this method.</span></span> <span data-ttu-id="ce427-1014">A solução é verificar se a origem do evento existe no <xref:System.ServiceProcess.ServiceInstaller>, e se ele não existir, para criar a fonte no instalador.</span><span class="sxs-lookup"><span data-stu-id="ce427-1014">The solution is to check whether the event source exists in the <xref:System.ServiceProcess.ServiceInstaller>, and if it does not exist, to create the source in the installer.</span></span>  
  
 <span data-ttu-id="ce427-1015">Porque você não pode dar uma nova origem o nome de uma fonte existente no mesmo computador, use esse método antes de tentar chamar <xref:System.Diagnostics.EventLog.CreateEventSource%2A> para garantir que uma fonte com o nome especificado pelo `source` ainda não existir no computador.</span><span class="sxs-lookup"><span data-stu-id="ce427-1015">Because you cannot give a new source the name of an existing source on the same computer, use this method before attempting to call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> to ensure that a source with the name specified by `source` does not already exist on the computer.</span></span> <span data-ttu-id="ce427-1016">O `source` e `machineName` parâmetros não diferenciam maiusculas de minúsculas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1016">The `source` and `machineName` parameters are not case sensitive.</span></span>  
  
 <span data-ttu-id="ce427-1017"><xref:System.Diagnostics.EventLog.SourceExists%2A> é um `static` método, ele pode ser chamado na classe em si.</span><span class="sxs-lookup"><span data-stu-id="ce427-1017"><xref:System.Diagnostics.EventLog.SourceExists%2A> is a `static` method, so it can be called on the class itself.</span></span> <span data-ttu-id="ce427-1018">Não é necessário criar uma instância do <xref:System.Diagnostics.EventLog> chamar <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1018">It is not necessary to create an instance of <xref:System.Diagnostics.EventLog> to call <xref:System.Diagnostics.EventLog.SourceExists%2A>.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-1019">O exemplo a seguir cria a fonte `MySource` no computador `MyServer`e grava uma entrada no log de eventos `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="ce427-1019">The following example creates the source `MySource` on the computer `MyServer`, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.SourceExists1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.SourceExists1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1020">
            <paramref name="machineName" /> é um nome do computador inválido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1020">
              <paramref name="machineName" /> is an invalid computer name.</span>
          </span>
        </exception>
        <exception cref="T:System.Security.SecurityException">
          <span data-ttu-id="ce427-1021">
            <paramref name="source" /> não foi encontrado, mas alguns ou todos os logs de evento não puderam ser pesquisados.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1021">
              <paramref name="source" /> was not found, but some or all of the event logs could not be searched.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1022">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1022">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1023">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1023">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.Exists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.MachineName" />
      </Docs>
    </Member>
    <Member MemberName="SynchronizingObject">
      <MemberSignature Language="C#" Value="public System.ComponentModel.ISynchronizeInvoke SynchronizingObject { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance class System.ComponentModel.ISynchronizeInvoke SynchronizingObject" />
      <MemberSignature Language="DocId" Value="P:System.Diagnostics.EventLog.SynchronizingObject" />
      <MemberSignature Language="VB.NET" Value="Public Property SynchronizingObject As ISynchronizeInvoke" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::ComponentModel::ISynchronizeInvoke ^ SynchronizingObject { System::ComponentModel::ISynchronizeInvoke ^ get(); void set(System::ComponentModel::ISynchronizeInvoke ^ value); };" />
      <MemberSignature Language="F#" Value="member this.SynchronizingObject : System.ComponentModel.ISynchronizeInvoke with get, set" Usage="System.Diagnostics.EventLog.SynchronizingObject" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.Browsable(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.ComponentModel.DefaultValue(null)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="xamarinmac-3.0">
          <AttributeName>System.Diagnostics.MonitoringDescription("An object that synchronizes event handler calls.")</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-1.1;netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2">
          <AttributeName>System.Diagnostics.MonitoringDescription("LogSynchronizingObject")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.ComponentModel.ISynchronizeInvoke</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-1024">Obtém ou define o objeto usado para realizar marshaling das chamadas do manipulador de eventos emitidas como resultado de um evento de gravação na entrada <see cref="T:System.Diagnostics.EventLog" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1024">Gets or sets the object used to marshal the event handler calls issued as a result of an <see cref="T:System.Diagnostics.EventLog" /> entry written event.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="ce427-1025">O <see cref="T:System.ComponentModel.ISynchronizeInvoke" /> usado para realizar marshaling das chamadas do manipulador de eventos emitidas como resultado de uma <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> eventos no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1025">The <see cref="T:System.ComponentModel.ISynchronizeInvoke" /> used to marshal event-handler calls issued as a result of an <see cref="E:System.Diagnostics.EventLog.EntryWritten" /> event on the event log.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1026">Quando <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> é `null`, os métodos de tratamento de <xref:System.Diagnostics.EventLog.EntryWritten> eventos são chamados em um thread do pool de threads do sistema.</span><span class="sxs-lookup"><span data-stu-id="ce427-1026">When <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> is `null`, methods handling the <xref:System.Diagnostics.EventLog.EntryWritten> event are called on a thread from the system thread pool.</span></span> <span data-ttu-id="ce427-1027">Para obter mais informações sobre pools de threads do sistema, consulte <xref:System.Threading.ThreadPool>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1027">For more information on system thread pools, see <xref:System.Threading.ThreadPool>.</span></span>  
  
 <span data-ttu-id="ce427-1028">Quando o <xref:System.Diagnostics.EventLog.EntryWritten> evento é manipulado por um visual de formulários do Windows a componente, como um botão, acessando o componente através do pool de threads do sistema pode não funcionar ou pode resultar em uma exceção.</span><span class="sxs-lookup"><span data-stu-id="ce427-1028">When the <xref:System.Diagnostics.EventLog.EntryWritten> event is handled by a visual Windows Forms component, such as a button, accessing the component through the system thread pool might not work, or might result in an exception.</span></span> <span data-ttu-id="ce427-1029">Evitar isso, definindo <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> a um componente de Windows Forms, que faz com que os métodos de tratamento de <xref:System.Diagnostics.EventLog.EntryWritten> evento a ser chamado no mesmo thread em que o componente foi criado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1029">Avoid this by setting <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> to a Windows Forms component, which causes the methods handling the <xref:System.Diagnostics.EventLog.EntryWritten> event to be called on the same thread on which the component was created.</span></span>  
  
 <span data-ttu-id="ce427-1030">Se o <xref:System.Diagnostics.EventLog> é usado dentro de [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] em um designer de formulários do Windows <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> é definida automaticamente como o controle que contém o <xref:System.Diagnostics.EventLog>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1030">If the <xref:System.Diagnostics.EventLog> is used inside [!INCLUDE[vsprvslong](~/includes/vsprvslong-md.md)] in a Windows Forms designer, <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> is automatically set to the control containing the <xref:System.Diagnostics.EventLog>.</span></span> <span data-ttu-id="ce427-1031">Por exemplo, se você colocar um <xref:System.Diagnostics.EventLog> em um designer para Form1 (que herda de <xref:System.Windows.Forms.Form>) a <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> propriedade do <xref:System.Diagnostics.EventLog> está definido para a instância de Form1.</span><span class="sxs-lookup"><span data-stu-id="ce427-1031">For example, if you place an <xref:System.Diagnostics.EventLog> on a designer for Form1 (which inherits from <xref:System.Windows.Forms.Form>) the <xref:System.Diagnostics.EventLog.SynchronizingObject%2A> property of <xref:System.Diagnostics.EventLog> is set to the instance of Form1.</span></span>  
  
 ]]></format>
        </remarks>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1032">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1032">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1033">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1033">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="E:System.Diagnostics.EventLog.EntryWritten" />
        <altmember cref="T:System.Threading.ThreadPool" />
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteEntry">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-1034">Grava uma entrada no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1034">Writes an entry in the event log.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string -&gt; unit" Usage="eventLog.WriteEntry message" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="ce427-1035">A cadeia de caracteres a ser gravada no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1035">The string to write to the event log.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1036">Grava uma entrada de tipo de informação, com o texto da mensagem fornecido, no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1036">Writes an information type entry, with the given message text, to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1037">Use esse método para gravar uma entrada de informações no log de eventos associado a este <xref:System.Diagnostics.EventLog> instância.</span><span class="sxs-lookup"><span data-stu-id="ce427-1037">Use this method to write an information entry to the event log associated with this <xref:System.Diagnostics.EventLog> instance.</span></span> <span data-ttu-id="ce427-1038">Se você quiser especificar qualquer outro <xref:System.Diagnostics.EventLogEntryType>, use uma sobrecarga diferente de <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1038">If you want to specify any other <xref:System.Diagnostics.EventLogEntryType>, use a different overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1039">O `message` cadeia de caracteres não pode conter %*n*, onde *n* é um valor de inteiro (por exemplo, %1), porque o Visualizador de eventos a trata como uma cadeia de caracteres de inserção.</span><span class="sxs-lookup"><span data-stu-id="ce427-1039">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="ce427-1040">Como um protocolo de Internet, a versão do endereço de 6 (IPv6) pode conter essa sequência de caracteres, você não pode registrar uma mensagem de evento que contém um endereço IPv6.</span><span class="sxs-lookup"><span data-stu-id="ce427-1040">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="ce427-1041">Você deve definir a <xref:System.Diagnostics.EventLog.Source%2A> propriedade em seu <xref:System.Diagnostics.EventLog> antes que você pode gravar entradas no log de componente.</span><span class="sxs-lookup"><span data-stu-id="ce427-1041">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="ce427-1042">Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1042">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="ce427-1043">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1043">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-1044">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-1044">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-1045">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-1045">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-1046">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1046">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-1047">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1047">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-1048">Se a fonte especificada na <xref:System.Diagnostics.EventLog.Source%2A> propriedade deste <xref:System.Diagnostics.EventLog> instância não está registrada no computador que o componente está gravando, <xref:System.Diagnostics.EventLog.WriteEntry%2A> chamadas <xref:System.Diagnostics.EventLog.CreateEventSource%2A> e registra o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1048">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1049">Se você não especificar uma <xref:System.Diagnostics.EventLog.MachineName%2A> para seu <xref:System.Diagnostics.EventLog> instância antes de chamar <xref:System.Diagnostics.EventLog.CreateEventSource%2A> ou <xref:System.Diagnostics.EventLog.WriteEntry%2A>, o computador local (".") é assumido.</span><span class="sxs-lookup"><span data-stu-id="ce427-1049">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="ce427-1050">Se o sistema precisa registrar o <xref:System.Diagnostics.EventLog.Source%2A> por meio de uma chamada para <xref:System.Diagnostics.EventLog.WriteEntry%2A> e o <xref:System.Diagnostics.EventLog.Log%2A> propriedade não foi definida no seu <xref:System.Diagnostics.EventLog> instância, o log padrão é o log de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1050">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1051">Muitas das exceções listadas acima são geradas por erros gerados durante o processo de registro de <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1051">Many of the exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="ce427-1052">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1052">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-1053">O <xref:System.Diagnostics.EventLog.WriteEntry%2A> método grava a cadeia de caracteres fornecida diretamente para o log de eventos; ele não usa um arquivo de recurso de mensagem localizável.</span><span class="sxs-lookup"><span data-stu-id="ce427-1053">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="ce427-1054">Use o <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar eventos usando um arquivo de recurso de mensagem localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1054">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="ce427-1055">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1055">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-1056">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1056">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-1057">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1057">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1058">Se você gravar uma entrada em um computador remoto, o valor da mensagem (a cadeia de caracteres de texto) não pode ser o esperado se o computador remoto não está em execução do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="ce427-1058">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1059">Se o `message` parâmetro contém um caractere de terminação nula, a mensagem no log de eventos é encerrada no caractere NUL.</span><span class="sxs-lookup"><span data-stu-id="ce427-1059">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-1060">O exemplo a seguir cria a fonte `MySource` se ele ainda não existir e grava uma entrada no log de eventos `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="ce427-1060">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.CreateEventSource Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.CreateEventSource Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1061">A propriedade <see cref="P:System.Diagnostics.EventLog.Source" /> do <see cref="T:System.Diagnostics.EventLog" /> não foi definida.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1061">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="ce427-1062">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1062">-or-</span>
          </span>
          <span data-ttu-id="ce427-1063">O método tentou registrar uma nova fonte de evento, mas o nome do computador em <see cref="P:System.Diagnostics.EventLog.MachineName" /> não é válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1063">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="ce427-1064">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1064">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1065">A origem já está registrada para um log de eventos diferente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1065">The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="ce427-1066">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1066">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1067">A cadeia de caracteres da mensagem tem mais de 31.839 bytes (32.766 em sistemas operacionais Windows anteriores ao Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1067">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="ce427-1068">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1068">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1069">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1069">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-1070">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1070">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-1071">O sistema operacional relatou um erro ao gravar a entrada de evento no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1071">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="ce427-1072">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1072">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1073">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1073">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1074">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1074">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType -&gt; unit" Usage="eventLog.WriteEntry (message, type)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="ce427-1075">A cadeia de caracteres a ser gravada no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1075">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="ce427-1076">Um dos valores de <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1076">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1077">Grava uma entrada de erro, aviso, informação, auditoria de êxito ou auditoria de falha com o texto da mensagem fornecido no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1077">Writes an error, warning, information, success audit, or failure audit entry with the given message text to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1078">Use esse método para gravar uma entrada de um especificado <xref:System.Diagnostics.EventLogEntryType> ao log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1078">Use this method to write an entry of a specified <xref:System.Diagnostics.EventLogEntryType> to the event log.</span></span> <span data-ttu-id="ce427-1079">O `type` é indicado por um ícone e texto na coluna de tipo no Visualizador de eventos para um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-1079">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1080">O `message` cadeia de caracteres não pode conter %*n*, onde *n* é um valor de inteiro (por exemplo, %1), porque o Visualizador de eventos a trata como uma cadeia de caracteres de inserção.</span><span class="sxs-lookup"><span data-stu-id="ce427-1080">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="ce427-1081">Como um protocolo de Internet, a versão do endereço de 6 (IPv6) pode conter essa sequência de caracteres, você não pode registrar uma mensagem de evento que contém um endereço IPv6.</span><span class="sxs-lookup"><span data-stu-id="ce427-1081">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="ce427-1082">Você deve definir a <xref:System.Diagnostics.EventLog.Source%2A> propriedade em seu <xref:System.Diagnostics.EventLog> antes que você pode gravar entradas no log de componente.</span><span class="sxs-lookup"><span data-stu-id="ce427-1082">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="ce427-1083">Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1083">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="ce427-1084">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1084">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-1085">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-1085">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-1086">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-1086">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-1087">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1087">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-1088">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1088">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-1089">Se a fonte especificada na <xref:System.Diagnostics.EventLog.Source%2A> propriedade deste <xref:System.Diagnostics.EventLog> instância não está registrada no computador que o componente está gravando, <xref:System.Diagnostics.EventLog.WriteEntry%2A> chamadas <xref:System.Diagnostics.EventLog.CreateEventSource%2A> e registra o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1089">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1090">Se você não especificar uma <xref:System.Diagnostics.EventLog.MachineName%2A> para seu <xref:System.Diagnostics.EventLog> instância antes de chamar <xref:System.Diagnostics.EventLog.CreateEventSource%2A> ou <xref:System.Diagnostics.EventLog.WriteEntry%2A>, o computador local (".") é assumido.</span><span class="sxs-lookup"><span data-stu-id="ce427-1090">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="ce427-1091">Se o sistema precisa registrar o <xref:System.Diagnostics.EventLog.Source%2A> por meio de uma chamada para <xref:System.Diagnostics.EventLog.WriteEntry%2A> e o <xref:System.Diagnostics.EventLog.Log%2A> propriedade não foi definida no seu <xref:System.Diagnostics.EventLog> instância, o log padrão é o log de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1091">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1092">Muitas exceções listadas acima são geradas por erros gerados durante o processo de registro de <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1092">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="ce427-1093">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1093">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-1094">O <xref:System.Diagnostics.EventLog.WriteEntry%2A> método grava a cadeia de caracteres fornecida diretamente para o log de eventos; ele não usa um arquivo de recurso de mensagem localizável.</span><span class="sxs-lookup"><span data-stu-id="ce427-1094">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="ce427-1095">Use o <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar eventos usando um arquivo de recurso de mensagem localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1095">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="ce427-1096">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1096">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-1097">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1097">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-1098">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1098">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1099">Se você gravar uma entrada em um computador remoto, o valor da mensagem (a cadeia de caracteres de texto) não pode ser o esperado se o computador remoto não está em execução do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="ce427-1099">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1100">Se o `message` parâmetro contém um caractere de terminação nula, a mensagem no log de eventos é encerrada no caractere NUL.</span><span class="sxs-lookup"><span data-stu-id="ce427-1100">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-1101">O exemplo a seguir grava uma entrada de aviso para um log de eventos "MyNewLog" no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-1101">The following example writes a warning entry to an event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry2 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry2 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1102">A propriedade <see cref="P:System.Diagnostics.EventLog.Source" /> do <see cref="T:System.Diagnostics.EventLog" /> não foi definida.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1102">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="ce427-1103">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1103">-or-</span>
          </span>
          <span data-ttu-id="ce427-1104">O método tentou registrar uma nova fonte de evento, mas o nome do computador em <see cref="P:System.Diagnostics.EventLog.MachineName" /> não é válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1104">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="ce427-1105">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1105">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1106">A origem já está registrada para um log de eventos diferente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1106">The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="ce427-1107">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1107">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1108">A cadeia de caracteres da mensagem tem mais de 31.839 bytes (32.766 em sistemas operacionais Windows anteriores ao Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1108">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="ce427-1109">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1109">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1110">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1110">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="ce427-1111">
            <paramref name="type" /> não é um <see cref="T:System.Diagnostics.EventLogEntryType" /> válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1111">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-1112">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1112">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-1113">O sistema operacional relatou um erro ao gravar a entrada de evento no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1113">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="ce427-1114">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1114">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1115">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1115">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1116">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1116">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="ce427-1117">A origem pela qual o aplicativo está registrado no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1117">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="ce427-1118">A cadeia de caracteres a ser gravada no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1118">The string to write to the event log.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1119">Grava uma entrada de tipo de informação com o texto da mensagem especificado no log de eventos usando a origem do evento registrada especificada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1119">Writes an information type entry with the given message text to the event log, using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1120">Use esse método para gravar uma entrada de informações no log de eventos, usando uma fonte que já está registrada como uma origem de evento para o log adequado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1120">Use this method to write an information entry to the event log, using a source that is already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="ce427-1121">Se você quiser especificar qualquer outro <xref:System.Diagnostics.EventLogEntryType>, use uma sobrecarga diferente de <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1121">If you want to specify any other <xref:System.Diagnostics.EventLogEntryType>, use a different overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A>.</span></span>  
  
 <span data-ttu-id="ce427-1122">Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1122">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="ce427-1123">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1123">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-1124">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-1124">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-1125">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-1125">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-1126">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1126">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-1127">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1127">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-1128">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1128">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-1129">O <xref:System.Diagnostics.EventLog.WriteEntry%2A> método grava a cadeia de caracteres fornecida diretamente para o log de eventos; ele não usa um arquivo de recurso de mensagem localizável.</span><span class="sxs-lookup"><span data-stu-id="ce427-1129">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="ce427-1130">Use o <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar eventos usando um arquivo de recurso de mensagem localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1130">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="ce427-1131">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1131">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-1132">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1132">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-1133">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1133">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1134">Se o `message` parâmetro contém um caractere de terminação nula, a mensagem no log de eventos é encerrada no caractere NUL.</span><span class="sxs-lookup"><span data-stu-id="ce427-1134">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="ce427-1135">O `message` cadeia de caracteres não pode conter %*n*, onde *n* é um valor de inteiro (por exemplo, %1), porque o Visualizador de eventos a trata como uma cadeia de caracteres de inserção.</span><span class="sxs-lookup"><span data-stu-id="ce427-1135">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="ce427-1136">Como um protocolo de Internet, a versão do endereço de 6 (IPv6) pode conter essa sequência de caracteres, você não pode registrar uma mensagem de evento que contém um endereço IPv6.</span><span class="sxs-lookup"><span data-stu-id="ce427-1136">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-1137">O exemplo a seguir cria a fonte `MySource` se ele ainda não existir e grava uma entrada no log de eventos `MyNewLog`.</span><span class="sxs-lookup"><span data-stu-id="ce427-1137">The following example creates the source `MySource` if it does not already exist, and writes an entry to the event log `MyNewLog`.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry1 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry1 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1138">O valor <paramref name="source" /> é uma cadeia de caracteres vazia ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1138">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="ce427-1139">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1139">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1140">O valor <paramref name="source" /> é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1140">The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="ce427-1141">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1141">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1142">A cadeia de caracteres da mensagem tem mais de 31.839 bytes (32.766 em sistemas operacionais Windows anteriores ao Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1142">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="ce427-1143">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1143">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1144">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1144">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-1145">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1145">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-1146">O sistema operacional relatou um erro ao gravar a entrada de evento no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1146">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="ce427-1147">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1147">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1148">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1148">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1149">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1149">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="ce427-1150">A cadeia de caracteres a ser gravada no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1150">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="ce427-1151">Um dos valores de <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1151">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="ce427-1152">O identificador específico do aplicativo para o evento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1152">The application-specific identifier for the event.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1153">Grava no log de eventos uma entrada com o texto da mensagem especificado e o identificador de evento definido pelo aplicativo.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1153">Writes an entry with the given message text and application-defined event identifier to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1154">Use esse método para gravar uma entrada com um aplicativo definido `eventID` ao log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1154">Use this method to write an entry with an application-defined `eventID` to the event log.</span></span> <span data-ttu-id="ce427-1155">O `eventID` junto com a fonte de identificar exclusivamente um evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1155">The `eventID` together with the source uniquely identify an event.</span></span> <span data-ttu-id="ce427-1156">Cada aplicativo pode definir seus próprios eventos numerados e as cadeias de caracteres de descrição para o qual eles são mapeados.</span><span class="sxs-lookup"><span data-stu-id="ce427-1156">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="ce427-1157">Os visualizadores de eventos exibem esses valores de cadeia de caracteres para ajudar o usuário a entender o que deu errado e sugere ações a serem tomadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1157">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1158">O `message` cadeia de caracteres não pode conter %*n*, onde *n* é um valor de inteiro (por exemplo, %1), porque o Visualizador de eventos a trata como uma cadeia de caracteres de inserção.</span><span class="sxs-lookup"><span data-stu-id="ce427-1158">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="ce427-1159">Como um protocolo de Internet, a versão do endereço de 6 (IPv6) pode conter essa sequência de caracteres, você não pode registrar uma mensagem de evento que contém um endereço IPv6.</span><span class="sxs-lookup"><span data-stu-id="ce427-1159">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="ce427-1160">Além do identificador de evento, você pode especificar um <xref:System.Diagnostics.EventLogEntryType> para o evento que está sendo gravado no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1160">In addition to the event identifier, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="ce427-1161">O `type` é indicado por um ícone e texto na coluna de tipo no Visualizador de eventos para um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-1161">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="ce427-1162">Esse parâmetro indica se o tipo de evento é o erro, aviso, informação, auditoria de êxito ou auditoria de falha.</span><span class="sxs-lookup"><span data-stu-id="ce427-1162">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="ce427-1163">Você deve definir a <xref:System.Diagnostics.EventLog.Source%2A> propriedade em seu <xref:System.Diagnostics.EventLog> antes que você pode gravar entradas no log de componente.</span><span class="sxs-lookup"><span data-stu-id="ce427-1163">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="ce427-1164">Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1164">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="ce427-1165">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1165">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-1166">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-1166">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-1167">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-1167">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-1168">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1168">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-1169">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1169">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-1170">Se a fonte especificada na <xref:System.Diagnostics.EventLog.Source%2A> propriedade deste <xref:System.Diagnostics.EventLog> instância não está registrada no computador que o componente está gravando, <xref:System.Diagnostics.EventLog.WriteEntry%2A> chamadas <xref:System.Diagnostics.EventLog.CreateEventSource%2A> e registra o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1170">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1171">Se você não especificar uma <xref:System.Diagnostics.EventLog.MachineName%2A> para seu <xref:System.Diagnostics.EventLog> instância antes de chamar <xref:System.Diagnostics.EventLog.CreateEventSource%2A> ou <xref:System.Diagnostics.EventLog.WriteEntry%2A>, o computador local (".") é assumido.</span><span class="sxs-lookup"><span data-stu-id="ce427-1171">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="ce427-1172">Se o sistema precisa registrar o <xref:System.Diagnostics.EventLog.Source%2A> por meio de uma chamada para <xref:System.Diagnostics.EventLog.WriteEntry%2A> e o <xref:System.Diagnostics.EventLog.Log%2A> propriedade não foi definida no seu <xref:System.Diagnostics.EventLog> instância, o log padrão é o log de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1172">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1173">Muitas exceções listadas acima são geradas por erros gerados durante o processo de registro de <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1173">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="ce427-1174">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1174">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-1175">O <xref:System.Diagnostics.EventLog.WriteEntry%2A> método grava a cadeia de caracteres fornecida diretamente para o log de eventos; ele não usa um arquivo de recurso de mensagem localizável.</span><span class="sxs-lookup"><span data-stu-id="ce427-1175">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="ce427-1176">Use o <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar eventos usando um arquivo de recurso de mensagem localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1176">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="ce427-1177">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1177">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-1178">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1178">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-1179">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1179">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1180">Se você gravar uma entrada em um computador remoto, o valor da mensagem (a cadeia de caracteres de texto) não pode ser o esperado se o computador remoto não está em execução do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="ce427-1180">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1181">Se o `message` parâmetro contém um caractere de terminação nula, a mensagem no log de eventos é encerrada no caractere NUL.</span><span class="sxs-lookup"><span data-stu-id="ce427-1181">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#3)]
 [!code-csharp[EventLog_WriteEntry_1_3#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#3)]
 [!code-vb[EventLog_WriteEntry_1_3#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1182">A propriedade <see cref="P:System.Diagnostics.EventLog.Source" /> do <see cref="T:System.Diagnostics.EventLog" /> não foi definida.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1182">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="ce427-1183">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1183">-or-</span>
          </span>
          <span data-ttu-id="ce427-1184">O método tentou registrar uma nova fonte de evento, mas o nome do computador em <see cref="P:System.Diagnostics.EventLog.MachineName" /> não é válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1184">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="ce427-1185">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1185">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1186">A origem já está registrada para um log de eventos diferente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1186">The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="ce427-1187">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1187">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1188">
            <paramref name="eventID" /> é menor que zero ou maior que <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1188">
              <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="ce427-1189">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1189">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1190">A cadeia de caracteres da mensagem tem mais de 31.839 bytes (32.766 em sistemas operacionais Windows anteriores ao Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1190">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="ce427-1191">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1191">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1192">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1192">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-1193">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1193">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="ce427-1194">
            <paramref name="type" /> não é um <see cref="T:System.Diagnostics.EventLogEntryType" /> válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1194">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-1195">O sistema operacional relatou um erro ao gravar a entrada de evento no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1195">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="ce427-1196">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1196">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1197">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1197">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1198">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1198">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="ce427-1199">A origem pela qual o aplicativo está registrado no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1199">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="ce427-1200">A cadeia de caracteres a ser gravada no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1200">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="ce427-1201">Um dos valores de <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1201">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1202">Grava uma entrada de erro, aviso, informação, auditoria de êxito ou auditoria de falha com o texto da mensagem fornecido no log de eventos, usando a origem do evento registrado especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1202">Writes an error, warning, information, success audit, or failure audit entry with the given message text to the event log, using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1203">Use esse método para gravar uma entrada de um especificado <xref:System.Diagnostics.EventLogEntryType> ao log de eventos, usando uma fonte já registrado como uma origem de evento para o log adequado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1203">Use this method to write an entry of a specified <xref:System.Diagnostics.EventLogEntryType> to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="ce427-1204">O `type` é indicado por um ícone e texto na coluna de tipo no Visualizador de eventos para um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-1204">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1205">O `message` cadeia de caracteres não pode conter %*n*, onde *n* é um valor de inteiro (por exemplo, %1), porque o Visualizador de eventos a trata como uma cadeia de caracteres de inserção.</span><span class="sxs-lookup"><span data-stu-id="ce427-1205">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="ce427-1206">Como um protocolo de Internet, a versão do endereço de 6 (IPv6) pode conter essa sequência de caracteres, você não pode registrar uma mensagem de evento que contém um endereço IPv6.</span><span class="sxs-lookup"><span data-stu-id="ce427-1206">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="ce427-1207">Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1207">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="ce427-1208">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1208">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-1209">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-1209">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-1210">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-1210">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-1211">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1211">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-1212">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1212">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-1213">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1213">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-1214">O <xref:System.Diagnostics.EventLog.WriteEntry%2A> método grava a cadeia de caracteres fornecida diretamente para o log de eventos; ele não usa um arquivo de recurso de mensagem localizável.</span><span class="sxs-lookup"><span data-stu-id="ce427-1214">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="ce427-1215">Use o <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar eventos usando um arquivo de recurso de mensagem localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1215">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="ce427-1216">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1216">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-1217">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1217">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-1218">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1218">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1219">Se o `message` parâmetro contém um caractere de terminação nula, a mensagem no log de eventos é encerrada no caractere NUL.</span><span class="sxs-lookup"><span data-stu-id="ce427-1219">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-1220">O exemplo a seguir grava uma entrada de aviso para um log de eventos "MyNewLog" no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-1220">The following example writes a warning entry to an event log, "MyNewLog", on the local computer.</span></span>  
  
 [!code-cpp[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/CPP/source.cpp#1)]
 [!code-csharp[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/CS/source.cs#1)]
 [!code-vb[Classic EventLog.WriteEntry3 Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic EventLog.WriteEntry3 Example/VB/source.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1221">O valor <paramref name="source" /> é uma cadeia de caracteres vazia ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1221">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="ce427-1222">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1222">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1223">O valor <paramref name="source" /> é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1223">The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="ce427-1224">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1224">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1225">A cadeia de caracteres da mensagem tem mais de 31.839 bytes (32.766 em sistemas operacionais Windows anteriores ao Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1225">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="ce427-1226">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1226">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1227">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1227">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-1228">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1228">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="ce427-1229">
            <paramref name="type" /> não é um <see cref="T:System.Diagnostics.EventLogEntryType" /> válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1229">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-1230">O sistema operacional relatou um erro ao gravar a entrada de evento no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1230">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="ce427-1231">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1231">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1232">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1232">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1233">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1233">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16)" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer, category As Short)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int * int16 -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID, category)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="ce427-1234">A cadeia de caracteres a ser gravada no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1234">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="ce427-1235">Um dos valores de <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1235">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="ce427-1236">O identificador específico do aplicativo para o evento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1236">The application-specific identifier for the event.</span>
          </span>
        </param>
        <param name="category">
          <span data-ttu-id="ce427-1237">A subcategoria específica do aplicativo associada à mensagem.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1237">The application-specific subcategory associated with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1238">Grava uma entrada com o texto da mensagem especificado, o identificador de evento definido pelo aplicativo e a categoria definida pelo aplicativo no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1238">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1239">Use esse método para gravar uma entrada com um aplicativo definido `category` ao log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1239">Use this method to write an entry with an application-defined `category` to the event log.</span></span> <span data-ttu-id="ce427-1240">O Visualizador de eventos usa a categoria para filtrar eventos gravados por uma origem do evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1240">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="ce427-1241">O Visualizador de eventos pode exibir a categoria como um valor numérico, ou ele pode usar a categoria como um identificador de recurso para exibir uma cadeia de caracteres da categoria localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1241">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1242">O `category` parâmetro deve ser um valor positivo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1242">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="ce427-1243">Valores negativos de categorias aparecem como um número positivo complementar no Visualizador de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1243">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="ce427-1244">Por exemplo, um – 10 aparece como 65,526, – 1 como 65.535.</span><span class="sxs-lookup"><span data-stu-id="ce427-1244">For example, a –10 appears as 65,526, a –1 as 65,535.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1245">O `message` cadeia de caracteres não pode conter %*n*, onde *n* é um valor de inteiro (por exemplo, %1), porque o Visualizador de eventos a trata como uma cadeia de caracteres de inserção.</span><span class="sxs-lookup"><span data-stu-id="ce427-1245">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="ce427-1246">Como um protocolo de Internet, a versão do endereço de 6 (IPv6) pode conter essa sequência de caracteres, você não pode registrar uma mensagem de evento que contém um endereço IPv6.</span><span class="sxs-lookup"><span data-stu-id="ce427-1246">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="ce427-1247">Para exibir cadeias de caracteres da categoria localizada no Visualizador de eventos, você deve usar uma fonte de evento configurado com um arquivo de recurso da categoria e defina o `category` para um identificador de recurso no arquivo de recurso da categoria.</span><span class="sxs-lookup"><span data-stu-id="ce427-1247">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="ce427-1248">Se a origem do evento não tem um arquivo de recurso da categoria configurado ou especificado `category` não indexa uma cadeia de caracteres no arquivo de recurso da categoria, em seguida, o Visualizador de eventos exibe o valor da categoria numérica para a entrada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1248">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="ce427-1249">Configurar o arquivo de recurso da categoria, juntamente com o número de cadeias de caracteres de categoria no arquivo de recurso, usando o <xref:System.Diagnostics.EventLogInstaller> ou o <xref:System.Diagnostics.EventSourceCreationData> classe.</span><span class="sxs-lookup"><span data-stu-id="ce427-1249">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="ce427-1250">Além da categoria, você pode especificar um identificador de evento para o evento que está sendo gravado no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1250">In addition to the category, you can specify an event identifier for the event being written to the event log.</span></span> <span data-ttu-id="ce427-1251">Identificadores de eventos, juntamente com a origem do evento, identificam exclusivamente um evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1251">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="ce427-1252">Cada aplicativo pode definir seus próprios eventos numerados e as cadeias de caracteres de descrição para o qual eles são mapeados.</span><span class="sxs-lookup"><span data-stu-id="ce427-1252">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="ce427-1253">Os visualizadores de eventos exibem esses valores de cadeia de caracteres para ajudar o usuário a entender o que deu errado e sugere ações a serem tomadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1253">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="ce427-1254">Por fim, você pode especificar um <xref:System.Diagnostics.EventLogEntryType> para o evento que está sendo gravado no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1254">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="ce427-1255">O `type` é indicado por um ícone e texto na coluna de tipo no Visualizador de eventos para um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-1255">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="ce427-1256">Esse parâmetro indica se o tipo de evento é o erro, aviso, informação, auditoria de êxito ou auditoria de falha.</span><span class="sxs-lookup"><span data-stu-id="ce427-1256">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="ce427-1257">Você deve definir a <xref:System.Diagnostics.EventLog.Source%2A> propriedade em seu <xref:System.Diagnostics.EventLog> antes que você pode gravar entradas no log de componente.</span><span class="sxs-lookup"><span data-stu-id="ce427-1257">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="ce427-1258">Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1258">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="ce427-1259">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1259">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-1260">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-1260">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-1261">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-1261">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-1262">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1262">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-1263">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1263">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-1264">Se a fonte especificada na <xref:System.Diagnostics.EventLog.Source%2A> propriedade deste <xref:System.Diagnostics.EventLog> instância não está registrada no computador que o componente está gravando, <xref:System.Diagnostics.EventLog.WriteEntry%2A> chamadas <xref:System.Diagnostics.EventLog.CreateEventSource%2A> e registra o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1264">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1265">Se você não especificar uma <xref:System.Diagnostics.EventLog.MachineName%2A> para seu <xref:System.Diagnostics.EventLog> instância antes de chamar <xref:System.Diagnostics.EventLog.CreateEventSource%2A> ou <xref:System.Diagnostics.EventLog.WriteEntry%2A>, o computador local (".") é assumido.</span><span class="sxs-lookup"><span data-stu-id="ce427-1265">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="ce427-1266">Se o sistema precisa registrar o <xref:System.Diagnostics.EventLog.Source%2A> por meio de uma chamada para <xref:System.Diagnostics.EventLog.WriteEntry%2A> e o <xref:System.Diagnostics.EventLog.Log%2A> propriedade não foi definida no seu <xref:System.Diagnostics.EventLog> instância, o log padrão é o log de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1266">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1267">Muitas exceções listadas acima são geradas por erros gerados durante o processo de registro de <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1267">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="ce427-1268">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1268">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-1269">O <xref:System.Diagnostics.EventLog.WriteEntry%2A> método grava a cadeia de caracteres fornecida diretamente para o log de eventos; ele não usa um arquivo de recurso de mensagem localizável.</span><span class="sxs-lookup"><span data-stu-id="ce427-1269">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="ce427-1270">Use o <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar eventos usando um arquivo de recurso de mensagem localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1270">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="ce427-1271">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1271">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-1272">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1272">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-1273">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1273">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1274">Se você gravar uma entrada em um computador remoto, o valor da mensagem (a cadeia de caracteres de texto) não pode ser o esperado se o computador remoto não está em execução do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="ce427-1274">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1275">Se o `message` parâmetro contém um caractere de terminação nula, a mensagem no log de eventos é encerrada no caractere NUL.</span><span class="sxs-lookup"><span data-stu-id="ce427-1275">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#3](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#3)]
 [!code-csharp[EventLog_WriteEntry_1_3#3](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#3)]
 [!code-vb[EventLog_WriteEntry_1_3#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#3)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1276">A propriedade <see cref="P:System.Diagnostics.EventLog.Source" /> do <see cref="T:System.Diagnostics.EventLog" /> não foi definida.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1276">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="ce427-1277">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1277">-or-</span>
          </span>
          <span data-ttu-id="ce427-1278">O método tentou registrar uma nova fonte de evento, mas o nome do computador em <see cref="P:System.Diagnostics.EventLog.MachineName" /> não é válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1278">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="ce427-1279">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1279">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1280">A origem já está registrada para um log de eventos diferente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1280">The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="ce427-1281">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1281">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1282">
            <paramref name="eventID" /> é menor que zero ou maior que <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1282">
              <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="ce427-1283">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1283">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1284">A cadeia de caracteres da mensagem tem mais de 31.839 bytes (32.766 em sistemas operacionais Windows anteriores ao Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1284">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="ce427-1285">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1285">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1286">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1286">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-1287">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1287">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="ce427-1288">
            <paramref name="type" /> não é um <see cref="T:System.Diagnostics.EventLogEntryType" /> válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1288">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-1289">O sistema operacional relatou um erro ao gravar a entrada de evento no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1289">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="ce427-1290">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1290">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1291">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1291">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1292">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1292">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="ce427-1293">A origem pela qual o aplicativo está registrado no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1293">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="ce427-1294">A cadeia de caracteres a ser gravada no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1294">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="ce427-1295">Um dos valores de <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1295">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="ce427-1296">O identificador específico do aplicativo para o evento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1296">The application-specific identifier for the event.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1297">Grava uma entrada com o texto da mensagem especificado e o identificador de evento definido pelo aplicativo no log de eventos, usando a fonte de evento registrada especificada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1297">Writes an entry with the given message text and application-defined event identifier to the event log, using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1298">Use esse método para gravar uma entrada com um aplicativo definido `eventID` ao log de eventos, usando uma fonte já registrado como uma origem de evento para o log adequado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1298">Use this method to write an entry with an application-defined `eventID` to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="ce427-1299">O `eventID`, juntamente com o código-fonte, identificar exclusivamente um evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1299">The `eventID`, along with the source, uniquely identify an event.</span></span> <span data-ttu-id="ce427-1300">Cada aplicativo pode definir seus próprios eventos numerados e as cadeias de caracteres de descrição para o qual eles são mapeados.</span><span class="sxs-lookup"><span data-stu-id="ce427-1300">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="ce427-1301">Visualizadores de eventos apresentam essas cadeias de caracteres para o usuário para ajudar o usuário a entender o que deu errado e sugere ações a serem tomadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1301">Event viewers present these strings to the user to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1302">O `message` cadeia de caracteres não pode conter %*n*, onde *n* é um valor de inteiro (por exemplo, %1), porque o Visualizador de eventos a trata como uma cadeia de caracteres de inserção.</span><span class="sxs-lookup"><span data-stu-id="ce427-1302">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="ce427-1303">Como um protocolo de Internet, a versão do endereço de 6 (IPv6) pode conter essa sequência de caracteres, você não pode registrar uma mensagem de evento que contém um endereço IPv6.</span><span class="sxs-lookup"><span data-stu-id="ce427-1303">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
 <span data-ttu-id="ce427-1304">Além do identificador de evento, essa sobrecarga de <xref:System.Diagnostics.EventLog.WriteEntry%2A> permite que você especifique um <xref:System.Diagnostics.EventLogEntryType> para o evento que está sendo gravado no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1304">In addition to the event identifier, this overload of <xref:System.Diagnostics.EventLog.WriteEntry%2A> lets you specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="ce427-1305">O `type` é indicado por um ícone e texto na coluna de tipo no Visualizador de eventos para um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-1305">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="ce427-1306">Esse parâmetro indica se o tipo de evento é o erro, aviso, informação, auditoria de êxito ou auditoria de falha.</span><span class="sxs-lookup"><span data-stu-id="ce427-1306">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="ce427-1307">Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1307">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="ce427-1308">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1308">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-1309">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-1309">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-1310">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-1310">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-1311">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1311">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-1312">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1312">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-1313">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1313">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-1314">O <xref:System.Diagnostics.EventLog.WriteEntry%2A> método grava a cadeia de caracteres fornecida diretamente para o log de eventos; ele não usa um arquivo de recurso de mensagem localizável.</span><span class="sxs-lookup"><span data-stu-id="ce427-1314">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="ce427-1315">Use o <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar eventos usando um arquivo de recurso de mensagem localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1315">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="ce427-1316">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1316">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-1317">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1317">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-1318">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1318">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1319">Se o `message` parâmetro contém um caractere de terminação nula, a mensagem no log de eventos é encerrada no caractere NUL.</span><span class="sxs-lookup"><span data-stu-id="ce427-1319">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_4#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_4/CPP/eventlog_writeentry_4.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_4#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_4/CS/eventlog_writeentry_4.cs#1)]
 [!code-vb[EventLog_WriteEntry_4#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_4/VB/eventlog_writeentry_4.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1320">O valor <paramref name="source" /> é uma cadeia de caracteres vazia ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1320">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="ce427-1321">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1321">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1322">O valor <paramref name="source" /> é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1322">The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="ce427-1323">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1323">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1324">
            <paramref name="eventID" /> é menor que zero ou maior que <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1324">
              <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="ce427-1325">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1325">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1326">A cadeia de caracteres da mensagem tem mais de 31.839 bytes (32.766 em sistemas operacionais Windows anteriores ao Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1326">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="ce427-1327">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1327">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1328">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1328">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-1329">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1329">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="ce427-1330">
            <paramref name="type" /> não é um <see cref="T:System.Diagnostics.EventLogEntryType" /> válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1330">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-1331">O sistema operacional relatou um erro ao gravar a entrada de evento no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1331">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="ce427-1332">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1332">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1333">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1333">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1334">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1334">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public void WriteEntry (string message, System.Diagnostics.EventLogEntryType type, int eventID, short category, byte[] rawData);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEntry(string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category, unsigned int8[] rawData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16,System.Byte[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEntry (message As String, type As EventLogEntryType, eventID As Integer, category As Short, rawData As Byte())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEntry(System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category, cli::array &lt;System::Byte&gt; ^ rawData);" />
      <MemberSignature Language="F#" Value="member this.WriteEntry : string * System.Diagnostics.EventLogEntryType * int * int16 * byte[] -&gt; unit" Usage="eventLog.WriteEntry (message, type, eventID, category, rawData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
        <Parameter Name="rawData" Type="System.Byte[]" />
      </Parameters>
      <Docs>
        <param name="message">
          <span data-ttu-id="ce427-1335">A cadeia de caracteres a ser gravada no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1335">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="ce427-1336">Um dos valores de <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1336">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="ce427-1337">O identificador específico do aplicativo para o evento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1337">The application-specific identifier for the event.</span>
          </span>
        </param>
        <param name="category">
          <span data-ttu-id="ce427-1338">A subcategoria específica do aplicativo associada à mensagem.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1338">The application-specific subcategory associated with the message.</span>
          </span>
        </param>
        <param name="rawData">
          <span data-ttu-id="ce427-1339">Uma matriz de bytes que contém os dados binários associados à entrada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1339">An array of bytes that holds the binary data associated with the entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1340">Grava uma entrada com o texto da mensagem fornecido, o identificador de eventos definido pelo aplicativo e a categoria definida por aplicativo no log de eventos e anexa dados binários à mensagem.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1340">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log, and appends binary data to the message.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1341">Use essa sobrecarga para gravar dados de eventos específicos definidos pelo aplicativo no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1341">Use this overload to write application-defined event-specific data to the event log.</span></span> <span data-ttu-id="ce427-1342">O Visualizador de eventos não interpretar esses dados; ele exibe os dados brutos somente em um formato hexadecimal e textual combinado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1342">The Event Viewer does not interpret this data; it displays raw data only in a combined hexadecimal and text format.</span></span> <span data-ttu-id="ce427-1343">Use dados de eventos específicos com moderação, incluí-lo somente se você tiver certeza será útil para alguém depurar o problema.</span><span class="sxs-lookup"><span data-stu-id="ce427-1343">Use event-specific data sparingly, including it only if you are sure it will be useful to someone debugging the problem.</span></span> <span data-ttu-id="ce427-1344">Você também pode usar dados de eventos específicos para armazenar informações que o aplicativo pode processar independentemente do Visualizador de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1344">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="ce427-1345">Por exemplo, você poderia escrever um visualizador especificamente para seus eventos ou escrever um programa que examina o arquivo de log e cria relatórios que incluem informações sobre os dados específicos do evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1345">For example, you could write a viewer specifically for your events, or write a program that scans the logfile and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="ce427-1346">Além dos dados binários, você pode especificar uma categoria definida pelo aplicativo e um identificador de evento definido pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1346">In addition to the binary data, you can specify an application-defined category and an application-defined event identifier.</span></span> <span data-ttu-id="ce427-1347">O Visualizador de eventos usa a categoria para filtrar eventos gravados por uma origem do evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1347">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="ce427-1348">O Visualizador de eventos pode exibir a categoria como um valor numérico, ou ele pode usar a categoria como um identificador de recurso para exibir uma cadeia de caracteres da categoria localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1348">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1349">O `message` cadeia de caracteres não pode conter %*n*, onde *n* é um valor de inteiro (por exemplo, %1), porque o Visualizador de eventos a trata como uma cadeia de caracteres de inserção.</span><span class="sxs-lookup"><span data-stu-id="ce427-1349">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="ce427-1350">Como um protocolo de Internet, a versão do endereço de 6 (IPv6) pode conter essa sequência de caracteres, você não pode registrar uma mensagem de evento que contém um endereço IPv6.</span><span class="sxs-lookup"><span data-stu-id="ce427-1350">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1351">O `category` parâmetro deve ser um valor positivo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1351">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="ce427-1352">Valores negativos de categorias aparecem como um número positivo complementar no Visualizador de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1352">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="ce427-1353">Por exemplo, um – 10 aparece como 65,526, – 1 como 65.535.</span><span class="sxs-lookup"><span data-stu-id="ce427-1353">For example, a –10 appears as 65,526, a –1 as 65,535.</span></span>  
  
 <span data-ttu-id="ce427-1354">Para exibir cadeias de caracteres da categoria localizada no Visualizador de eventos, você deve usar uma fonte de evento configurado com um arquivo de recurso da categoria e defina o `category` para um identificador de recurso no arquivo de recurso da categoria.</span><span class="sxs-lookup"><span data-stu-id="ce427-1354">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="ce427-1355">Se a origem do evento não tem um arquivo de recurso da categoria configurado ou especificado `category` não indexa uma cadeia de caracteres no arquivo de recurso da categoria, em seguida, o Visualizador de eventos exibe o valor da categoria numérica para a entrada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1355">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="ce427-1356">Configurar o arquivo de recurso da categoria, juntamente com o número de cadeias de caracteres de categoria no arquivo de recurso, usando o <xref:System.Diagnostics.EventLogInstaller> ou o <xref:System.Diagnostics.EventSourceCreationData> classe.</span><span class="sxs-lookup"><span data-stu-id="ce427-1356">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="ce427-1357">Identificadores de eventos, juntamente com a origem do evento, identificam exclusivamente um evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1357">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="ce427-1358">Cada aplicativo pode definir seus próprios eventos numerados e as cadeias de caracteres de descrição para o qual eles são mapeados.</span><span class="sxs-lookup"><span data-stu-id="ce427-1358">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="ce427-1359">Os visualizadores de eventos exibem esses valores de cadeia de caracteres para ajudar o usuário a entender o que deu errado e sugere ações a serem tomadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1359">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="ce427-1360">Por fim, você pode especificar um <xref:System.Diagnostics.EventLogEntryType> para o evento que está sendo gravado no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1360">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="ce427-1361">O `type` é indicado por um ícone e texto na coluna de tipo no Visualizador de eventos para um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-1361">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="ce427-1362">Esse parâmetro indica se o tipo de evento é o erro, aviso, informação, auditoria de êxito ou auditoria de falha.</span><span class="sxs-lookup"><span data-stu-id="ce427-1362">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="ce427-1363">Você deve definir a <xref:System.Diagnostics.EventLog.Source%2A> propriedade em seu <xref:System.Diagnostics.EventLog> antes que você pode gravar entradas no log de componente.</span><span class="sxs-lookup"><span data-stu-id="ce427-1363">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before you can write entries to the log.</span></span> <span data-ttu-id="ce427-1364">Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1364">You must create and configure the event source before writing the first entry with the source.</span></span>  
  
 <span data-ttu-id="ce427-1365">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1365">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-1366">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-1366">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-1367">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-1367">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-1368">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1368">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-1369">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1369">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-1370">Se a fonte especificada na <xref:System.Diagnostics.EventLog.Source%2A> propriedade deste <xref:System.Diagnostics.EventLog> instância não está registrada no computador que o componente está gravando, <xref:System.Diagnostics.EventLog.WriteEntry%2A> chamadas <xref:System.Diagnostics.EventLog.CreateEventSource%2A> e registra o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1370">If the source specified in the <xref:System.Diagnostics.EventLog.Source%2A> property of this <xref:System.Diagnostics.EventLog> instance is not registered on the computer that your component is writing to, <xref:System.Diagnostics.EventLog.WriteEntry%2A> calls <xref:System.Diagnostics.EventLog.CreateEventSource%2A> and registers the source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1371">Se você não especificar uma <xref:System.Diagnostics.EventLog.MachineName%2A> para seu <xref:System.Diagnostics.EventLog> instância antes de chamar <xref:System.Diagnostics.EventLog.CreateEventSource%2A> ou <xref:System.Diagnostics.EventLog.WriteEntry%2A>, o computador local (".") é assumido.</span><span class="sxs-lookup"><span data-stu-id="ce427-1371">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.CreateEventSource%2A> or <xref:System.Diagnostics.EventLog.WriteEntry%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="ce427-1372">Se o sistema precisa registrar o <xref:System.Diagnostics.EventLog.Source%2A> por meio de uma chamada para <xref:System.Diagnostics.EventLog.WriteEntry%2A> e o <xref:System.Diagnostics.EventLog.Log%2A> propriedade não foi definida no seu <xref:System.Diagnostics.EventLog> instância, o log padrão é o log de aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1372">If the system needs to register the <xref:System.Diagnostics.EventLog.Source%2A> through a call to <xref:System.Diagnostics.EventLog.WriteEntry%2A> and the <xref:System.Diagnostics.EventLog.Log%2A> property has not been set on your <xref:System.Diagnostics.EventLog> instance, the log defaults to the Application log.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1373">Muitas exceções listadas acima são geradas por erros gerados durante o processo de registro de <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1373">Many exceptions listed above are generated by errors raised during the process of registering the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span>  
  
 <span data-ttu-id="ce427-1374">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1374">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-1375">O <xref:System.Diagnostics.EventLog.WriteEntry%2A> método grava a cadeia de caracteres fornecida diretamente para o log de eventos; ele não usa um arquivo de recurso de mensagem localizável.</span><span class="sxs-lookup"><span data-stu-id="ce427-1375">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="ce427-1376">Use o <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar eventos usando um arquivo de recurso de mensagem localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1376">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="ce427-1377">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1377">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-1378">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1378">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-1379">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1379">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1380">Se você gravar uma entrada em um computador remoto, o valor da mensagem (a cadeia de caracteres de texto) não pode ser o esperado se o computador remoto não está em execução do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="ce427-1380">If you write an entry to a remote computer, the value of the message (the text string) might not be what you expect if the remote computer is not running the .NET Framework.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1381">Se o `message` parâmetro contém um caractere de terminação nula, a mensagem no log de eventos é encerrada no caractere NUL.</span><span class="sxs-lookup"><span data-stu-id="ce427-1381">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_5#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_5/CPP/eventlog_writeentry_5.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_5#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_5/CS/eventlog_writeentry_5.cs#1)]
 [!code-vb[EventLog_WriteEntry_5#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_5/VB/eventlog_writeentry_5.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1382">A propriedade <see cref="P:System.Diagnostics.EventLog.Source" /> do <see cref="T:System.Diagnostics.EventLog" /> não foi definida.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1382">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="ce427-1383">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1383">-or-</span>
          </span>
          <span data-ttu-id="ce427-1384">O método tentou registrar uma nova fonte de evento, mas o nome do computador em <see cref="P:System.Diagnostics.EventLog.MachineName" /> não é válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1384">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="ce427-1385">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1385">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1386">A origem já está registrada para um log de eventos diferente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1386">The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="ce427-1387">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1387">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1388">
            <paramref name="eventID" /> é menor que zero ou maior que <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1388">
              <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="ce427-1389">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1389">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1390">A cadeia de caracteres da mensagem tem mais de 31.839 bytes (32.766 em sistemas operacionais Windows anteriores ao Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1390">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="ce427-1391">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1391">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1392">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1392">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-1393">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1393">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="ce427-1394">
            <paramref name="type" /> não é um <see cref="T:System.Diagnostics.EventLogEntryType" /> válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1394">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-1395">O sistema operacional relatou um erro ao gravar a entrada de evento no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1395">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="ce427-1396">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1396">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1397">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1397">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1398">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1398">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16)" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer, category As Short)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int * int16 -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID, category)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="ce427-1399">A origem pela qual o aplicativo está registrado no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1399">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="ce427-1400">A cadeia de caracteres a ser gravada no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1400">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="ce427-1401">Um dos valores de <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1401">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="ce427-1402">O identificador específico do aplicativo para o evento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1402">The application-specific identifier for the event.</span>
          </span>
        </param>
        <param name="category">
          <span data-ttu-id="ce427-1403">A subcategoria específica do aplicativo associada à mensagem.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1403">The application-specific subcategory associated with the message.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1404">Grava uma entrada com o texto da mensagem fornecido, o identificador de evento definido pelo aplicativo e a categoria definida pelo aplicativo no log de eventos, usando a fonte de evento registrada especificada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1404">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log, using the specified registered event source.</span>
          </span>
          <span data-ttu-id="ce427-1405">O <paramref name="category" /> pode ser usado pelo Visualizador de Eventos para filtrar eventos no log.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1405">The <paramref name="category" /> can be used by the Event Viewer to filter events in the log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1406">Use esse método para gravar uma entrada com um aplicativo definido `category` ao log de eventos, usando uma fonte que já está registrada como uma origem de evento para o log adequado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1406">Use this method to write an entry with an application-defined `category` to the event log, using a source that is already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="ce427-1407">O Visualizador de eventos usa a categoria para filtrar eventos gravados por uma origem do evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1407">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="ce427-1408">O Visualizador de eventos pode exibir a categoria como um valor numérico, ou ele pode usar a categoria como um identificador de recurso para exibir uma cadeia de caracteres da categoria localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1408">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1409">O `category` parâmetro deve ser um valor positivo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1409">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="ce427-1410">Valores negativos de categorias aparecem como um número positivo complementar no Visualizador de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1410">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="ce427-1411">Por exemplo, um – 10 aparece como 65,526, – 1 como 65.535.</span><span class="sxs-lookup"><span data-stu-id="ce427-1411">For example, a –10 appears as 65,526, a –1 as 65,535.</span></span>  
  
 <span data-ttu-id="ce427-1412">Para exibir cadeias de caracteres da categoria localizada no Visualizador de eventos, você deve usar uma fonte de evento configurado com um arquivo de recurso da categoria e defina o `category` para um identificador de recurso no arquivo de recurso da categoria.</span><span class="sxs-lookup"><span data-stu-id="ce427-1412">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="ce427-1413">Se a origem do evento não tem um arquivo de recurso da categoria configurado ou especificado `category` não indexa uma cadeia de caracteres no arquivo de recurso da categoria, em seguida, o Visualizador de eventos exibe o valor da categoria numérica para a entrada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1413">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="ce427-1414">Configurar o arquivo de recurso da categoria, juntamente com o número de cadeias de caracteres de categoria no arquivo de recurso, usando o <xref:System.Diagnostics.EventLogInstaller> ou o <xref:System.Diagnostics.EventSourceCreationData> classe.</span><span class="sxs-lookup"><span data-stu-id="ce427-1414">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="ce427-1415">Além da categoria, você pode especificar um identificador de evento para o evento que está sendo gravado no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1415">In addition to the category, you can specify an event identifier for the event being written to the event log.</span></span> <span data-ttu-id="ce427-1416">Identificadores de eventos, juntamente com a origem do evento, identificam exclusivamente um evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1416">Event identifiers, along with the event source, uniquely identify an event.</span></span> <span data-ttu-id="ce427-1417">Cada aplicativo pode definir seus próprios eventos numerados e as cadeias de caracteres de descrição para o qual eles são mapeados.</span><span class="sxs-lookup"><span data-stu-id="ce427-1417">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="ce427-1418">Os visualizadores de eventos exibem esses valores de cadeia de caracteres para ajudar o usuário a entender o que deu errado e sugere ações a serem tomadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1418">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="ce427-1419">Por fim, você pode especificar um <xref:System.Diagnostics.EventLogEntryType> para o evento que está sendo gravado no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1419">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="ce427-1420">O `type` é indicado por um ícone e texto na coluna de tipo no Visualizador de eventos para um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-1420">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="ce427-1421">Esse parâmetro indica se o tipo de evento é o erro, aviso, informação, auditoria de êxito ou auditoria de falha.</span><span class="sxs-lookup"><span data-stu-id="ce427-1421">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="ce427-1422">Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1422">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="ce427-1423">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1423">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-1424">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-1424">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-1425">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-1425">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-1426">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1426">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-1427">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1427">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-1428">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1428">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-1429">O <xref:System.Diagnostics.EventLog.WriteEntry%2A> método grava a cadeia de caracteres fornecida diretamente para o log de eventos; ele não usa um arquivo de recurso de mensagem localizável.</span><span class="sxs-lookup"><span data-stu-id="ce427-1429">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="ce427-1430">Use o <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar eventos usando um arquivo de recurso de mensagem localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1430">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="ce427-1431">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1431">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-1432">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1432">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-1433">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1433">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1434">Se o `message` parâmetro contém um caractere de terminação nula, a mensagem no log de eventos é encerrada no caractere NUL.</span><span class="sxs-lookup"><span data-stu-id="ce427-1434">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="ce427-1435">O `message` cadeia de caracteres não pode conter %*n*, onde *n* é um valor de inteiro (por exemplo, %1), porque o Visualizador de eventos a trata como uma cadeia de caracteres de inserção.</span><span class="sxs-lookup"><span data-stu-id="ce427-1435">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="ce427-1436">Como um protocolo de Internet, a versão do endereço de 6 (IPv6) pode conter essa sequência de caracteres, você não pode registrar uma mensagem de evento que contém um endereço IPv6.</span><span class="sxs-lookup"><span data-stu-id="ce427-1436">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#1](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#1)]
 [!code-csharp[EventLog_WriteEntry_1_3#1](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#1)]
 [!code-vb[EventLog_WriteEntry_1_3#1](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#1)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1437">O valor <paramref name="source" /> é uma cadeia de caracteres vazia ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1437">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="ce427-1438">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1438">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1439">O valor <paramref name="source" /> é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1439">The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="ce427-1440">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1440">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1441">
            <paramref name="eventID" /> é menor que zero ou maior que <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1441">
              <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="ce427-1442">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1442">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1443">A cadeia de caracteres da mensagem tem mais de 31.839 bytes (32.766 em sistemas operacionais Windows anteriores ao Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1443">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="ce427-1444">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1444">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1445">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1445">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-1446">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1446">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="ce427-1447">
            <paramref name="type" /> não é um <see cref="T:System.Diagnostics.EventLogEntryType" /> válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1447">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-1448">O sistema operacional relatou um erro ao gravar a entrada de evento no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1448">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="ce427-1449">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1449">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1450">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1450">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1451">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1451">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <Member MemberName="WriteEntry">
      <MemberSignature Language="C#" Value="public static void WriteEntry (string source, string message, System.Diagnostics.EventLogEntryType type, int eventID, short category, byte[] rawData);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEntry(string source, string message, valuetype System.Diagnostics.EventLogEntryType type, int32 eventID, int16 category, unsigned int8[] rawData) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEntry(System.String,System.String,System.Diagnostics.EventLogEntryType,System.Int32,System.Int16,System.Byte[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEntry (source As String, message As String, type As EventLogEntryType, eventID As Integer, category As Short, rawData As Byte())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEntry(System::String ^ source, System::String ^ message, System::Diagnostics::EventLogEntryType type, int eventID, short category, cli::array &lt;System::Byte&gt; ^ rawData);" />
      <MemberSignature Language="F#" Value="static member WriteEntry : string * string * System.Diagnostics.EventLogEntryType * int * int16 * byte[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEntry (source, message, type, eventID, category, rawData)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>1.0.5000.0</AssemblyVersion>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="message" Type="System.String" />
        <Parameter Name="type" Type="System.Diagnostics.EventLogEntryType" />
        <Parameter Name="eventID" Type="System.Int32" />
        <Parameter Name="category" Type="System.Int16" />
        <Parameter Name="rawData" Type="System.Byte[]" />
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="ce427-1452">A origem pela qual o aplicativo está registrado no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1452">The source by which the application is registered on the specified computer.</span>
          </span>
        </param>
        <param name="message">
          <span data-ttu-id="ce427-1453">A cadeia de caracteres a ser gravada no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1453">The string to write to the event log.</span>
          </span>
        </param>
        <param name="type">
          <span data-ttu-id="ce427-1454">Um dos valores de <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1454">One of the <see cref="T:System.Diagnostics.EventLogEntryType" /> values.</span>
          </span>
        </param>
        <param name="eventID">
          <span data-ttu-id="ce427-1455">O identificador específico do aplicativo para o evento.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1455">The application-specific identifier for the event.</span>
          </span>
        </param>
        <param name="category">
          <span data-ttu-id="ce427-1456">A subcategoria específica do aplicativo associada à mensagem.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1456">The application-specific subcategory associated with the message.</span>
          </span>
        </param>
        <param name="rawData">
          <span data-ttu-id="ce427-1457">Uma matriz de bytes que contém os dados binários associados à entrada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1457">An array of bytes that holds the binary data associated with the entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1458">Grava uma entrada com o texto da mensagem fornecido, o identificador de eventos definido pelo aplicativo e a categoria definida por aplicativo no log de eventos (usando a fonte de evento registrada especificada) e anexa dados binários à mensagem.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1458">Writes an entry with the given message text, application-defined event identifier, and application-defined category to the event log (using the specified registered event source) and appends binary data to the message.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1459">Use esse método para gravar dados de eventos específicos definidos pelo aplicativo no log de eventos, usando uma fonte já registrada como uma origem de evento para o log adequado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1459">Use this method to write application-defined event-specific data to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="ce427-1460">O Visualizador de eventos não interpretar esses dados; ele exibe os dados brutos somente em um formato hexadecimal e textual combinado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1460">The Event Viewer does not interpret this data; it displays raw data only in a combined hexadecimal and text format.</span></span> <span data-ttu-id="ce427-1461">Use dados de eventos específicos com moderação; incluí-lo somente se você tiver certeza será útil.</span><span class="sxs-lookup"><span data-stu-id="ce427-1461">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="ce427-1462">Você também pode usar dados de eventos específicos para armazenar informações que o aplicativo pode processar independentemente do Visualizador de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1462">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="ce427-1463">Por exemplo, você poderia escrever um visualizador especificamente para seus eventos ou escrever um programa que examina o arquivo de log e cria relatórios que incluem informações sobre os dados específicos do evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1463">For example, you could write a viewer specifically for your events, or write a program that scans the logfile and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="ce427-1464">Além dos dados binários, você pode especificar uma categoria definida pelo aplicativo e um identificador de evento definido pelo aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1464">In addition to the binary data, you can specify an application-defined category and an application-defined event identifier.</span></span> <span data-ttu-id="ce427-1465">O Visualizador de eventos usa a categoria para filtrar eventos gravados por uma origem do evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1465">The Event Viewer uses the category to filter events written by an event source.</span></span> <span data-ttu-id="ce427-1466">O Visualizador de eventos pode exibir a categoria como um valor numérico, ou ele pode usar a categoria como um identificador de recurso para exibir uma cadeia de caracteres da categoria localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1466">The Event Viewer can display the category as a numeric value, or it can use the category as a resource identifier to display a localized category string.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1467">O `category` parâmetro deve ser um valor positivo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1467">The `category` parameter should be a positive value.</span></span> <span data-ttu-id="ce427-1468">Valores negativos de categorias aparecem como um número positivo complementar no Visualizador de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1468">Negative category values appear as a complementary positive number in the Event Viewer.</span></span> <span data-ttu-id="ce427-1469">Por exemplo, um – 10 será exibido como 65,526, – 1 como 65.535.</span><span class="sxs-lookup"><span data-stu-id="ce427-1469">For example, a –10 will appear as 65,526, a –1 as 65,535.</span></span>  
  
 <span data-ttu-id="ce427-1470">Para exibir cadeias de caracteres da categoria localizada no Visualizador de eventos, você deve usar uma fonte de evento configurado com um arquivo de recurso da categoria e defina o `category` para um identificador de recurso no arquivo de recurso da categoria.</span><span class="sxs-lookup"><span data-stu-id="ce427-1470">To display localized category strings in the Event Viewer, you must use an event source configured with a category resource file, and set the `category` to a resource identifier in the category resource file.</span></span> <span data-ttu-id="ce427-1471">Se a origem do evento não tem um arquivo de recurso da categoria configurado ou especificado `category` não indexa uma cadeia de caracteres no arquivo de recurso da categoria, em seguida, o Visualizador de eventos exibe o valor da categoria numérica para a entrada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1471">If the event source does not have a configured category resource file, or the specified `category` does not index a string in the category resource file, then the Event Viewer displays the numeric category value for that entry.</span></span> <span data-ttu-id="ce427-1472">Configurar o arquivo de recurso da categoria, juntamente com o número de cadeias de caracteres de categoria no arquivo de recurso, usando o <xref:System.Diagnostics.EventLogInstaller> ou o <xref:System.Diagnostics.EventSourceCreationData> classe.</span><span class="sxs-lookup"><span data-stu-id="ce427-1472">Configure the category resource file, along with the number of category strings in the resource file, using the <xref:System.Diagnostics.EventLogInstaller> or the <xref:System.Diagnostics.EventSourceCreationData> class.</span></span>  
  
 <span data-ttu-id="ce427-1473">Identificadores de eventos, junto com a origem do evento, identificam exclusivamente um evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1473">Event identifiers, together with the event source, uniquely identify an event.</span></span> <span data-ttu-id="ce427-1474">Cada aplicativo pode definir seus próprios eventos numerados e as cadeias de caracteres de descrição para o qual eles são mapeados.</span><span class="sxs-lookup"><span data-stu-id="ce427-1474">Each application can define its own numbered events and the description strings to which they map.</span></span> <span data-ttu-id="ce427-1475">Os visualizadores de eventos exibem esses valores de cadeia de caracteres para ajudar o usuário a entender o que deu errado e sugere ações a serem tomadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1475">Event viewers display these string values to help the user understand what went wrong and suggest what actions to take.</span></span>  
  
 <span data-ttu-id="ce427-1476">Por fim, você pode especificar um <xref:System.Diagnostics.EventLogEntryType> para o evento que está sendo gravado no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1476">Finally, you can specify an <xref:System.Diagnostics.EventLogEntryType> for the event being written to the event log.</span></span> <span data-ttu-id="ce427-1477">O `type` é indicado por um ícone e texto na coluna de tipo no Visualizador de eventos para um log.</span><span class="sxs-lookup"><span data-stu-id="ce427-1477">The `type` is indicated by an icon and text in the Type column in the Event Viewer for a log.</span></span> <span data-ttu-id="ce427-1478">Esse parâmetro indica se o tipo de evento é o erro, aviso, informação, auditoria de êxito ou auditoria de falha.</span><span class="sxs-lookup"><span data-stu-id="ce427-1478">This parameter indicates whether the event type is error, warning, information, success audit, or failure audit.</span></span>  
  
 <span data-ttu-id="ce427-1479">Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1479">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="ce427-1480">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1480">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-1481">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-1481">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-1482">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-1482">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-1483">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1483">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-1484">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1484">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-1485">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1485">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-1486">O <xref:System.Diagnostics.EventLog.WriteEntry%2A> método grava a cadeia de caracteres fornecida diretamente para o log de eventos; ele não usa um arquivo de recurso de mensagem localizável.</span><span class="sxs-lookup"><span data-stu-id="ce427-1486">The <xref:System.Diagnostics.EventLog.WriteEntry%2A> method writes the given string directly to the event log; it does not use a localizable message resource file.</span></span> <span data-ttu-id="ce427-1487">Use o <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar eventos usando um arquivo de recurso de mensagem localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1487">Use the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write events using a localized message resource file.</span></span>  
  
 <span data-ttu-id="ce427-1488">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1488">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-1489">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1489">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-1490">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1490">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1491">Se o `message` parâmetro contém um caractere de terminação nula, a mensagem no log de eventos é encerrada no caractere NUL.</span><span class="sxs-lookup"><span data-stu-id="ce427-1491">If the `message` parameter contains a NUL character, the message in the event log is terminated at the NUL character.</span></span>  
>   
>  <span data-ttu-id="ce427-1492">O `message` cadeia de caracteres não pode conter %*n*, onde *n* é um valor de inteiro (por exemplo, %1), porque o Visualizador de eventos a trata como uma cadeia de caracteres de inserção.</span><span class="sxs-lookup"><span data-stu-id="ce427-1492">The `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="ce427-1493">Como um protocolo de Internet, a versão do endereço de 6 (IPv6) pode conter essa sequência de caracteres, você não pode registrar uma mensagem de evento que contém um endereço IPv6.</span><span class="sxs-lookup"><span data-stu-id="ce427-1493">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 [!code-cpp[EventLog_WriteEntry_1_3#2](~/samples/snippets/cpp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CPP/eventlog_writeentry_1_3.cpp#2)]
 [!code-csharp[EventLog_WriteEntry_1_3#2](~/samples/snippets/csharp/VS_Snippets_CLR/EventLog_WriteEntry_1_3/CS/eventlog_writeentry_1_3.cs#2)]
 [!code-vb[EventLog_WriteEntry_1_3#2](~/samples/snippets/visualbasic/VS_Snippets_CLR/EventLog_WriteEntry_1_3/VB/eventlog_writeentry_1_3.vb#2)]  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1494">O valor <paramref name="source" /> é uma cadeia de caracteres vazia ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1494">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="ce427-1495">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1495">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1496">O valor <paramref name="source" /> é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1496">The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="ce427-1497">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1497">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1498">
            <paramref name="eventID" /> é menor que zero ou maior que <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1498">
              <paramref name="eventID" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="ce427-1499">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1499">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1500">A cadeia de caracteres da mensagem tem mais de 31.839 bytes (32.766 em sistemas operacionais Windows anteriores ao Windows Vista).</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1500">The message string is longer than 31,839 bytes (32,766 bytes on Windows operating systems before Windows Vista).</span>
          </span>
          <span data-ttu-id="ce427-1501">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1501">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1502">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1502">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="ce427-1503">
            <paramref name="type" /> não é um <see cref="T:System.Diagnostics.EventLogEntryType" /> válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1503">
              <paramref name="type" /> is not a valid <see cref="T:System.Diagnostics.EventLogEntryType" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-1504">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1504">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-1505">O sistema operacional relatou um erro ao gravar a entrada de evento no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1505">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="ce427-1506">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1506">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1507">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1507">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1508">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1508">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="T:System.Diagnostics.EventLogEntryType" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="M:System.Diagnostics.EventLog.DeleteEventSource(System.String)" />
        <altmember cref="M:System.Diagnostics.EventLog.SourceExists(System.String)" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
      </Docs>
    </Member>
    <MemberGroup MemberName="WriteEvent">
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Docs>
        <summary>
          <span data-ttu-id="ce427-1509">Grava uma entrada de evento localizada no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1509">Writes a localized event entry to the event log.</span>
          </span>
        </summary>
      </Docs>
    </MemberGroup>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public void WriteEvent (System.Diagnostics.EventInstance instance, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEvent(class System.Diagnostics.EventInstance instance, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.Diagnostics.EventInstance,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEvent (instance As EventInstance, ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEvent(System::Diagnostics::EventInstance ^ instance, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="member this.WriteEvent : System.Diagnostics.EventInstance * obj[] -&gt; unit" Usage="eventLog.WriteEvent (instance, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
        <Attribute FrameworkAlternate="netframework-4.0">
          <AttributeName>System.Runtime.TargetedPatchingOptOut("Performance critical to inline this type of method across NGen image boundaries")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="instance">
          <span data-ttu-id="ce427-1510">Uma instância <see cref="T:System.Diagnostics.EventInstance" /> que representa uma entrada de log de eventos localizada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1510">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          </span>
        </param>
        <param name="values">
          <span data-ttu-id="ce427-1511">Uma matriz de cadeias de caracteres para mesclar o texto da mensagem da entrada de log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1511">An array of strings to merge into the message text of the event log entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1512">Grava uma entrada localizada no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1512">Writes a localized entry to the event log.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1513">Use esse método para gravar uma entrada localizada no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1513">Use this method to write a localized entry to the event log.</span></span> <span data-ttu-id="ce427-1514">Você pode especificar as propriedades de evento com identificadores de recurso em vez de valores de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="ce427-1514">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="ce427-1515">O Visualizador de eventos usa os identificadores de recurso para exibir as cadeias de caracteres correspondentes do arquivo de recurso localizado para o <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1515">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span> <span data-ttu-id="ce427-1516">Você deve registrar a fonte com o arquivo de recurso correspondente antes de gravar eventos usando identificadores de recurso.</span><span class="sxs-lookup"><span data-stu-id="ce427-1516">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="ce427-1517">A entrada `instance` instância Especifica as propriedades e a mensagem de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1517">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="ce427-1518">Defina as <xref:System.Diagnostics.EventInstance.InstanceId%2A> do `instance` de entrada para a mensagem definida no arquivo de recurso de mensagem de origem.</span><span class="sxs-lookup"><span data-stu-id="ce427-1518">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="ce427-1519">Opcionalmente, você pode definir as <xref:System.Diagnostics.EventInstance.CategoryId%2A> e <xref:System.Diagnostics.EventInstance.EntryType%2A> da `instance` entrada para definir o tipo de evento e a categoria da sua inscrição de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1519">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="ce427-1520">Você também pode especificar uma matriz de cadeias de caracteres independente de linguagem para inserir o texto da mensagem localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1520">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="ce427-1521">Definir `values` para `null` se a mensagem de evento não contém espaços reservados de formatação para cadeias de caracteres de substituição.</span><span class="sxs-lookup"><span data-stu-id="ce427-1521">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="ce427-1522">Você deve definir a <xref:System.Diagnostics.EventLog.Source%2A> propriedade em seu <xref:System.Diagnostics.EventLog> componente antes de usar <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1522">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="ce427-1523">A origem especificada deve ser configurada para gravar entradas localizadas no log; no mínimo, a origem deve ter um arquivo de recurso de mensagem definido.</span><span class="sxs-lookup"><span data-stu-id="ce427-1523">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="ce427-1524">Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1524">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="ce427-1525">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1525">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-1526">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-1526">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-1527">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-1527">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-1528">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1528">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-1529">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1529">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-1530">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1530">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-1531">Use o <xref:System.Diagnostics.EventLog.WriteEntry%2A> método se seu aplicativo grava os valores de cadeia de caracteres diretamente ao log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1531">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="ce427-1532">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1532">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-1533">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1533">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-1534">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1534">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1535">Se você gravar uma entrada para um computador remoto, o valor da `message` cadeia de caracteres pode não ser o esperado se o computador remoto não está em execução do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="ce427-1535">If you write an entry to a remote computer, the value of the `message` string might not be what you expect if the remote computer is not running the .NET Framework.</span></span> <span data-ttu-id="ce427-1536">Além disso, o `message` cadeia de caracteres não pode conter %*n*, onde *n* é um valor de inteiro (por exemplo, %1), porque o Visualizador de eventos a trata como uma cadeia de caracteres de inserção.</span><span class="sxs-lookup"><span data-stu-id="ce427-1536">Also, the `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="ce427-1537">Como um protocolo de Internet, a versão do endereço de 6 (IPv6) pode conter essa sequência de caracteres, você não pode registrar uma mensagem de evento que contém um endereço IPv6.</span><span class="sxs-lookup"><span data-stu-id="ce427-1537">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-1538">O exemplo a seguir grava duas entradas no log de eventos de auditoria `myNewLog`.</span><span class="sxs-lookup"><span data-stu-id="ce427-1538">The following example writes two audit entries to the event log `myNewLog`.</span></span> <span data-ttu-id="ce427-1539">O exemplo cria uma nova origem do evento e um novo log de eventos se eles não existirem no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-1539">The example creates a new event source and a new event log if they do not exist on the local computer.</span></span> <span data-ttu-id="ce427-1540">O texto da mensagem de evento é especificado usando um identificador de recurso em um arquivo de recurso.</span><span class="sxs-lookup"><span data-stu-id="ce427-1540">The event message text is specified using a resource identifier in a resource file.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#7](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#7)]
 [!code-csharp[EventLog_WriteEvent#7](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#7)]
 [!code-vb[EventLog_WriteEvent#7](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#7)]  
  
 <span data-ttu-id="ce427-1541">O exemplo usa o seguinte arquivo de texto de mensagem, criado para a biblioteca do recurso EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="ce427-1541">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="ce427-1542">Um arquivo de texto da mensagem é a origem do qual o arquivo de recurso de mensagem é criado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1542">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="ce427-1543">O arquivo de texto de mensagem define os identificadores de recurso e o texto para a categoria, a mensagem de evento e a cadeias de caracteres de inserção de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="ce427-1543">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1544">A propriedade <see cref="P:System.Diagnostics.EventLog.Source" /> do <see cref="T:System.Diagnostics.EventLog" /> não foi definida.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1544">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="ce427-1545">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1545">-or-</span>
          </span>
          <span data-ttu-id="ce427-1546">O método tentou registrar uma nova fonte de evento, mas o nome do computador em <see cref="P:System.Diagnostics.EventLog.MachineName" /> não é válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1546">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="ce427-1547">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1547">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1548">A origem já está registrada para um log de eventos diferente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1548">The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="ce427-1549">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1549">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1550">
            <paramref name="instance.InstanceId" /> é menor que zero ou maior que <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1550">
              <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="ce427-1551">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1551">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1552">
            <paramref name="values" /> tem mais de 256 elementos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1552">
              <paramref name="values" /> has more than 256 elements.</span>
          </span>
          <span data-ttu-id="ce427-1553">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1553">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1554">Um dos elementos <paramref name="values" /> é maior que 32766 bytes.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1554">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          </span>
          <span data-ttu-id="ce427-1555">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1555">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1556">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1556">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="ce427-1557">
            <paramref name="instance" /> é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1557">
              <paramref name="instance" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-1558">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1558">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-1559">O sistema operacional relatou um erro ao gravar a entrada de evento no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1559">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="ce427-1560">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1560">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1561">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1561">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1562">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1562">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public void WriteEvent (System.Diagnostics.EventInstance instance, byte[] data, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig instance void WriteEvent(class System.Diagnostics.EventInstance instance, unsigned int8[] data, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.Diagnostics.EventInstance,System.Byte[],System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Sub WriteEvent (instance As EventInstance, data As Byte(), ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; void WriteEvent(System::Diagnostics::EventInstance ^ instance, cli::array &lt;System::Byte&gt; ^ data, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="member this.WriteEvent : System.Diagnostics.EventInstance * byte[] * obj[] -&gt; unit" Usage="eventLog.WriteEvent (instance, data, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute FrameworkAlternate="netframework-2.0;netframework-3.0;netframework-3.5;netframework-4.0;netframework-4.5;netframework-4.5.1;netframework-4.5.2;netframework-4.6;netframework-4.6.1;netframework-4.6.2;netframework-4.7;netframework-4.7.1;netframework-4.7.2;xamarinmac-3.0">
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="data" Type="System.Byte[]" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="instance">
          <span data-ttu-id="ce427-1563">Uma instância <see cref="T:System.Diagnostics.EventInstance" /> que representa uma entrada de log de eventos localizada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1563">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          </span>
        </param>
        <param name="data">
          <span data-ttu-id="ce427-1564">Uma matriz de bytes que contém os dados binários associados à entrada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1564">An array of bytes that holds the binary data associated with the entry.</span>
          </span>
        </param>
        <param name="values">
          <span data-ttu-id="ce427-1565">Uma matriz de cadeias de caracteres para mesclar o texto da mensagem da entrada de log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1565">An array of strings to merge into the message text of the event log entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1566">Grava uma entrada de log de eventos com os dados de evento, cadeias de caracteres de substituição de mensagem e os dados binários associados.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1566">Writes an event log entry with the given event data, message replacement strings, and associated binary data.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1567">Use esse método para gravar uma entrada localizada com dados específicos de evento adicionais no log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1567">Use this method to write a localized entry with additional event-specific data to the event log.</span></span> <span data-ttu-id="ce427-1568">Você pode especificar as propriedades de evento com identificadores de recurso em vez de valores de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="ce427-1568">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="ce427-1569">O Visualizador de eventos usa os identificadores de recurso para exibir as cadeias de caracteres correspondentes do arquivo de recurso localizado para o <xref:System.Diagnostics.EventLog.Source%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1569">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the <xref:System.Diagnostics.EventLog.Source%2A>.</span></span> <span data-ttu-id="ce427-1570">Você deve registrar a fonte com o arquivo de recurso correspondente antes de gravar eventos usando identificadores de recurso.</span><span class="sxs-lookup"><span data-stu-id="ce427-1570">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="ce427-1571">A entrada `instance` instância Especifica as propriedades e a mensagem de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1571">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="ce427-1572">Defina as <xref:System.Diagnostics.EventInstance.InstanceId%2A> do `instance` de entrada para a mensagem definida no arquivo de recurso de mensagem de origem.</span><span class="sxs-lookup"><span data-stu-id="ce427-1572">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="ce427-1573">Opcionalmente, você pode definir as <xref:System.Diagnostics.EventInstance.CategoryId%2A> e <xref:System.Diagnostics.EventInstance.EntryType%2A> da `instance` entrada para definir o tipo de evento e a categoria da sua inscrição de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1573">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="ce427-1574">Você também pode especificar uma matriz de cadeias de caracteres independente de linguagem para inserir o texto da mensagem localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1574">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="ce427-1575">Definir `values` para `null` se a mensagem de evento não contém espaços reservados de formatação para cadeias de caracteres de substituição.</span><span class="sxs-lookup"><span data-stu-id="ce427-1575">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="ce427-1576">Especifica dados binários com um evento quando for necessário fornecer detalhes adicionais para o evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1576">Specify binary data with an event when it is necessary to provide additional details for the event.</span></span> <span data-ttu-id="ce427-1577">Por exemplo, use o `data` parâmetro incluir informações sobre um erro específico.</span><span class="sxs-lookup"><span data-stu-id="ce427-1577">For example, use the `data` parameter to include information on a specific error.</span></span> <span data-ttu-id="ce427-1578">O Visualizador de eventos não interpreta os dados de evento associado; ele exibe os dados em um formato hexadecimal e textual combinado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1578">The Event Viewer does not interpret the associated event data; it displays the data in a combined hexadecimal and text format.</span></span> <span data-ttu-id="ce427-1579">Use dados de eventos específicos com moderação; incluí-lo somente se você tiver certeza será útil.</span><span class="sxs-lookup"><span data-stu-id="ce427-1579">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="ce427-1580">Você também pode usar dados de eventos específicos para armazenar informações que o aplicativo pode processar independentemente do Visualizador de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1580">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="ce427-1581">Por exemplo, você poderia escrever um visualizador especificamente para seus eventos ou escrever um programa que examina o log de eventos e cria relatórios que incluem informações sobre os dados específicos do evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1581">For example, you could write a viewer specifically for your events, or write a program that scans the event log and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="ce427-1582">Você deve definir a <xref:System.Diagnostics.EventLog.Source%2A> propriedade em seu <xref:System.Diagnostics.EventLog> componente antes do componente antes de usar <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1582">You must set the <xref:System.Diagnostics.EventLog.Source%2A> property on your <xref:System.Diagnostics.EventLog> component before component before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="ce427-1583">A origem especificada deve ser configurada para gravar entradas localizadas no log; no mínimo, a origem deve ter um arquivo de recurso de mensagem definido.</span><span class="sxs-lookup"><span data-stu-id="ce427-1583">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="ce427-1584">Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1584">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="ce427-1585">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1585">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-1586">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-1586">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-1587">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-1587">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-1588">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1588">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-1589">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1589">You must have administrative rights on the computer to create a new event source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1590">Se você não especificar uma <xref:System.Diagnostics.EventLog.MachineName%2A> para seu <xref:System.Diagnostics.EventLog> instância antes de chamar <xref:System.Diagnostics.EventLog.WriteEvent%2A>, o computador local (".") é assumido.</span><span class="sxs-lookup"><span data-stu-id="ce427-1590">If you do not specify a <xref:System.Diagnostics.EventLog.MachineName%2A> for your <xref:System.Diagnostics.EventLog> instance before you call <xref:System.Diagnostics.EventLog.WriteEvent%2A>, the local computer (".") is assumed.</span></span>  
  
 <span data-ttu-id="ce427-1591">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1591">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-1592">Use o <xref:System.Diagnostics.EventLog.WriteEntry%2A> método se seu aplicativo grava os valores de cadeia de caracteres diretamente ao log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1592">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="ce427-1593">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1593">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-1594">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1594">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-1595">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1595">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ce427-1596">Se você gravar uma entrada para um computador remoto, o valor da `message` cadeia de caracteres pode não ser o esperado se o computador remoto não está em execução do .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="ce427-1596">If you write an entry to a remote computer, the value of the `message` string might not be what you expect if the remote computer is not running the .NET Framework.</span></span> <span data-ttu-id="ce427-1597">Além disso, o `message` cadeia de caracteres não pode conter %*n*, onde *n* é um valor de inteiro (por exemplo, %1), porque o Visualizador de eventos a trata como uma cadeia de caracteres de inserção.</span><span class="sxs-lookup"><span data-stu-id="ce427-1597">Also, the `message` string cannot contain %*n*, where *n* is an integer value (for example, %1), because the event viewer treats it as an insertion string.</span></span> <span data-ttu-id="ce427-1598">Como um protocolo de Internet, a versão do endereço de 6 (IPv6) pode conter essa sequência de caracteres, você não pode registrar uma mensagem de evento que contém um endereço IPv6.</span><span class="sxs-lookup"><span data-stu-id="ce427-1598">Because an Internet Protocol, version 6 (IPv6) address can contain this character sequence, you cannot log an event message that contains an IPv6 address.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-1599">O exemplo a seguir grava duas entradas no log de eventos de auditoria `myNewLog`.</span><span class="sxs-lookup"><span data-stu-id="ce427-1599">The following example writes two audit entries to the event log `myNewLog`.</span></span> <span data-ttu-id="ce427-1600">O exemplo cria uma nova origem do evento e um novo log de eventos se eles não existirem no computador local.</span><span class="sxs-lookup"><span data-stu-id="ce427-1600">The example creates a new event source and a new event log if they do not exist on the local computer.</span></span> <span data-ttu-id="ce427-1601">O texto da mensagem de evento é especificado usando um identificador de recurso em um arquivo de recurso.</span><span class="sxs-lookup"><span data-stu-id="ce427-1601">The event message text is specified using a resource identifier in a resource file.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#7](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#7)]
 [!code-csharp[EventLog_WriteEvent#7](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#7)]
 [!code-vb[EventLog_WriteEvent#7](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#7)]  
  
 <span data-ttu-id="ce427-1602">O exemplo usa o seguinte arquivo de texto de mensagem, criado para a biblioteca do recurso EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="ce427-1602">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="ce427-1603">Um arquivo de texto da mensagem é a origem do qual o arquivo de recurso de mensagem é criado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1603">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="ce427-1604">O arquivo de texto de mensagem define os identificadores de recurso e o texto para a categoria, a mensagem de evento e a cadeias de caracteres de inserção de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="ce427-1604">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1605">A propriedade <see cref="P:System.Diagnostics.EventLog.Source" /> do <see cref="T:System.Diagnostics.EventLog" /> não foi definida.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1605">The <see cref="P:System.Diagnostics.EventLog.Source" /> property of the <see cref="T:System.Diagnostics.EventLog" /> has not been set.</span>
          </span>
          <span data-ttu-id="ce427-1606">- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1606">-or-</span>
          </span>
          <span data-ttu-id="ce427-1607">O método tentou registrar uma nova fonte de evento, mas o nome do computador em <see cref="P:System.Diagnostics.EventLog.MachineName" /> não é válido.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1607">The method attempted to register a new event source, but the computer name in <see cref="P:System.Diagnostics.EventLog.MachineName" /> is not valid.</span>
          </span>
          <span data-ttu-id="ce427-1608">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1608">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1609">A origem já está registrada para um log de eventos diferente.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1609">The source is already registered for a different event log.</span>
          </span>
          <span data-ttu-id="ce427-1610">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1610">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1611">
            <paramref name="instance.InstanceId" /> é menor que zero ou maior que <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1611">
              <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="ce427-1612">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1612">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1613">
            <paramref name="values" /> tem mais de 256 elementos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1613">
              <paramref name="values" /> has more than 256 elements.</span>
          </span>
          <span data-ttu-id="ce427-1614">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1614">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1615">Um dos elementos <paramref name="values" /> é maior que 32766 bytes.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1615">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          </span>
          <span data-ttu-id="ce427-1616">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1616">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1617">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1617">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="ce427-1618">
            <paramref name="instance" /> é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1618">
              <paramref name="instance" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-1619">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1619">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-1620">O sistema operacional relatou um erro ao gravar a entrada de evento no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1620">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="ce427-1621">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1621">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1622">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1622">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1623">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1623">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public static void WriteEvent (string source, System.Diagnostics.EventInstance instance, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEvent(string source, class System.Diagnostics.EventInstance instance, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.String,System.Diagnostics.EventInstance,System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEvent (source As String, instance As EventInstance, ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEvent(System::String ^ source, System::Diagnostics::EventInstance ^ instance, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="static member WriteEvent : string * System.Diagnostics.EventInstance * obj[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEvent (source, instance, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="ce427-1624">O nome da origem de evento registrada para o aplicativo no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1624">The name of the event source registered for the application on the specified computer.</span>
          </span>
        </param>
        <param name="instance">
          <span data-ttu-id="ce427-1625">Uma instância <see cref="T:System.Diagnostics.EventInstance" /> que representa uma entrada de log de eventos localizada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1625">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          </span>
        </param>
        <param name="values">
          <span data-ttu-id="ce427-1626">Uma matriz de cadeias de caracteres para mesclar o texto da mensagem da entrada de log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1626">An array of strings to merge into the message text of the event log entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1627">Grava uma entrada de log de eventos com os dados do evento e as cadeias de caracteres de substituição de mensagem, usando a origem de evento registrada especificada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1627">Writes an event log entry with the given event data and message replacement strings, using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1628">Use esse método para gravar uma entrada localizada no log de eventos, usando uma fonte já registrada como uma origem de evento para o log adequado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1628">Use this method to write a localized entry to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="ce427-1629">Você pode especificar as propriedades de evento com identificadores de recurso em vez de valores de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="ce427-1629">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="ce427-1630">O Visualizador de eventos usa os identificadores de recurso para exibir as cadeias de caracteres correspondentes do arquivo de recurso localizado para a fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1630">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the source.</span></span> <span data-ttu-id="ce427-1631">Você deve registrar a fonte com o arquivo de recurso correspondente antes de gravar eventos usando identificadores de recurso.</span><span class="sxs-lookup"><span data-stu-id="ce427-1631">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="ce427-1632">A entrada `instance` instância Especifica as propriedades e a mensagem de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1632">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="ce427-1633">Defina as <xref:System.Diagnostics.EventInstance.InstanceId%2A> do `instance` de entrada para a mensagem definida no arquivo de recurso de mensagem de origem.</span><span class="sxs-lookup"><span data-stu-id="ce427-1633">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="ce427-1634">Opcionalmente, você pode definir as <xref:System.Diagnostics.EventInstance.CategoryId%2A> e <xref:System.Diagnostics.EventInstance.EntryType%2A> da `instance` entrada para definir o tipo de evento e a categoria da sua inscrição de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1634">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="ce427-1635">Você também pode especificar uma matriz de cadeias de caracteres independente de linguagem para inserir o texto da mensagem localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1635">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="ce427-1636">Definir `values` para `null` se a mensagem de evento não contém espaços reservados de formatação para cadeias de caracteres de substituição.</span><span class="sxs-lookup"><span data-stu-id="ce427-1636">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="ce427-1637">A origem especificada deve ser registrada para um log de eventos antes de usar <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1637">The specified source must be registered for an event log before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="ce427-1638">A origem especificada deve ser configurada para gravar entradas localizadas no log; no mínimo, a origem deve ter um arquivo de recurso de mensagem definido.</span><span class="sxs-lookup"><span data-stu-id="ce427-1638">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="ce427-1639">Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1639">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="ce427-1640">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1640">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-1641">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-1641">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-1642">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-1642">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-1643">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1643">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-1644">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1644">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-1645">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1645">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-1646">Use o <xref:System.Diagnostics.EventLog.WriteEntry%2A> método se seu aplicativo grava os valores de cadeia de caracteres diretamente ao log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1646">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="ce427-1647">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1647">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-1648">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1648">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-1649">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1649">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-1650">O exemplo a seguir grava uma entrada de evento informativo e uma entrada de evento de aviso para um log de eventos existente.</span><span class="sxs-lookup"><span data-stu-id="ce427-1650">The following example writes an informational event entry and a warning event entry to an existing event log.</span></span> <span data-ttu-id="ce427-1651">O texto da mensagem de evento é especificado usando um identificador de recurso em um arquivo de recurso.</span><span class="sxs-lookup"><span data-stu-id="ce427-1651">The event message text is specified using a resource identifier in a resource file.</span></span> <span data-ttu-id="ce427-1652">O exemplo supõe que o arquivo de recurso correspondente foi registrado para a fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1652">The example assumes the corresponding resource file has been registered for the source.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#8](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#8)]
 [!code-csharp[EventLog_WriteEvent#8](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#8)]
 [!code-vb[EventLog_WriteEvent#8](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#8)]  
  
 <span data-ttu-id="ce427-1653">O exemplo usa o seguinte arquivo de texto de mensagem, criado para a biblioteca do recurso EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="ce427-1653">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="ce427-1654">Um arquivo de texto da mensagem é a origem do qual o arquivo de recurso de mensagem é criado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1654">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="ce427-1655">O arquivo de texto de mensagem define os identificadores de recurso e o texto para a categoria, a mensagem de evento e a cadeias de caracteres de inserção de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="ce427-1655">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1656">O valor <paramref name="source" /> é uma cadeia de caracteres vazia ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1656">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="ce427-1657">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1657">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1658">O valor <paramref name="source" /> é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1658">The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="ce427-1659">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1659">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1660">
            <paramref name="instance.InstanceId" /> é menor que zero ou maior que <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1660">
              <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="ce427-1661">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1661">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1662">
            <paramref name="values" /> tem mais de 256 elementos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1662">
              <paramref name="values" /> has more than 256 elements.</span>
          </span>
          <span data-ttu-id="ce427-1663">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1663">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1664">Um dos elementos <paramref name="values" /> é maior que 32766 bytes.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1664">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          </span>
          <span data-ttu-id="ce427-1665">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1665">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1666">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1666">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="ce427-1667">
            <paramref name="instance" /> é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1667">
              <paramref name="instance" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-1668">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1668">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-1669">O sistema operacional relatou um erro ao gravar a entrada de evento no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1669">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="ce427-1670">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1670">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1671">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1671">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1672">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1672">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
    <Member MemberName="WriteEvent">
      <MemberSignature Language="C#" Value="public static void WriteEvent (string source, System.Diagnostics.EventInstance instance, byte[] data, params object[] values);" />
      <MemberSignature Language="ILAsm" Value=".method public static hidebysig void WriteEvent(string source, class System.Diagnostics.EventInstance instance, unsigned int8[] data, object[] values) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.Diagnostics.EventLog.WriteEvent(System.String,System.Diagnostics.EventInstance,System.Byte[],System.Object[])" />
      <MemberSignature Language="VB.NET" Value="Public Shared Sub WriteEvent (source As String, instance As EventInstance, data As Byte(), ParamArray values As Object())" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; static void WriteEvent(System::String ^ source, System::Diagnostics::EventInstance ^ instance, cli::array &lt;System::Byte&gt; ^ data, ... cli::array &lt;System::Object ^&gt; ^ values);" />
      <MemberSignature Language="F#" Value="static member WriteEvent : string * System.Diagnostics.EventInstance * byte[] * obj[] -&gt; unit" Usage="System.Diagnostics.EventLog.WriteEvent (source, instance, data, values)" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System</AssemblyName>
        <AssemblyVersion>2.0.0.0</AssemblyVersion>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="source" Type="System.String" />
        <Parameter Name="instance" Type="System.Diagnostics.EventInstance" />
        <Parameter Name="data" Type="System.Byte[]" />
        <Parameter Name="values" Type="System.Object[]">
          <Attributes>
            <Attribute>
              <AttributeName>System.ParamArray</AttributeName>
            </Attribute>
          </Attributes>
        </Parameter>
      </Parameters>
      <Docs>
        <param name="source">
          <span data-ttu-id="ce427-1673">O nome da origem de evento registrada para o aplicativo no computador especificado.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1673">The name of the event source registered for the application on the specified computer.</span>
          </span>
        </param>
        <param name="instance">
          <span data-ttu-id="ce427-1674">Uma instância <see cref="T:System.Diagnostics.EventInstance" /> que representa uma entrada de log de eventos localizada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1674">An <see cref="T:System.Diagnostics.EventInstance" /> instance that represents a localized event log entry.</span>
          </span>
        </param>
        <param name="data">
          <span data-ttu-id="ce427-1675">Uma matriz de bytes que contém os dados binários associados à entrada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1675">An array of bytes that holds the binary data associated with the entry.</span>
          </span>
        </param>
        <param name="values">
          <span data-ttu-id="ce427-1676">Uma matriz de cadeias de caracteres para mesclar o texto da mensagem da entrada de log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1676">An array of strings to merge into the message text of the event log entry.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="ce427-1677">Grava uma entrada de log de eventos com os dados de evento, cadeias de caracteres de substituição de mensagem e os dados binários associados e usando a origem do evento registrada especificada.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1677">Writes an event log entry with the given event data, message replacement strings, and associated binary data, and using the specified registered event source.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="ce427-1678">Use esse método para gravar uma entrada localizada com dados específicos de evento adicionais no log de eventos, usando uma fonte já registrada como uma origem de evento para o log adequado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1678">Use this method to write a localized entry with additional event-specific data to the event log, using a source already registered as an event source for the appropriate log.</span></span> <span data-ttu-id="ce427-1679">Você pode especificar as propriedades de evento com identificadores de recurso em vez de valores de cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="ce427-1679">You specify the event properties with resource identifiers rather than string values.</span></span> <span data-ttu-id="ce427-1680">O Visualizador de eventos usa os identificadores de recurso para exibir as cadeias de caracteres correspondentes do arquivo de recurso localizado para a fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1680">The Event Viewer uses the resource identifiers to display the corresponding strings from the localized resource file for the source.</span></span> <span data-ttu-id="ce427-1681">Você deve registrar a fonte com o arquivo de recurso correspondente antes de gravar eventos usando identificadores de recurso.</span><span class="sxs-lookup"><span data-stu-id="ce427-1681">You must register the source with the corresponding resource file before you write events using resource identifiers.</span></span>  
  
 <span data-ttu-id="ce427-1682">A entrada `instance` instância Especifica as propriedades e a mensagem de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1682">The input `instance` instance specifies the event message and properties.</span></span> <span data-ttu-id="ce427-1683">Defina as <xref:System.Diagnostics.EventInstance.InstanceId%2A> do `instance` de entrada para a mensagem definida no arquivo de recurso de mensagem de origem.</span><span class="sxs-lookup"><span data-stu-id="ce427-1683">Set the <xref:System.Diagnostics.EventInstance.InstanceId%2A> of the `instance` input for the defined message in the source message resource file.</span></span> <span data-ttu-id="ce427-1684">Opcionalmente, você pode definir as <xref:System.Diagnostics.EventInstance.CategoryId%2A> e <xref:System.Diagnostics.EventInstance.EntryType%2A> da `instance` entrada para definir o tipo de evento e a categoria da sua inscrição de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1684">You can optionally set the <xref:System.Diagnostics.EventInstance.CategoryId%2A> and <xref:System.Diagnostics.EventInstance.EntryType%2A> of the `instance` input to define the category and event type of your event entry.</span></span> <span data-ttu-id="ce427-1685">Você também pode especificar uma matriz de cadeias de caracteres independente de linguagem para inserir o texto da mensagem localizada.</span><span class="sxs-lookup"><span data-stu-id="ce427-1685">You can also specify an array of language-independent strings to insert into the localized message text.</span></span> <span data-ttu-id="ce427-1686">Definir `values` para `null` se a mensagem de evento não contém espaços reservados de formatação para cadeias de caracteres de substituição.</span><span class="sxs-lookup"><span data-stu-id="ce427-1686">Set `values` to `null` if the event message does not contain formatting placeholders for replacement strings.</span></span>  
  
 <span data-ttu-id="ce427-1687">Especifica dados binários com um evento quando for necessário fornecer detalhes adicionais para o evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1687">Specify binary data with an event when it is necessary to provide additional details for the event.</span></span> <span data-ttu-id="ce427-1688">Por exemplo, use o `data` parâmetro incluir informações sobre um erro específico.</span><span class="sxs-lookup"><span data-stu-id="ce427-1688">For example, use the `data` parameter to include information on a specific error.</span></span> <span data-ttu-id="ce427-1689">O Visualizador de eventos não interpreta os dados de evento associado; ele exibe os dados em um formato hexadecimal e textual combinado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1689">The Event Viewer does not interpret the associated event data; it displays the data in a combined hexadecimal and text format.</span></span> <span data-ttu-id="ce427-1690">Use dados de eventos específicos com moderação; incluí-lo somente se você tiver certeza será útil.</span><span class="sxs-lookup"><span data-stu-id="ce427-1690">Use event-specific data sparingly; include it only if you are sure it will be useful.</span></span> <span data-ttu-id="ce427-1691">Você também pode usar dados de eventos específicos para armazenar informações que o aplicativo pode processar independentemente do Visualizador de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1691">You can also use event-specific data to store information the application can process independently of the Event Viewer.</span></span> <span data-ttu-id="ce427-1692">Por exemplo, você poderia escrever um visualizador especificamente para seus eventos ou escrever um programa que examina o log de eventos e cria relatórios que incluem informações sobre os dados específicos do evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1692">For example, you could write a viewer specifically for your events, or write a program that scans the event log and creates reports that include information from the event-specific data.</span></span>  
  
 <span data-ttu-id="ce427-1693">A origem especificada deve ser registrada para um log de eventos antes de usar <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span><span class="sxs-lookup"><span data-stu-id="ce427-1693">The specified source must be registered for an event log before using <xref:System.Diagnostics.EventLog.WriteEvent%2A>.</span></span> <span data-ttu-id="ce427-1694">A origem especificada deve ser configurada para gravar entradas localizadas no log; no mínimo, a origem deve ter um arquivo de recurso de mensagem definido.</span><span class="sxs-lookup"><span data-stu-id="ce427-1694">The specified source must be configured for writing localized entries to the log; the source must at minimum have a message resource file defined.</span></span>  
  
 <span data-ttu-id="ce427-1695">Você deve criar e configurar a origem do evento antes de gravar a primeira entrada com o código-fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1695">You must create and configure the event source before writing the first entry with the source.</span></span> <span data-ttu-id="ce427-1696">Crie a nova fonte de evento durante a instalação do seu aplicativo.</span><span class="sxs-lookup"><span data-stu-id="ce427-1696">Create the new event source during the installation of your application.</span></span> <span data-ttu-id="ce427-1697">Isso permite que o tempo para o sistema operacional atualizar sua lista de fontes de eventos registrados e suas configurações.</span><span class="sxs-lookup"><span data-stu-id="ce427-1697">This allows time for the operating system to refresh its list of registered event sources and their configuration.</span></span> <span data-ttu-id="ce427-1698">Se o sistema operacional não foi atualizado para a sua lista de fontes de eventos, e você tentar gravar um evento com a nova fonte, que haverá falha na operação de gravação.</span><span class="sxs-lookup"><span data-stu-id="ce427-1698">If the operating system has not refreshed its list of event sources, and you attempt to write an event with the new source, the write operation will fail.</span></span> <span data-ttu-id="ce427-1699">Você pode configurar uma nova fonte usando um <xref:System.Diagnostics.EventLogInstaller>, ou usando o <xref:System.Diagnostics.EventLog.CreateEventSource%2A> método.</span><span class="sxs-lookup"><span data-stu-id="ce427-1699">You can configure a new source using an <xref:System.Diagnostics.EventLogInstaller>, or using the <xref:System.Diagnostics.EventLog.CreateEventSource%2A> method.</span></span> <span data-ttu-id="ce427-1700">Você deve ter direitos administrativos no computador para criar uma nova fonte de evento.</span><span class="sxs-lookup"><span data-stu-id="ce427-1700">You must have administrative rights on the computer to create a new event source.</span></span>  
  
 <span data-ttu-id="ce427-1701">A origem deve ser configurada para gravar entradas localizadas ou para gravação de cadeias de caracteres diretas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1701">The source must be configured either for writing localized entries or for writing direct strings.</span></span> <span data-ttu-id="ce427-1702">Use o <xref:System.Diagnostics.EventLog.WriteEntry%2A> método se seu aplicativo grava os valores de cadeia de caracteres diretamente ao log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1702">Use the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method if your application writes string values directly to the event log.</span></span>  
  
 <span data-ttu-id="ce427-1703">Se seu aplicativo grava entradas usando os valores de cadeia de caracteres e identificadores de recurso, você deve registrar duas fontes separadas.</span><span class="sxs-lookup"><span data-stu-id="ce427-1703">If your application writes entries using both resource identifiers and string values, you must register two separate sources.</span></span> <span data-ttu-id="ce427-1704">Por exemplo, configure uma fonte com arquivos de recurso e, em seguida, usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEvent%2A> método para gravar entradas usando identificadores de recurso para o log de eventos.</span><span class="sxs-lookup"><span data-stu-id="ce427-1704">For example, configure one source with resource files, and then use that source in the <xref:System.Diagnostics.EventLog.WriteEvent%2A> method to write entries using resource identifiers to the event log.</span></span> <span data-ttu-id="ce427-1705">Em seguida, criar uma fonte diferente sem arquivos de recurso e usar essa fonte no <xref:System.Diagnostics.EventLog.WriteEntry%2A> método escrever cadeias de caracteres diretamente ao log de eventos usando essa fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1705">Then create a different source without resource files, and use that source in the <xref:System.Diagnostics.EventLog.WriteEntry%2A> method to write strings directly to the event log using that source.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="ce427-1706">O exemplo a seguir grava uma entrada de evento informativo e uma entrada de evento de aviso para um log de eventos existente.</span><span class="sxs-lookup"><span data-stu-id="ce427-1706">The following example writes an informational event entry and a warning event entry to an existing event log.</span></span> <span data-ttu-id="ce427-1707">O texto da mensagem de evento é especificado usando um identificador de recurso em um arquivo de recurso.</span><span class="sxs-lookup"><span data-stu-id="ce427-1707">The event message text is specified using a resource identifier in a resource file.</span></span> <span data-ttu-id="ce427-1708">O exemplo supõe que o arquivo de recurso correspondente foi registrado para a fonte.</span><span class="sxs-lookup"><span data-stu-id="ce427-1708">The example assumes the corresponding resource file has been registered for the source.</span></span>  
  
 [!code-cpp[EventLog_WriteEvent#8](~/samples/snippets/cpp/VS_Snippets_CLR/eventlog_WriteEvent/CPP/source.cpp#8)]
 [!code-csharp[EventLog_WriteEvent#8](~/samples/snippets/csharp/VS_Snippets_CLR/eventlog_WriteEvent/CS/source.cs#8)]
 [!code-vb[EventLog_WriteEvent#8](~/samples/snippets/visualbasic/VS_Snippets_CLR/eventlog_WriteEvent/VB/source.vb#8)]  
  
 <span data-ttu-id="ce427-1709">O exemplo usa o seguinte arquivo de texto de mensagem, criado para a biblioteca do recurso EventLogMsgs.dll.</span><span class="sxs-lookup"><span data-stu-id="ce427-1709">The example uses the following message text file, built into the resource library EventLogMsgs.dll.</span></span> <span data-ttu-id="ce427-1710">Um arquivo de texto da mensagem é a origem do qual o arquivo de recurso de mensagem é criado.</span><span class="sxs-lookup"><span data-stu-id="ce427-1710">A message text file is the source from which the message resource file is created.</span></span> <span data-ttu-id="ce427-1711">O arquivo de texto de mensagem define os identificadores de recurso e o texto para a categoria, a mensagem de evento e a cadeias de caracteres de inserção de parâmetro.</span><span class="sxs-lookup"><span data-stu-id="ce427-1711">The message text file defines the resource identifiers and text for the category, event message, and parameter insertion strings.</span></span>  
  
```  
; // EventLogMsgs.mc  
; // ********************************************************  
  
; // Use the following commands to build this file:  
  
; //   mc -s EventLogMsgs.mc  
; //   rc EventLogMsgs.rc  
; //   link /DLL /SUBSYSTEM:WINDOWS /NOENTRY /MACHINE:x86 EventLogMsgs.Res   
; // ********************************************************  
  
; // - Event categories -  
; // Categories must be numbered consecutively starting at 1.  
; // ********************************************************  
  
MessageId=0x1  
Severity=Success  
SymbolicName=INSTALL_CATEGORY  
Language=English  
Installation  
.  
  
MessageId=0x2  
Severity=Success  
SymbolicName=QUERY_CATEGORY  
Language=English  
Database Query  
.  
  
MessageId=0x3  
Severity=Success  
SymbolicName=REFRESH_CATEGORY  
Language=English  
Data Refresh  
.  
  
; // - Event messages -  
; // *********************************  
  
MessageId = 1000  
Severity = Success  
Facility = Application  
SymbolicName = AUDIT_SUCCESS_MESSAGE_ID_1000  
Language=English  
My application message text, in English, for message id 1000, called from %1.  
.  
  
MessageId = 1001  
Severity = Warning  
Facility = Application  
SymbolicName = AUDIT_FAILED_MESSAGE_ID_1001  
Language=English  
My application message text, in English, for message id 1001, called from %1.  
.  
  
MessageId = 1002  
Severity = Success  
Facility = Application  
SymbolicName = GENERIC_INFO_MESSAGE_ID_1002  
Language=English  
My generic information message in English, for message id 1002.  
.  
  
MessageId = 1003  
Severity = Warning  
Facility = Application  
SymbolicName = GENERIC_WARNING_MESSAGE_ID_1003  
Language=English  
My generic warning message in English, for message id 1003, called from %1.  
.  
  
MessageId = 1004  
Severity = Success  
Facility = Application  
SymbolicName = UPDATE_CYCLE_COMPLETE_MESSAGE_ID_1004  
Language=English  
The update cycle is complete for %%5002.  
.  
  
MessageId = 1005  
Severity = Warning  
Facility = Application  
SymbolicName = SERVER_CONNECTION_DOWN_MESSAGE_ID_1005  
Language=English  
The refresh operation did not complete because the connection to server %1 could not be established.  
.  
  
; // - Event log display name -  
; // ********************************************************  
  
MessageId = 5001  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_DISPLAY_NAME_MSGID  
Language=English  
Sample Event Log  
.  
  
; // - Event message parameters -  
; //   Language independent insertion strings  
; // ********************************************************  
  
MessageId = 5002  
Severity = Success  
Facility = Application  
SymbolicName = EVENT_LOG_SERVICE_NAME_MSGID  
Language=English  
SVC_UPDATE.EXE  
.  
```  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="ce427-1712">O valor <paramref name="source" /> é uma cadeia de caracteres vazia ("").</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1712">The <paramref name="source" /> value is an empty string ("").</span>
          </span>
          <span data-ttu-id="ce427-1713">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1713">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1714">O valor <paramref name="source" /> é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1714">The <paramref name="source" /> value is <see langword="null" />.</span>
          </span>
          <span data-ttu-id="ce427-1715">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1715">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1716">
            <paramref name="instance.InstanceId" /> é menor que zero ou maior que <see cref="F:System.UInt16.MaxValue" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1716">
              <paramref name="instance.InstanceId" /> is less than zero or greater than <see cref="F:System.UInt16.MaxValue" />.</span>
          </span>
          <span data-ttu-id="ce427-1717">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1717">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1718">
            <paramref name="values" /> tem mais de 256 elementos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1718">
              <paramref name="values" /> has more than 256 elements.</span>
          </span>
          <span data-ttu-id="ce427-1719">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1719">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1720">Um dos elementos <paramref name="values" /> é maior que 32766 bytes.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1720">One of the <paramref name="values" /> elements is longer than 32766 bytes.</span>
          </span>
          <span data-ttu-id="ce427-1721">\- ou -</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1721">\- or -</span>
          </span>
          <span data-ttu-id="ce427-1722">O nome da origem resulta em um caminho de chave do Registro com mais de 254 caracteres.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1722">The source name results in a registry key path longer than 254 characters.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentNullException">
          <span data-ttu-id="ce427-1723">
            <paramref name="instance" /> é <see langword="null" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1723">
              <paramref name="instance" /> is <see langword="null" />.</span>
          </span>
        </exception>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="ce427-1724">Não foi possível abrir a chave do Registro para o log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1724">The registry key for the event log could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="ce427-1725">O sistema operacional relatou um erro ao gravar a entrada de evento no log de eventos.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1725">The operating system reported an error when writing the event entry to the event log.</span>
          </span>
          <span data-ttu-id="ce427-1726">Um código de erro do Windows não está disponível.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1726">A Windows error code is not available.</span>
          </span>
        </exception>
        <permission cref="T:System.Diagnostics.EventLogPermission">
          <span data-ttu-id="ce427-1727">para gravar as informações de log de eventos no computador.</span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1727">for writing the event log information on the computer.</span>
          </span>
          <span data-ttu-id="ce427-1728">Enumeração associada: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          <span class="sxs-lookup">
            <span data-stu-id="ce427-1728">Associated enumeration: <see cref="F:System.Diagnostics.EventLogPermissionAccess.Write" /></span>
          </span>
        </permission>
        <altmember cref="Overload:System.Diagnostics.EventLog.CreateEventSource" />
        <altmember cref="P:System.Diagnostics.EventLog.Source" />
        <altmember cref="P:System.Diagnostics.EventLog.Entries" />
        <altmember cref="T:System.Diagnostics.EventInstance" />
      </Docs>
    </Member>
  </Members>
</Type>