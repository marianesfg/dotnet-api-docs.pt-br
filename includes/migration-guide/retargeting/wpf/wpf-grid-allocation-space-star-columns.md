### <a name="wpf-grid-allocation-of-space-to-star-columns"></a>Alocação de espaço para colunas com estrela em Grades do WPF

|   |   |
|---|---|
|Detalhes|A partir do .NET Framework 4.7, o WPF substitui o algoritmo usado pelo <xref:System.Windows.Controls.Grid> para alocar espaço para colunas com *. Isso altera a largura real atribuída a colunas com * em diversos casos:<ul><li>Quando uma ou mais colunas com * também têm uma largura mínima ou máxima que substitui a alocação proporcional para a coluna. (A largura mínima pode ser derivada de uma declaração MinWidth explícita ou de um mínimo implícito obtido do conteúdo da coluna. A largura máxima só pode ser definida explicitamente de uma declaração MaxWidth.)</li><li>Quando uma ou mais colunas com * declaram um peso de * extremamente grande, maior que 10^298.</li><li>Quando os pesos de * são diferentes o suficiente para encontrar instabilidade de ponto flutuante (estouro, estouro negativo, perda de precisão).</li><li>Quando o arredondamento de layout está habilitado e o DPI de exibição efetivo é suficientemente alto.</li></ul>Nos dois primeiros casos, as larguras produzidas pelo novo algoritmo podem ser significativamente diferentes das produzidas pelo algoritmo antigo. No último caso, a diferença será no máximo um ou dois pixels. O novo algoritmo corrige vários bugs presentes no algoritmo antigo:<ol><li>A alocação total de colunas pode exceder a largura da grade. Isso pode ocorrer ao alocar espaço para uma coluna cujo compartilhamento proporcional seja menor que seu tamanho mínimo. O algoritmo aloca o tamanho mínimo, o que reduz o espaço disponível para outras colunas. Se não houver nenhuma coluna de * restante para alocar, a alocação total será muito grande.</li><li>A alocação total pode ser menor que a largura da grade. Esse é o problema duplo do n° 1, que surge ao alocar para uma coluna cujo compartilhamento proporcional é maior do que seu tamanho máximo, sem nenhuma coluna com * restante para concluir o processo.</li><li>Duas colunas com * podem receber alocações que não sejam proporcionais a seus pesos. Esta é uma versão atenuada da n° 1 e da n° 2, que surge ao alocar para colunas de * A, B e C (nessa ordem), quando o compartilhamento proporcional de B viola sua restrição mínima (ou máxima). Como acima, isso altera o espaço disponível para a coluna C, que obtém menos (ou mais) alocação proporcional do que A.</li><li>As colunas com pesos muito grandes (&gt; 10^298) são tratadas como se tivessem o peso 10^298. Não são consideradas as diferenças proporcionais entre elas (e entre colunas com pesos um pouco menores).</li><li>Colunas com pesos infinitos não são tratadas corretamente. (Na verdade, você não pode definir um peso para infinito, mas essa é uma restrição artificial. O código de alocação tentou lidar com isso, mas não teve muito sucesso.)</li><li>Vários problemas menores, evitando estouro, estouro negativo, perda de precisão e problemas de ponto flutuante semelhantes.</li><li>Os ajustes de arredondamento de layout são incorretos em um DPI suficientemente alto.</li></ol>O novo algoritmo produz resultados que atendam aos seguintes critérios: A. A largura real atribuída a uma coluna de * nunca é menor que sua largura mínima nem maior que sua largura máxima. B. Cada coluna  <em>que não tem uma largura mínima ou máxima atribuída, tem uma largura proporcional ao seu peso  <em>atribuída. Para ser preciso, se duas colunas são declaradas com largura x</em> e y</em>, respectivamente, e se nenhuma coluna recebe sua largura mínima ou máxima, as larguras reais v e w atribuídas às colunas ficam na mesma proporção: v / w == x / y. C. A largura total alocada para colunas com * &quot;proporcionais&quot; é igual ao espaço disponível depois de alocar para as colunas restritas (colunas fixas, automáticas e com * que têm a largura mínima ou máxima alocada). Isso pode ser zero, por exemplo, se a soma das larguras mínimas excede a largura disponível da grade. D. Todas essas instruções devem ser interpretadas em relação ao layout &quot;ideal&quot;. Quando o arredondamento de layout está em vigor, as larguras reais podem diferir das larguras ideais em até um pixel. O algoritmo antigo respeitou (A), mas não respeitou os outros critérios nos casos descritos acima. Tudo que foi afirmado sobre colunas e larguras neste artigo se aplica também a linhas e alturas.|
|Sugestão|Por padrão, os aplicativos destinados a versões do .NET Framework a partir do .NET Framework 4.7 usarão o novo algoritmo, enquanto os aplicativos destinados ao .NET Framework 4.6.2 ou a versões anteriores usarão o algoritmo antigo. Para substituir o padrão, use a seguinte definição de configuração:<pre><code class="language-xml">&lt;runtime&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.System.Windows.Controls.Grid.StarDefinitionsCanExceedAvailableSpace=true&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;</code></pre>O valor "true" seleciona o algoritmo antigo e "false” seleciona o novo algoritmo.|
|Escopo|Secundário|
|Versão|4.7|
|Tipo|Redirecionando|

