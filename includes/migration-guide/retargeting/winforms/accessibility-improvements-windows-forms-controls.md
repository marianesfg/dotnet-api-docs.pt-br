### <a name="accessibility-improvements-in-windows-forms-controls"></a>Melhorias de acessibilidade em controles do Windows Forms

|   |   |
|---|---|
|Detalhes|O Windows Forms está melhorando a forma como funciona com tecnologias de acessibilidade para dar um melhor suporte a seus clientes. Isso inclui as seguintes alterações:<ul><li>Alterações para melhorar a exibição durante o modo de Alto Contraste.</li><li>Alterações para melhorar a experiência no pesquisador de propriedades. As melhorias no pesquisador de propriedades incluem:</li><li>Melhor navegação de teclado por meio das várias janelas de seleção suspensa.</li><li>Redução de paradas de tabulação desnecessárias.</li><li>Melhor relatório de tipos de controle.</li><li>Melhor comportamento do Narrador.</li><li>Alterações para implementar padrões de acessibilidade de interface do usuário ausentes em controles.</li></ul>|
|Sugestão|<strong>Como aceitar ou recusar essas alterações</strong>Para se beneficiar dessas alterações, o aplicativo deverá ser executado no .NET Framework 4.7.1 ou posterior. O aplicativo pode se beneficiar dessas alterações de uma das seguintes maneiras:<ul><li>Ele é recompilado para ser destinado ao .NET Framework 4.7.1. Essas alterações de acessibilidade são habilitadas por padrão em aplicativos do Windows Forms destinados ao .NET Framework 4.7.1 ou posterior.</li><li>Ele recusa os comportamentos de acessibilidade herdados adicionando a seguinte [Opção de AppContext](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) à seção <code>&lt;runtime&gt;</code> do arquivo app.config e configurando-a como <code>false</code>, como mostra o exemplo a seguir.</li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>Aplicativos destinados ao .NET Framework 4.7.1 ou posterior que desejam preservar o comportamento de acessibilidade herdado pode aceitar o uso dos recursos de acessibilidade herdados definindo explicitamente essa opção de AppContext como <code>true</code>. Para obter uma visão geral da automação da interface do usuário, consulte a [Visão Geral da Automação da Interface do Usuário](~/docs/framework/ui-automation/ui-automation-overview.md).<strong>Suporte adicional para propriedades e padrões de automação da interface do usuário</strong>Clientes de acessibilidade podem aproveitar novos recursos de acessibilidade do WinForms usando padrões de invocação comuns, descritos publicamente. Esses padrões não são específicos do WinForms. Por exemplo, clientes de acessibilidade podem chamar o método QueryInterface na interface IAccessible (MAAS) para obter uma interface IServiceProvider. Se essa interface estiver disponível, os clientes poderão usar seu método QueryService para solicitar uma interface IAccessibleEx. Para obter mais informações, consulte [Usar IAccessibleEx de um cliente](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx). A partir do .NET Framework 4.7.1, IServiceProvider e [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (onde aplicável) estão disponíveis para objetos de acessibilidade do WinForms. O .NET Framework 4.7.1 adiciona suporte para os seguintes padrões e propriedades de automação da interface do usuário:<ul><li>Os controles <code>T:System.Windows.Forms.ToolStripSplitButton</code> e <code>T:System.Windows.Forms.ComboBox</code> dão suporte ao [Padrão expandir/recolher](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>O <code>T:System.Windows.Forms.ToolStripMenuItem</code> controle tem uma propriedade [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) com valor <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>O controle <code>T:System.Windows.Forms.ToolStripItem</code> dá suporte à propriedade [Name](xref:System.Windows.Automation.AutomationElement.NameProperty) e ao [Padrão expandir/recolher](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>O controle <code>T:System.Windows.Forms.ToolStripDropDownItem</code> dá suporte a <xref:System.Windows.Forms.AccessibleEvents> indicando StateChange e NameChange quando a lista suspensa é expandida ou recolhida.</li><li>O <code>T:System.Windows.Forms.ToolStripDropDownButton</code> controle tem uma propriedade [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) com valor de <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>O controle <code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code> dá suporte ao [Padrão de alternância](xref:System.Windows.Automation.TogglePattern).</li><li>Os controles <code>T:System.Windows.Forms.NumericUpDown</code> e <code>T:System.Windows.Forms.DomainUpDown</code> dão suporte a [Name](xref:System.Windows.Automation.AutomationElement.NameProperty) e têm um [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) de <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>.</li></ul><strong>Melhorias do controle PropertyGrid</strong>O .NET Framework 4.7.1 adiciona as seguintes melhorias ao controle PropertyBrowser:<ul><li>O botão <strong>Detalhes</strong> na caixa de diálogo de erro exibida quando o usuário insere um valor incorreto no controle <code>T:System.Windows.Forms.PropertyGrid</code> dá suporte ao [Padrão de expandir/recolher](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), notificações de alteração de estado e nome e uma propriedade [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) com um valor de <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>O painel de mensagem exibido quando o botão <strong>Detalhes</strong> da caixa de diálogo de erro é expandido agora é acessível por teclado e permite que o Narrador anuncie o conteúdo da mensagem de erro.</li><li>O <xref:System.Windows.Forms.AccessibleRole> de linhas no controle <code>T:System.Windows.Forms.PropertyGrid</code> foi alterado de &quot;Linha&quot; para &quot;Célula&quot;. A célula é mapeada para o ControlType de UIA &quot;DataItem&quot;, o que lhe permite dar suporte aos atalhos de teclado apropriados e a anúncios do Narrador.</li><li>As linhas do controle <code>T:System.Windows.Forms.PropertyGrid</code> que representam itens de cabeçalho quando o controle <code>T:System.Windows.Forms.PropertyGrid</code> tem uma propriedade <code>P:System.Windows.Forms.PropertySort</code> definida como <code>F:System.Windows.Forms.PropertySory.Categorized</code> têm uma propriedade [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) com valor <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType></li><li>As linhas do controle <code>T:System.Windows.Forms.PropertyGrid</code> que representam itens de cabeçalho quando o controle <code>T:System.Windows.Forms.PropertyGrid</code> tem uma propriedade <code>P:System.Windows.Forms.PropertySort</code> definida como <code>F:System.Windows.Forms.PropertySory.Categorized</code> dão suporte ao [Padrão expandir/recolher](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Melhoria da navegação por teclado entre a grade e a barra de ferramentas acima dela. Pressionar &quot;Shift-Tab&quot; agora seleciona o primeiro botão da barra de ferramentas em vez de toda a barra de ferramentas</li><li>Controles <code>T:System.Windows.Forms.PropertyGrid</code> exibidos no modo de Alto Contraste agora desenharão um retângulo de foco ao redor do botão da barra de ferramentas correspondente ao valor da propriedade <code>P:System.Windows.Forms.PropertySort</code> atual.</li><li>Controles <code>T:System.Windows.Forms.PropertyGrid</code> exibidos no modo de Alto Contraste e com uma propriedade <code>P:System.Windows.Forms.PropertySort</code> definida como <code>F:System.Windows.Forms.PropertySory.Categorized</code> agora exibirão o segundo plano dos cabeçalhos de categoria em uma cor altamente contrastante.</li><li>Controles <code>T:System.Windows.Forms.PropertyGrid</code> diferenciam melhor itens da barra de ferramentas com foco e itens da barra de ferramentas que indicam o valor atual da propriedade <code>P:System.Windows.Forms.PropertySort</code>. Essa correção consiste em uma alteração de Alto Contraste e em uma alteração para cenários que não são de Alto Contraste.</li><li>Itens da barra de ferramentas do controle <code>T:System.Windows.Forms.PropertyGrid</code> que indicam o valor atual da propriedade <code>P:System.Windows.Forms.PropertySort</code> dão suporte ao [Padrão de alternância](xref:System.Windows.Automation.TogglePattern).</li><li>Suporte aprimorado do Narrador para distinguir o alinhamento selecionado no Seletor de Alinhamento.</li><li>Quando um controle <code>T:System.Windows.Forms.PropertyGrid</code> vazio é exibido em um formulário, agora ele recebe foco onde antes não receberia.</li></ul><strong>Uso de cores definidas pelo sistema operacional em temas de Alto Contraste</strong><ul><li>Controles <code>T:System.Windows.Forms.Button</code> e <code>T:System.Windows.Forms.CheckBox</code> com <code>P:System.Windows.Forms.Control.FlatStyle</code> definido como <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>, que é o estilo padrão, agora usam cores definidas pelo sistema operacional no tema de Alto Contraste quando selecionado. Anteriormente, as cores de texto e de tela de fundo não eram contrastantes e eram difíceis de ler.</li><li><code>T:System.Windows.Forms.Button</code>, <code>T:System.Windows.Forms.CheckBox</code>, <code>T:System.Windows.Forms.RadioButton</code>, <code>T:System.Windows.Forms.Label</code>, <code>T:System.Windows.Forms.LinkLabel</code> e <code>T:System.Windows.Forms.GroupBox</code> com <code>P:System.Windows.Forms.Control.Enabled</code> definido como <em>false</em> usavam uma cor sombreada para renderizar texto em temas de alto contraste, resultando em baixo contraste em relação a tela de fundo. Agora, esses controles usam a cor de &quot;Texto desabilitado&quot; definida pelo sistema operacional. Essa correção se aplica a controles com a propriedade <code>P:System.Windows.Forms.Control.FlatStyle</code> definida com um valor diferente de <code>F:System.Windows.Forms.FlatStyle.System</code>. Os últimos controles são renderizados pelo sistema operacional.</li><li><code>T:System.Windows.Forms.DataGridView</code> agora renderiza um retângulo visível em torno do conteúdo da célula que tem o foco atual. Anteriormente, isso não era visível em certos temas de Alto Contraste.</li><li>Controles <code>T:System.Windows.Forms.ToolStripMenuItem</code> com uma propriedade <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> definida como <em>false</em> agora usam a cor de &quot;Texto desabilitado&quot; definida pelo sistema operacional.</li><li>Controles <code>T:System.Windows.Forms.ToolStripMenuItem</code> com uma propriedade <code>P:System.Windows.Forms.ToolStripItem.Checked</code> definida como <em>true</em> agora renderizam a marca de seleção associada em uma cor de sistema contrastante.  Antes, a cor da marca de seleção não era contrastante o suficiente e não era visível em temas de Alto Contraste.</li></ul>Observação: o Windows10 alterou os valores para algumas cores do sistema com alto contraste. A estrutura do Windows Forms é baseada na estrutura do Win32. Para obter a melhor experiência, execute a versão mais recente do Windows e aceite as alterações mais recentes do sistema operacional adicionando um arquivo app.manifest a um aplicativo de teste e removendo a marca de comentário do seguinte código:<pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><strong>Melhoria na navegação por teclado</strong><ul><li>Quando um controle <code>T:System.Windows.Forms.ComboBox</code> tem <code>P:System.Windows.Forms.ComboBox.DropDownStyle</code> definido como <code>F:System.Windows.Forms.DropDownStyle.DropDownList</code> e é o primeiro controle na ordem de tabulação no formulário, agora ele exibe um retângulo de foco quando o formulário pai é aberto usando o teclado. Antes desta alteração, o foco do teclado ficava nesse controle, mas um indicador de foco não era renderizado.</li></ul><strong>Melhor suporte ao Narrador</strong><ul><li>O controle <code>T:System.Windows.Forms.MonthCalendar</code> tem suporte adicional para tecnologias de assistência para acessar o controle, incluindo a capacidade do Narrador ler o valor do controle, quando antes ele não podia.</li><li>O controle <code>T:System.Windows.Forms.CheckedListBox</code> agora notifica o Narrador quando a propriedade <code>P:System.Windows.Forms.CheckState</code> é alterada. Antes, o Narrador não recebia uma notificação e, como resultado, os usuários não eram informados da atualização do <code>P:System.Windows.Forms.CheckState</code>.</li><li>O controle <code>T:System.Windows.Forms.LinkLabel</code> alterou a maneira como notifica o Narrador do texto no controle. Antes, o Narrador anunciava esse texto duas vezes e lia símbolos &quot;&amp;&quot; como texto real, mesmo que eles não fossem visíveis para um usuário. O texto duplicado foi removido dos anúncios do Narrador, bem como símbolos &quot;&amp;&quot; desnecessários.</li><li>Os tipos de controle <code>T:System.Windows.Forms.DataGridViewCell</code> agora relatam corretamente o status de somente leitura para o Narrador e outras tecnologias assistenciais.</li><li>Agora, o Narrador é capaz de ler o Menu do Sistema de janelas filho em aplicativos com [Interface MDI](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md).</li><li>O Narrador agora é capaz de ler controles <code>T:System.Windows.Forms.ToolStripMenuItem</code> com uma propriedade <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> definida como <em>false</em>. Antes, o Narrador não era capaz de focar em itens de menu desativados para ler o conteúdo.</li></ul>|
|Escopo|Principal|
|Versão|4.7.1|
|Tipo|Redirecionando|
|APIs afetadas|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[MonthCalendar.AccessibilityObject](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|

