### <a name="accessibility-improvements-in-windows-forms-controls"></a>Aprimoramentos de acessibilidade em controles dos Windows Forms

|   |   |
|---|---|
|Detalhes|Melhorando o Windows Forms como ele funciona com as tecnologias de acessibilidade para melhor suporte a clientes do Windows Forms. Isso inclui as seguintes alterações:<ul><li>Alterações para melhorar a exibição durante o modo de alto contraste.</li><li>Alterações para melhorar a experiência de navegador de propriedade. Aprimoramentos do navegador de propriedade incluem:</li><li>Melhor navegação de teclado por meio das várias janelas de seleção suspensa.</li><li>Reduzido paradas de tabulação desnecessários.</li><li>Melhor relatório de tipos de controle.</li><li>Melhor comportamento do Narrador.</li><li>Alterações para implementar ausentes padrões de acessibilidade de interface do usuário em controles.</li></ul>|
|Sugestão|<strong>Como aceitar ou recusar essas alterações</strong>na ordem para o aplicativo para se beneficiar com essas alterações, deve ser executada no .NET Framework 4.7.1 ou posterior. O aplicativo pode se beneficiar dessas alterações em qualquer uma das seguintes maneiras:<ul><li>Para direcionar o .NET Framework 4.7.1 é recompilado. Essas alterações de acessibilidade são habilitados por padrão em aplicativos de Windows Forms direcionados ao .NET Framework 4.7.1 ou posterior.</li><li>Ele significa recusar os comportamentos de acessibilidade herdado, adicionando o seguinte [AppContext switch](~/docs/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element.md) para o <code>&lt;runtime&gt;</code> seção do arquivo App. config e configurá-lo como <code>false</code>, como mostra o exemplo a seguir.</li></ul><pre><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>Aplicativos voltados para o .NET Framework 4.7.1 ou posterior e deseja preservar herdado comportamento de acessibilidade pode aceitar o uso dos recursos de acessibilidade herdado definindo explicitamente essa opção AppContext como <code>true</code>. Para obter uma visão geral de automação de interface do usuário, consulte o [visão geral de automação de interface do usuário](~/docs/framework/ui-automation/ui-automation-overview.md). <strong>Adicionado suporte para propriedades e padrões de automação de interface do usuário</strong>clientes de acessibilidade podem tirar proveito de novos recursos de acessibilidade do WinForms usando padrões de chamada comum, descrita publicamente. Esses padrões não são específicas do WinForms. Por exemplo, clientes de acessibilidade podem chamar o método QueryInterface na interface IAccessible (MAAS) para obter uma interface IServiceProvider. Se essa interface estiver disponível, os clientes podem usar seu método QueryService para solicitar uma interface IAccessibleEx. Para obter mais informações, consulte [IAccessibleEx de uso de um cliente](https://msdn.microsoft.com/library/windows/desktop/dd561924.aspx). Iniciando com o .NET Framework 4.7.1, IServiceProvider e [IAccessibleEx](https://msdn.microsoft.com/library/windows/desktop/dd561898.aspx) (onde pertinente) estão disponíveis para objetos de acessibilidade do WinForms. O .NET Framework 4.7.1 adiciona suporte para os seguintes padrões de automação de interface do usuário e as propriedades:<ul><li>O <code>T:System.Windows.Forms.ToolStripSplitButton</code> e <code>T:System.Windows.Forms.ComboBox</code> controla o suporte a [padrão de expandir/recolher](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>O <code>T:System.Windows.Forms.ToolStripMenuItem</code> controle tem um [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) o valor da propriedade <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>O <code>T:System.Windows.Forms.ToolStripItem</code> controle oferece suporte a [nome](xref:System.Windows.Automation.AutomationElement.NameProperty) propriedade e [padrão de expandir/recolher](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>O <code>T:System.Windows.Forms.ToolStripDropDownItem</code> controle oferece suporte a <xref:System.Windows.Forms.AccessibleEvents> indicando StateChange e NameChange quando a lista suspensa é expandida ou recolhida.</li><li>O <code>T:System.Windows.Forms.ToolStripDropDownButton</code> controle tem um [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) valor da propriedade <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>O <code>T:System.Windows.Forms.DataGridViewCheckBoxCell</code> controle oferece suporte a [padrão Toggle](xref:System.Windows.Automation.TogglePattern).</li><li>O <code>T:System.Windows.Forms.NumericUpDown</code> e <code>T:System.Windows.Forms.DomainUpDown</code> controla o suporte a [nome](xref:System.Windows.Automation.AutomationElement.NameProperty) e ter um [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-spinner-control-type.md) de <xref:System.Windows.Automation.ControlType.Spinner?displayProperty=nameWithType>.</li></ul><strong>Aprimoramentos para o controle PropertyGrid</strong>.NET Framework 4.7.1 adiciona os seguintes aprimoramentos para o controle PropertyBrowser:<ul><li>O <strong>detalhes</strong> botão na caixa de diálogo de erro é exibida quando o usuário insere um valor incorreto no <code>T:System.Windows.Forms.PropertyGrid</code> controle oferece suporte a [padrão de expandir/recolher](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md), estado e alteração de nome notificações e um [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) propriedade com um valor de <xref:System.Windows.Automation.ControlType.MenuItem?displayProperty=nameWithType>.</li><li>O painel da mensagem exibida quando o <strong>detalhes</strong> botão da caixa de diálogo de erro é expandido é agora teclado acessível e permite que o Narrator anunciar o conteúdo da mensagem de erro.</li><li>O <xref:System.Windows.Forms.AccessibleRole> de linhas no <code>T:System.Windows.Forms.PropertyGrid</code> controle alterou &quot;linha&quot; para &quot;célula&quot;. A célula é mapeado para UIA ControlType &quot;DataItem&quot;, que permite que ele dar suporte a atalhos de teclado apropriado e anúncios Narrator.</li><li>O <code>T:System.Windows.Forms.PropertyGrid</code> controlar linhas de cabeçalho que representam itens o <code>T:System.Windows.Forms.PropertyGrid</code> controle tem um <code>P:System.Windows.Forms.PropertySort</code> propriedade definida como <code>F:System.Windows.Forms.PropertySory.Categorized</code> tem um [ControlType](~/docs/framework/ui-automation/ui-automation-support-for-the-menubar-control-type.md) valor da propriedade <xref:System.Windows.Automation.ControlType.Button?displayProperty=nameWithType></li><li>O <code>T:System.Windows.Forms.PropertyGrid</code> controlar linhas de cabeçalho que representam itens quando o <code>T:System.Windows.Forms.PropertyGrid</code> controle tem um <code>P:System.Windows.Forms.PropertySort</code> propriedade definida como <code>F:System.Windows.Forms.PropertySory.Categorized</code> suporte a [padrão de expandir/recolher](~/docs/framework/ui-automation/implementing-the-ui-automation-expandcollapse-control-pattern.md).</li><li>Navegação de teclado aprimorado entre a grade e barra de ferramentas acima dele. Pressionar &quot;Shift-guia&quot; agora seleciona o primeiro botão da barra de ferramentas, em vez de toda a barra de ferramentas</li><li><code>T:System.Windows.Forms.PropertyGrid</code> controles exibidos no modo de alto contraste agora serão desenhar um retângulo de foco ao redor do botão de barra de ferramentas que corresponde ao atual <code>P:System.Windows.Forms.PropertySort</code> valor da propriedade.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> controles exibidos no modo de alto contraste e com um <code>P:System.Windows.Forms.PropertySort</code> propriedade definida como <code>F:System.Windows.Forms.PropertySory.Categorized</code> será exibição agora o plano de fundo de cabeçalhos de categoria em uma cor altamente contrastante.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> controles melhor faz distinção entre itens da barra de ferramentas com foco e os itens da barra de ferramentas que indicam o valor atual do <code>P:System.Windows.Forms.PropertySort</code> propriedade. Essa correção consiste em uma alteração de alto contraste e uma alteração para cenários de não - alto contraste.</li><li><code>T:System.Windows.Forms.PropertyGrid</code> itens da barra de ferramentas que indica o valor atual de controle de <code>P:System.Windows.Forms.PropertySort</code> suporte de propriedade a [padrão Toggle](xref:System.Windows.Automation.TogglePattern).</li><li>Suporte aprimorado do Narrator para distinguir o alinhamento selecionado no seletor de alinhamento.</li><li>Quando vazio <code>T:System.Windows.Forms.PropertyGrid</code> controle é exibido em um formulário, ela agora recebe foco onde anteriormente seria não.</li></ul><strong>Uso de cores definidas pelo sistema operacional em temas de alto contraste</strong><ul><li><code>T:System.Windows.Forms.Button</code> e <code>T:System.Windows.Forms.CheckBox</code> controla com <code>P:System.Windows.Forms.Control.FlatStyle</code> definida como <xref:System.Windows.Forms.FlatStyle.System?displayProperty=nameWithType>, que é o estilo padrão, agora usar cores definidas pelo sistema operacional no tema de alto contraste quando selecionado. Anteriormente, as cores de texto e plano de fundo não foram contrastantes e foram difíceis de ler.</li><li><code>T:System.Windows.Forms.Button</code>, <code>T:System.Windows.Forms.CheckBox</code>, <code>T:System.Windows.Forms.RadioButton</code>, <code>T:System.Windows.Forms.Label</code>, <code>T:System.Windows.Forms.LinkLabel</code> e <code>T:System.Windows.Forms.GroupBox</code> com<code>P:System.Windows.Forms.Control.Enabled</code> definida como <em>false</em>, usado uma cor sombreada para renderizar texto em temas de alto contraste, resultando em baixo contraste em relação a plano de fundo. Agora, usam esses controles &quot;texto desabilitado&quot; cor definida pelo sistema operacional. Essa correção aplica-se a controles com <code>P:System.Windows.Forms.Control.FlatStyle</code> propriedade definida como um valor diferente de <code>F:System.Windows.Forms.FlatStyle.System</code>. Os controles de segundo são processadas pelo sistema operacional.</li><li><code>T:System.Windows.Forms.DataGridView</code> Agora renderiza um retângulo visível em torno do conteúdo da célula que tem o foco atual. Anteriormente, isso não estava visível em certos temas de alto contraste.</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> controles com um <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> propriedade definida como <em>false</em> agora usam o &quot;texto desabilitado&quot; cor definida pelo sistema operacional.</li><li><code>T:System.Windows.Forms.ToolStripMenuItem</code> controles com um <code>P:System.Windows.Forms.ToolStripItem.Checked</code> propriedade definida como <em>true</em> agora renderizar na marca de seleção associada em uma cor de sistema contrastantes.  Anteriormente a cor da marca de seleção não foi contrastantes suficiente e não em temas de alto contraste.</li></ul>Observação: Windows10 alterou os valores para algumas cores do sistema de alto contraste. Estrutura de formulários do Windows é baseada no framework Win32. Para obter a melhor experiência, execute a versão mais recente do Windows e aceitar as alterações mais recentes do sistema operacional, adicionando um arquivo App. manifest em um aplicativo de teste e uncommenting o código a seguir:<pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><strong>Navegação de teclado aprimorado</strong><ul><li>Quando um <code>T:System.Windows.Forms.ComboBox</code> tem controle <code>P:System.Windows.Forms.ComboBox.DropDownStyle</code> definido como <code>F:System.Windows.Forms.DropDownStyle.DropDownList</code> e é o primeiro controle na guia ordem no formulário, agora exibe um retângulo de foco quando o formulário pai é aberto usando o teclado. Antes desta alteração, o foco do teclado foi nesse controle, mas um indicador de foco não foi processado.</li></ul><strong>Melhor suporte ao Narrador</strong><ul><li>O <code>T:System.Windows.Forms.MonthCalendar</code> controle foi adicionado suporte para as tecnologias de assistência acessar o controle, inclusive a capacidade do Narrator ler o valor do controle quando anteriormente não pôde.</li><li>O <code>T:System.Windows.Forms.CheckedListBox</code> controle agora notifica o Narrator quando o <code>P:System.Windows.Forms.CheckState</code> propriedade foi alterada. O Narrator não recebeu notificação anteriormente, e como resultado, os usuários não deve ser informado de que a <code>P:System.Windows.Forms.CheckState</code> tivesse sido atualizada.</li><li>O <code>T:System.Windows.Forms.LinkLabel</code> controle alterou a maneira como ele o notificará o Narrator do texto no controle. Anteriormente, o Narrator anunciada esse texto duas vezes e ler &quot; &amp; &quot; símbolos como texto real, mesmo que eles não são visíveis para um usuário. O texto duplicado foi removido de anúncios de Narrador, bem como desnecessários &quot; &amp; &quot; símbolos.</li><li>O <code>T:System.Windows.Forms.DataGridViewCell</code> controle agora tipos corretamente o status de somente leitura para o Narrator e outras tecnologias assistenciais do relatório.</li><li>O Narrator agora é capaz de ler o Menu do sistema do windows do filho no [Interface de documentos múltiplos](~/docs/framework/winforms/advanced/multiple-document-interface-mdi-applications.md) aplicativos.</li><li>O Narrator agora é capaz de ler <code>T:System.Windows.Forms.ToolStripMenuItem</code> controles com um <code>P:System.Windows.Forms.ToolStripItem.Enabled</code> propriedade definida como <em>false</em>. Anteriormente, o Narrator não pôde se concentra nos itens de menu desativado para ler o conteúdo.</li></ul>|
|Escopo|Principal|
|Versão|4.7.1|
|Tipo|Redirecionando|
|APIs afetadas|<ul><li><xref:System.Windows.Forms.ToolStripDropDownButton.CreateAccessibilityInstance?displayProperty=nameWithType></li><li><xref:System.Windows.Forms.DomainUpDown.DomainUpDownAccessibleObject.Name?displayProperty=nameWithType></li><li>[MonthCalendar.AccessibilityObject](xref:System.Windows.Forms.Control.AccessibilityObject)</li></ul>|

