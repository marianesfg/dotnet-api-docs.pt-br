<span data-ttu-id="3f284-101">Usando a indexação baseada em caractere com o <xref:System.Text.StringBuilder.Chars%2A> propriedade pode ser extremamente lenta sob as seguintes condições:</span><span class="sxs-lookup"><span data-stu-id="3f284-101">Using character-based indexing with the <xref:System.Text.StringBuilder.Chars%2A> property can be extremely slow under the following conditions:</span></span>

- <span data-ttu-id="3f284-102">O <xref:System.Text.StringBuilder> instância for grande (por exemplo, ele consiste em várias dezenas de milhares de caracteres).</span><span class="sxs-lookup"><span data-stu-id="3f284-102">The <xref:System.Text.StringBuilder> instance is large (for example, it consists of several tens of thousands of characters).</span></span>
- <span data-ttu-id="3f284-103">O <xref:System.Text.StringBuilder> é "robustos".</span><span class="sxs-lookup"><span data-stu-id="3f284-103">The <xref:System.Text.StringBuilder> is "chunky."</span></span> <span data-ttu-id="3f284-104">Ou seja, repetidas chamadas para métodos como <xref:System.Text.StringBuilder.Append%2A?displayProperty=nameWithType> ter expandido automaticamente o objeto <xref:System.Text.StringBuilder.Capacity%2A?displayProperty=nameWithType> propriedade e partes de novo alocadas da memória para ela.</span><span class="sxs-lookup"><span data-stu-id="3f284-104">That is, repeated calls to methods such as <xref:System.Text.StringBuilder.Append%2A?displayProperty=nameWithType> have automatically expanded the object's <xref:System.Text.StringBuilder.Capacity%2A?displayProperty=nameWithType> property and allocated new chunks of memory to it.</span></span>

<span data-ttu-id="3f284-105">É o desempenho gravemente impactado porque acesso cada caractere orienta toda a lista vinculada de blocos para localizar o buffer correto ao qual indexar.</span><span class="sxs-lookup"><span data-stu-id="3f284-105">Performance is severely impacted because each character access walks the entire linked list of chunks to find the correct buffer to index into.</span></span>

> [!NOTE]
>  <span data-ttu-id="3f284-106">Mesmo para um grande "robustos" <xref:System.Text.StringBuilder> do objeto, usando o <xref:System.Text.StringBuilder.Chars%2A> propriedade baseada em índice acesso a um ou um pequeno número de caracteres tem um impacto no desempenho insignificante; normalmente, é um **0(n)** operação.</span><span class="sxs-lookup"><span data-stu-id="3f284-106">Even for a large "chunky" <xref:System.Text.StringBuilder> object, using the <xref:System.Text.StringBuilder.Chars%2A> property for index-based access to one or a small number of characters has a negligible performance impact; typically, it is an **0(n)** operation.</span></span> <span data-ttu-id="3f284-107">O impacto de desempenho significativa ocorre quando se itera os caracteres no <xref:System.Text.StringBuilder> objeto, que é um **O(n^2)** operação.</span><span class="sxs-lookup"><span data-stu-id="3f284-107">The significant performance impact occurs when iterating the characters in the <xref:System.Text.StringBuilder> object, which is an **O(n^2)** operation.</span></span> 

<span data-ttu-id="3f284-108">Se você encontrar problemas de desempenho ao usar a indexação baseada em caractere com <xref:System.Text.StringBuilder> objetos, você pode usar qualquer uma das seguintes alternativas:</span><span class="sxs-lookup"><span data-stu-id="3f284-108">If you encounter performance issues when using character-based indexing with <xref:System.Text.StringBuilder> objects, you can use any of the following workarounds:</span></span>

- <span data-ttu-id="3f284-109">Converter o <xref:System.Text.StringBuilder> instância para uma <xref:System.String> chamando o <xref:System.Text.StringBuilder.ToString%2A> método, acesse os caracteres na cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="3f284-109">Convert the <xref:System.Text.StringBuilder> instance to a <xref:System.String> by calling the <xref:System.Text.StringBuilder.ToString%2A> method, then access the characters in the string.</span></span>

- <span data-ttu-id="3f284-110">Copie o conteúdo existente <xref:System.Text.StringBuilder> um novo objeto dimensionados previamente <xref:System.Text.StringBuilder> objeto.</span><span class="sxs-lookup"><span data-stu-id="3f284-110">Copy the contents of the existing <xref:System.Text.StringBuilder> object to a new pre-sized <xref:System.Text.StringBuilder> object.</span></span> <span data-ttu-id="3f284-111">Melhora o desempenho porque o novo <xref:System.Text.StringBuilder> o objeto não é robusto.</span><span class="sxs-lookup"><span data-stu-id="3f284-111">Performance improves because the new <xref:System.Text.StringBuilder> object is not chunky.</span></span> <span data-ttu-id="3f284-112">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="3f284-112">For example:</span></span>

   ```csharp
   // sbOriginal is the existing StringBuilder object
   var sbNew = new StringBuilder(sbOriginal.ToString(), sbOriginal.Length);
   ```
   ```vb
   ' sbOriginal is the existing StringBuilder object
   Dim sbNew = New StringBuilder(sbOriginal.ToString(), sbOriginal.Length)
   ```
- <span data-ttu-id="3f284-113">Definir a capacidade inicial do <xref:System.Text.StringBuilder> objeto como um valor que é aproximadamente igual ao tamanho máximo esperado chamando o <xref:System.Text.StringBuilder.%23ctor(System.Int32)> construtor.</span><span class="sxs-lookup"><span data-stu-id="3f284-113">Set the initial capacity of the <xref:System.Text.StringBuilder> object to a value that is approximately equal to its maximum expected size by calling the <xref:System.Text.StringBuilder.%23ctor(System.Int32)> constructor.</span></span> <span data-ttu-id="3f284-114">Observe que isso aloca o bloco inteiro se até mesmo de memória a <xref:System.Text.StringBuilder> raramente atingir sua capacidade máxima.</span><span class="sxs-lookup"><span data-stu-id="3f284-114">Note that this allocates the entire block of memory even if the <xref:System.Text.StringBuilder> rarely reaches its maximum capacity.</span></span>
