<span data-ttu-id="cb94f-101">O uso da indexação baseada em caracteres com a propriedade <xref:System.Text.StringBuilder.Chars%2A> pode ser extremamente lento nas seguintes condições:</span><span class="sxs-lookup"><span data-stu-id="cb94f-101">Using character-based indexing with the <xref:System.Text.StringBuilder.Chars%2A> property can be extremely slow under the following conditions:</span></span>

- <span data-ttu-id="cb94f-102">A instância de <xref:System.Text.StringBuilder> é grande (por exemplo, ela consiste em várias dezenas de milhares de caracteres).</span><span class="sxs-lookup"><span data-stu-id="cb94f-102">The <xref:System.Text.StringBuilder> instance is large (for example, it consists of several tens of thousands of characters).</span></span>
- <span data-ttu-id="cb94f-103">O <xref:System.Text.StringBuilder> é "robusto".</span><span class="sxs-lookup"><span data-stu-id="cb94f-103">The <xref:System.Text.StringBuilder> is "chunky."</span></span> <span data-ttu-id="cb94f-104">Ou seja, chamadas repetidas para métodos como <xref:System.Text.StringBuilder.Append%2A?displayProperty=nameWithType> expandiram automaticamente a propriedade <xref:System.Text.StringBuilder.Capacity%2A?displayProperty=nameWithType> do objeto e alocaram novos trechos de memória a ela.</span><span class="sxs-lookup"><span data-stu-id="cb94f-104">That is, repeated calls to methods such as <xref:System.Text.StringBuilder.Append%2A?displayProperty=nameWithType> have automatically expanded the object's <xref:System.Text.StringBuilder.Capacity%2A?displayProperty=nameWithType> property and allocated new chunks of memory to it.</span></span>

<span data-ttu-id="cb94f-105">O desempenho é afetado gravemente porque cada acesso de caractere percorre toda a lista vinculada de partes para localizar o buffer correto ao qual indexar.</span><span class="sxs-lookup"><span data-stu-id="cb94f-105">Performance is severely impacted because each character access walks the entire linked list of chunks to find the correct buffer to index into.</span></span>

> [!NOTE]
>  <span data-ttu-id="cb94f-106">Mesmo para um grande objeto <xref:System.Text.StringBuilder> “robusto", usar a propriedade <xref:System.Text.StringBuilder.Chars%2A> para o acesso baseado em índice a um ou um pequeno número de caracteres tem impacto insignificante sobre o desempenho. Normalmente, trata-se de uma operação **0(n)**.</span><span class="sxs-lookup"><span data-stu-id="cb94f-106">Even for a large "chunky" <xref:System.Text.StringBuilder> object, using the <xref:System.Text.StringBuilder.Chars%2A> property for index-based access to one or a small number of characters has a negligible performance impact; typically, it is an **0(n)** operation.</span></span> <span data-ttu-id="cb94f-107">O impacto significativo sobre o desempenho ocorre ao iterar os caracteres no objeto <xref:System.Text.StringBuilder>, que é uma operação **O(n^2)**.</span><span class="sxs-lookup"><span data-stu-id="cb94f-107">The significant performance impact occurs when iterating the characters in the <xref:System.Text.StringBuilder> object, which is an **O(n^2)** operation.</span></span> 

<span data-ttu-id="cb94f-108">Se encontrar problemas de desempenho ao usar a indexação baseada em caractere com objetos <xref:System.Text.StringBuilder>, você poderá usar qualquer uma das seguintes alternativas:</span><span class="sxs-lookup"><span data-stu-id="cb94f-108">If you encounter performance issues when using character-based indexing with <xref:System.Text.StringBuilder> objects, you can use any of the following workarounds:</span></span>

- <span data-ttu-id="cb94f-109">Converter a instância <xref:System.Text.StringBuilder> para um <xref:System.String> chamando o método <xref:System.Text.StringBuilder.ToString%2A> e, em seguida, acessar os caracteres na cadeia de caracteres.</span><span class="sxs-lookup"><span data-stu-id="cb94f-109">Convert the <xref:System.Text.StringBuilder> instance to a <xref:System.String> by calling the <xref:System.Text.StringBuilder.ToString%2A> method, then access the characters in the string.</span></span>

- <span data-ttu-id="cb94f-110">Copiar o conteúdo do objeto <xref:System.Text.StringBuilder> existente para um novo objeto <xref:System.Text.StringBuilder> pré-dimensionado.</span><span class="sxs-lookup"><span data-stu-id="cb94f-110">Copy the contents of the existing <xref:System.Text.StringBuilder> object to a new pre-sized <xref:System.Text.StringBuilder> object.</span></span> <span data-ttu-id="cb94f-111">O desempenho melhora porque o novo objeto <xref:System.Text.StringBuilder> não é robusto.</span><span class="sxs-lookup"><span data-stu-id="cb94f-111">Performance improves because the new <xref:System.Text.StringBuilder> object is not chunky.</span></span> <span data-ttu-id="cb94f-112">Por exemplo:</span><span class="sxs-lookup"><span data-stu-id="cb94f-112">For example:</span></span>

   ```csharp
   // sbOriginal is the existing StringBuilder object
   var sbNew = new StringBuilder(sbOriginal.ToString(), sbOriginal.Length);
   ```
   ```vb
   ' sbOriginal is the existing StringBuilder object
   Dim sbNew = New StringBuilder(sbOriginal.ToString(), sbOriginal.Length)
   ```
- <span data-ttu-id="cb94f-113">Definir a capacidade inicial do objeto <xref:System.Text.StringBuilder> como um valor aproximadamente igual ao seu tamanho máximo esperado chamando o construtor <xref:System.Text.StringBuilder.%23ctor(System.Int32)>.</span><span class="sxs-lookup"><span data-stu-id="cb94f-113">Set the initial capacity of the <xref:System.Text.StringBuilder> object to a value that is approximately equal to its maximum expected size by calling the <xref:System.Text.StringBuilder.%23ctor(System.Int32)> constructor.</span></span> <span data-ttu-id="cb94f-114">Observe que isso aloca o bloco de memória inteiro mesmo que o <xref:System.Text.StringBuilder> raramente atinja sua capacidade máxima.</span><span class="sxs-lookup"><span data-stu-id="cb94f-114">Note that this allocates the entire block of memory even if the <xref:System.Text.StringBuilder> rarely reaches its maximum capacity.</span></span>
